<html><head><meta charset="UTF-8"></head><body><pre>
<u>o</u><u>v</u><u>n</u><u>-</u><u>n</u><u>o</u><u>r</u><u>t</u><u>h</u><u>d</u>(8)                     OVN Manual                     <u>o</u><u>v</u><u>n</u><u>-</u><u>n</u><u>o</u><u>r</u><u>t</u><u>h</u><u>d</u>(8)

<b>N</b><b>A</b><b>M</b><b>E</b>
       ovn-northd  and ovn-northd-ddlog - Open Virtual Network central control
       daemon

<b>S</b><b>Y</b><b>N</b><b>O</b><b>P</b><b>S</b><b>I</b><b>S</b>
       <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> [<u>o</u><u>p</u><u>t</u><u>i</u><u>o</u><u>n</u><u>s</u>]

<b>D</b><b>E</b><b>S</b><b>C</b><b>R</b><b>I</b><b>P</b><b>T</b><b>I</b><b>O</b><b>N</b>
       <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> is a centralized  daemon  responsible  for  translating  the
       high-level  OVN  configuration into logical configuration consumable by
       daemons such as <b>o</b><b>v</b><b>n</b><b>-</b><b>c</b><b>o</b><b>n</b><b>t</b><b>r</b><b>o</b><b>l</b><b>l</b><b>e</b><b>r</b>. It translates the logical network  con‚Äê
       figuration  in  terms  of conventional network concepts, taken from the
       OVN Northbound Database (see <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>b</b>(5)), into logical datapath flows in
       the OVN Southbound Database (see <b>o</b><b>v</b><b>n</b><b>-</b><b>s</b><b>b</b>(5)) below it.

       <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> is implemented in C. <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b><b>-</b><b>d</b><b>d</b><b>l</b><b>o</b><b>g</b> is a compatible imple‚Äê
       mentation written in DDlog, a language for  incremental  database  pro‚Äê
       cessing.  This documentation applies to both implementations, with dif‚Äê
       ferences indicated where relevant.

<b>O</b><b>P</b><b>T</b><b>I</b><b>O</b><b>N</b><b>S</b>
       <b>-</b><b>-</b><b>o</b><b>v</b><b>n</b><b>n</b><b>b</b><b>-</b><b>d</b><b>b</b><b>=</b><u>d</u><u>a</u><u>t</u><u>a</u><u>b</u><u>a</u><u>s</u><u>e</u>
              The OVSDB database containing the OVN  Northbound  Database.  If
              the  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>B</b><b>_</b><b>D</b><b>B</b> environment variable is set, its value is used as
              the default. Otherwise, the default is <b>u</b><b>n</b><b>i</b><b>x</b><b>:</b><b>/</b><b>o</b><b>v</b><b>n</b><b>n</b><b>b</b><b>_</b><b>d</b><b>b</b><b>.</b><b>s</b><b>o</b><b>c</b><b>k</b>.

       <b>-</b><b>-</b><b>o</b><b>v</b><b>n</b><b>s</b><b>b</b><b>-</b><b>d</b><b>b</b><b>=</b><u>d</u><u>a</u><u>t</u><u>a</u><u>b</u><u>a</u><u>s</u><u>e</u>
              The OVSDB database containing the OVN  Southbound  Database.  If
              the  <b>O</b><b>V</b><b>N</b><b>_</b><b>S</b><b>B</b><b>_</b><b>D</b><b>B</b> environment variable is set, its value is used as
              the default. Otherwise, the default is <b>u</b><b>n</b><b>i</b><b>x</b><b>:</b><b>/</b><b>o</b><b>v</b><b>n</b><b>s</b><b>b</b><b>_</b><b>d</b><b>b</b><b>.</b><b>s</b><b>o</b><b>c</b><b>k</b>.

       <b>-</b><b>-</b><b>d</b><b>d</b><b>l</b><b>o</b><b>g</b><b>-</b><b>r</b><b>e</b><b>c</b><b>o</b><b>r</b><b>d</b><b>=</b><u>f</u><u>i</u><u>l</u><u>e</u>
              This option is for <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>-</b><b>d</b><b>d</b><b>l</b><b>o</b><b>g</b> only. It causes the daemon to
              record the initial database state and later changes to  <u>f</u><u>i</u><u>l</u><u>e</u>  in
              the  text-based DDlog command format. The <b>o</b><b>v</b><b>n</b><b>_</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b><b>_</b><b>c</b><b>l</b><b>i</b> program
              can later replay these changes for debugging purposes. This  op‚Äê
              tion  has  a  performance impact. See <b>d</b><b>e</b><b>b</b><b>u</b><b>g</b><b>g</b><b>i</b><b>n</b><b>g</b><b>-</b><b>d</b><b>d</b><b>l</b><b>o</b><b>g</b><b>.</b><b>r</b><b>s</b><b>t</b> in the
              OVN documentation for more details.

       <b>-</b><b>-</b><b>d</b><b>r</b><b>y</b><b>-</b><b>r</b><b>u</b><b>n</b>
              Causes  <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>  to  start  paused.  In  the  paused   state,
              <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> does not apply any changes to the databases, although
              it  continues  to  monitor  them.  For more information, see the
              <b>p</b><b>a</b><b>u</b><b>s</b><b>e</b> command, under <b>R</b><b>u</b><b>n</b><b>t</b><b>i</b><b>m</b><b>e</b> <b>M</b><b>a</b><b>n</b><b>a</b><b>g</b><b>e</b><b>m</b><b>e</b><b>n</b><b>t</b> <b>C</b><b>o</b><b>m</b><b>m</b><b>a</b><b>n</b><b>d</b><b>s</b> below.

              For  <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b><b>-</b><b>d</b><b>d</b><b>l</b><b>o</b><b>g</b>,  one   could   use   this   option   with
              <b>-</b><b>-</b><b>d</b><b>d</b><b>l</b><b>o</b><b>g</b><b>-</b><b>r</b><b>e</b><b>c</b><b>o</b><b>r</b><b>d</b>  to  generate  a  replay log without restarting a
              process or disturbing a running system.

       <b>n</b><b>-</b><b>t</b><b>h</b><b>r</b><b>e</b><b>a</b><b>d</b><b>s</b> <b>N</b>
              In certain situations, it may  be  desirable  to  enable  paral‚Äê
              lelization  on  a  system  to decrease latency (at the potential
              cost of increasing CPU usage).

              This option will cause ovn-northd to use N threads when building
              logical flows, when N is within [2-256]. If N is 1, paralleliza‚Äê
              tion is disabled (default behavior). If N is less than 1, then N
              is set to 1,  parallelization  is  disabled  and  a  warning  is
              logged.  If  N  is  more  than 256, then N is set to 256, paral‚Äê
              lelization is enabled  (with  256  threads)  and  a  warning  is
              logged.

              ovn-northd-ddlog does not support this option.

       <u>d</u><u>a</u><u>t</u><u>a</u><u>b</u><u>a</u><u>s</u><u>e</u>  in  the above options must be an OVSDB active or passive con‚Äê
       nection method, as described in <b>o</b><b>v</b><b>s</b><b>d</b><b>b</b>(7).

   <b>D</b><b>a</b><b>e</b><b>m</b><b>o</b><b>n</b> <b>O</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>
       <b>-</b><b>-</b><b>p</b><b>i</b><b>d</b><b>f</b><b>i</b><b>l</b><b>e</b>[<b>=</b><u>p</u><u>i</u><u>d</u><u>f</u><u>i</u><u>l</u><u>e</u>]
              Causes a file (by default, <u>p</u><u>r</u><u>o</u><u>g</u><u>r</u><u>a</u><u>m</u><b>.</b><b>p</b><b>i</b><b>d</b>) to be created indicating
              the PID of the running process. If the <u>p</u><u>i</u><u>d</u><u>f</u><u>i</u><u>l</u><u>e</u> argument  is  not
              specified, or if it does not begin with <b>/</b>, then it is created in
              .

              If <b>-</b><b>-</b><b>p</b><b>i</b><b>d</b><b>f</b><b>i</b><b>l</b><b>e</b> is not specified, no pidfile is created.

       <b>-</b><b>-</b><b>o</b><b>v</b><b>e</b><b>r</b><b>w</b><b>r</b><b>i</b><b>t</b><b>e</b><b>-</b><b>p</b><b>i</b><b>d</b><b>f</b><b>i</b><b>l</b><b>e</b>
              By  default,  when <b>-</b><b>-</b><b>p</b><b>i</b><b>d</b><b>f</b><b>i</b><b>l</b><b>e</b> is specified and the specified pid‚Äê
              file already exists and is locked by a running process, the dae‚Äê
              mon refuses to start. Specify <b>-</b><b>-</b><b>o</b><b>v</b><b>e</b><b>r</b><b>w</b><b>r</b><b>i</b><b>t</b><b>e</b><b>-</b><b>p</b><b>i</b><b>d</b><b>f</b><b>i</b><b>l</b><b>e</b> to cause it to
              instead overwrite the pidfile.

              When <b>-</b><b>-</b><b>p</b><b>i</b><b>d</b><b>f</b><b>i</b><b>l</b><b>e</b> is not specified, this option has no effect.

       <b>-</b><b>-</b><b>d</b><b>e</b><b>t</b><b>a</b><b>c</b><b>h</b>
              Runs this program as a background process.  The  process  forks,
              and  in  the  child it starts a new session, closes the standard
              file descriptors (which has the side effect of disabling logging
              to the console), and changes its current directory to  the  root
              (unless  <b>-</b><b>-</b><b>n</b><b>o</b><b>-</b><b>c</b><b>h</b><b>d</b><b>i</b><b>r</b> is specified). After the child completes its
              initialization, the parent exits.

       <b>-</b><b>-</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b>
              Creates an additional process to monitor  this  program.  If  it
              dies  due  to a signal that indicates a programming error (<b>S</b><b>I</b><b>G</b><b>A</b>‚Äê‚Äê
              <b>B</b><b>R</b><b>T</b>, <b>S</b><b>I</b><b>G</b><b>A</b><b>L</b><b>R</b><b>M</b>, <b>S</b><b>I</b><b>G</b><b>B</b><b>U</b><b>S</b>, <b>S</b><b>I</b><b>G</b><b>F</b><b>P</b><b>E</b>, <b>S</b><b>I</b><b>G</b><b>I</b><b>L</b><b>L</b>, <b>S</b><b>I</b><b>G</b><b>P</b><b>I</b><b>P</b><b>E</b>, <b>S</b><b>I</b><b>G</b><b>S</b><b>E</b><b>G</b><b>V</b>, <b>S</b><b>I</b><b>G</b><b>X</b><b>C</b><b>P</b><b>U</b>,
              or <b>S</b><b>I</b><b>G</b><b>X</b><b>F</b><b>S</b><b>Z</b>) then the monitor process starts a new copy of it. If
              the daemon dies or exits for another reason, the monitor process
              exits.

              This option is normally used with <b>-</b><b>-</b><b>d</b><b>e</b><b>t</b><b>a</b><b>c</b><b>h</b>, but  it  also  func‚Äê
              tions without it.

       <b>-</b><b>-</b><b>n</b><b>o</b><b>-</b><b>c</b><b>h</b><b>d</b><b>i</b><b>r</b>
              By  default,  when <b>-</b><b>-</b><b>d</b><b>e</b><b>t</b><b>a</b><b>c</b><b>h</b> is specified, the daemon changes its
              current working directory to the root  directory  after  it  de‚Äê
              taches.  Otherwise, invoking the daemon from a carelessly chosen
              directory would prevent the administrator  from  unmounting  the
              file system that holds that directory.

              Specifying  <b>-</b><b>-</b><b>n</b><b>o</b><b>-</b><b>c</b><b>h</b><b>d</b><b>i</b><b>r</b>  suppresses this behavior, preventing the
              daemon from changing its current working directory. This may  be
              useful for collecting core files, since it is common behavior to
              write core dumps into the current working directory and the root
              directory is not a good directory to use.

              This option has no effect when <b>-</b><b>-</b><b>d</b><b>e</b><b>t</b><b>a</b><b>c</b><b>h</b> is not specified.

       <b>-</b><b>-</b><b>n</b><b>o</b><b>-</b><b>s</b><b>e</b><b>l</b><b>f</b><b>-</b><b>c</b><b>o</b><b>n</b><b>f</b><b>i</b><b>n</b><b>e</b><b>m</b><b>e</b><b>n</b><b>t</b>
              By  default  this daemon will try to self-confine itself to work
              with files under  well-known  directories  determined  at  build
              time.  It  is better to stick with this default behavior and not
              to use this flag unless some other Access  Control  is  used  to
              confine  daemon.  Note  that in contrast to other access control
              implementations that are typically  enforced  from  kernel-space
              (e.g.  DAC  or  MAC), self-confinement is imposed from the user-
              space daemon itself and hence should not be considered as a full
              confinement strategy, but instead should be viewed as  an  addi‚Äê
              tional layer of security.

       <b>-</b><b>-</b><b>u</b><b>s</b><b>e</b><b>r</b><b>=</b><u>u</u><u>s</u><u>e</u><u>r</u><b>:</b><u>g</u><u>r</u><u>o</u><u>u</u><u>p</u>
              Causes  this  program  to  run  as a different user specified in
              <u>u</u><u>s</u><u>e</u><u>r</u><b>:</b><u>g</u><u>r</u><u>o</u><u>u</u><u>p</u>, thus dropping most of  the  root  privileges.  Short
              forms  <u>u</u><u>s</u><u>e</u><u>r</u>  and  <b>:</b><u>g</u><u>r</u><u>o</u><u>u</u><u>p</u>  are also allowed, with current user or
              group assumed, respectively. Only daemons started  by  the  root
              user accepts this argument.

              On   Linux,   daemons   will   be   granted   <b>C</b><b>A</b><b>P</b><b>_</b><b>I</b><b>P</b><b>C</b><b>_</b><b>L</b><b>O</b><b>C</b><b>K</b>   and
              <b>C</b><b>A</b><b>P</b><b>_</b><b>N</b><b>E</b><b>T</b><b>_</b><b>B</b><b>I</b><b>N</b><b>D</b><b>_</b><b>S</b><b>E</b><b>R</b><b>V</b><b>I</b><b>C</b><b>E</b><b>S</b> before dropping root  privileges.  Daemons
              that  interact  with  a  datapath, such as <b>o</b><b>v</b><b>s</b><b>-</b><b>v</b><b>s</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>d</b>, will be
              granted three  additional  capabilities,  namely  <b>C</b><b>A</b><b>P</b><b>_</b><b>N</b><b>E</b><b>T</b><b>_</b><b>A</b><b>D</b><b>M</b><b>I</b><b>N</b>,
              <b>C</b><b>A</b><b>P</b><b>_</b><b>N</b><b>E</b><b>T</b><b>_</b><b>B</b><b>R</b><b>O</b><b>A</b><b>D</b><b>C</b><b>A</b><b>S</b><b>T</b>  and  <b>C</b><b>A</b><b>P</b><b>_</b><b>N</b><b>E</b><b>T</b><b>_</b><b>R</b><b>A</b><b>W</b>.  The capability change will
              apply even if the new user is root.

              On Windows, this option is not currently supported. For security
              reasons, specifying this option will cause  the  daemon  process
              not to start.

   <b>L</b><b>o</b><b>g</b><b>g</b><b>i</b><b>n</b><b>g</b> <b>O</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>
       <b>-</b><b>v</b>[<u>s</u><u>p</u><u>e</u><u>c</u>]
       <b>-</b><b>-</b><b>v</b><b>e</b><b>r</b><b>b</b><b>o</b><b>s</b><b>e</b><b>=</b>[<u>s</u><u>p</u><u>e</u><u>c</u>]
            Sets  logging  levels.  Without  any  <u>s</u><u>p</u><u>e</u><u>c</u>, sets the log level for
            every module and destination to <b>d</b><b>b</b><b>g</b>. Otherwise, <u>s</u><u>p</u><u>e</u><u>c</u> is a list  of
            words separated by spaces or commas or colons, up to one from each
            category below:

            ‚Ä¢      A  valid module name, as displayed by the <b>v</b><b>l</b><b>o</b><b>g</b><b>/</b><b>l</b><b>i</b><b>s</b><b>t</b> command
                   on <b>o</b><b>v</b><b>s</b><b>-</b><b>a</b><b>p</b><b>p</b><b>c</b><b>t</b><b>l</b>(8), limits the log level change to the speci‚Äê
                   fied module.

            ‚Ä¢      <b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b>, <b>c</b><b>o</b><b>n</b><b>s</b><b>o</b><b>l</b><b>e</b>, or <b>f</b><b>i</b><b>l</b><b>e</b>, to limit the log level change  to
                   only  to  the system log, to the console, or to a file, re‚Äê
                   spectively. (If <b>-</b><b>-</b><b>d</b><b>e</b><b>t</b><b>a</b><b>c</b><b>h</b> is specified,  the  daemon  closes
                   its  standard  file  descriptors, so logging to the console
                   will have no effect.)

                   On Windows platform, <b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b> is accepted as a  word  and  is
                   only useful along with the <b>-</b><b>-</b><b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b><b>-</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> option (the word
                   has no effect otherwise).

            ‚Ä¢      <b>o</b><b>f</b><b>f</b>,  <b>e</b><b>m</b><b>e</b><b>r</b>,  <b>e</b><b>r</b><b>r</b>,  <b>w</b><b>a</b><b>r</b><b>n</b>,  <b>i</b><b>n</b><b>f</b><b>o</b>,  or <b>d</b><b>b</b><b>g</b>, to control the log
                   level. Messages of the given severity  or  higher  will  be
                   logged,  and  messages  of  lower severity will be filtered
                   out. <b>o</b><b>f</b><b>f</b> filters out all messages. See <b>o</b><b>v</b><b>s</b><b>-</b><b>a</b><b>p</b><b>p</b><b>c</b><b>t</b><b>l</b>(8) for  a
                   definition of each log level.

            Case is not significant within <u>s</u><u>p</u><u>e</u><u>c</u>.

            Regardless  of the log levels set for <b>f</b><b>i</b><b>l</b><b>e</b>, logging to a file will
            not take place unless <b>-</b><b>-</b><b>l</b><b>o</b><b>g</b><b>-</b><b>f</b><b>i</b><b>l</b><b>e</b> is also specified (see below).

            For compatibility with older versions of OVS, <b>a</b><b>n</b><b>y</b> is accepted as a
            word but has no effect.

       <b>-</b><b>v</b>
       <b>-</b><b>-</b><b>v</b><b>e</b><b>r</b><b>b</b><b>o</b><b>s</b><b>e</b>
            Sets the maximum logging verbosity  level,  equivalent  to  <b>-</b><b>-</b><b>v</b><b>e</b><b>r</b>‚Äê‚Äê
            <b>b</b><b>o</b><b>s</b><b>e</b><b>=</b><b>d</b><b>b</b><b>g</b>.

       <b>-</b><b>v</b><b>P</b><b>A</b><b>T</b><b>T</b><b>E</b><b>R</b><b>N</b><b>:</b><u>d</u><u>e</u><u>s</u><u>t</u><u>i</u><u>n</u><u>a</u><u>t</u><u>i</u><u>o</u><u>n</u><b>:</b><u>p</u><u>a</u><u>t</u><u>t</u><u>e</u><u>r</u><u>n</u>
       <b>-</b><b>-</b><b>v</b><b>e</b><b>r</b><b>b</b><b>o</b><b>s</b><b>e</b><b>=</b><b>P</b><b>A</b><b>T</b><b>T</b><b>E</b><b>R</b><b>N</b><b>:</b><u>d</u><u>e</u><u>s</u><u>t</u><u>i</u><u>n</u><u>a</u><u>t</u><u>i</u><u>o</u><u>n</u><b>:</b><u>p</u><u>a</u><u>t</u><u>t</u><u>e</u><u>r</u><u>n</u>
            Sets  the log pattern for <u>d</u><u>e</u><u>s</u><u>t</u><u>i</u><u>n</u><u>a</u><u>t</u><u>i</u><u>o</u><u>n</u> to <u>p</u><u>a</u><u>t</u><u>t</u><u>e</u><u>r</u><u>n</u>. Refer to <b>o</b><b>v</b><b>s</b><b>-</b><b>a</b><b>p</b>‚Äê‚Äê
            <b>p</b><b>c</b><b>t</b><b>l</b>(8) for a description of the valid syntax for <u>p</u><u>a</u><u>t</u><u>t</u><u>e</u><u>r</u><u>n</u>.

       <b>-</b><b>v</b><b>F</b><b>A</b><b>C</b><b>I</b><b>L</b><b>I</b><b>T</b><b>Y</b><b>:</b><u>f</u><u>a</u><u>c</u><u>i</u><u>l</u><u>i</u><u>t</u><u>y</u>
       <b>-</b><b>-</b><b>v</b><b>e</b><b>r</b><b>b</b><b>o</b><b>s</b><b>e</b><b>=</b><b>F</b><b>A</b><b>C</b><b>I</b><b>L</b><b>I</b><b>T</b><b>Y</b><b>:</b><u>f</u><u>a</u><u>c</u><u>i</u><u>l</u><u>i</u><u>t</u><u>y</u>
            Sets the RFC5424 facility of the log message. <u>f</u><u>a</u><u>c</u><u>i</u><u>l</u><u>i</u><u>t</u><u>y</u> can be  one
            of <b>k</b><b>e</b><b>r</b><b>n</b>, <b>u</b><b>s</b><b>e</b><b>r</b>, <b>m</b><b>a</b><b>i</b><b>l</b>, <b>d</b><b>a</b><b>e</b><b>m</b><b>o</b><b>n</b>, <b>a</b><b>u</b><b>t</b><b>h</b>, <b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b>, <b>l</b><b>p</b><b>r</b>, <b>n</b><b>e</b><b>w</b><b>s</b>, <b>u</b><b>u</b><b>c</b><b>p</b>, <b>c</b><b>l</b><b>o</b><b>c</b><b>k</b>,
            <b>f</b><b>t</b><b>p</b>,  <b>n</b><b>t</b><b>p</b>,  <b>a</b><b>u</b><b>d</b><b>i</b><b>t</b>,  <b>a</b><b>l</b><b>e</b><b>r</b><b>t</b>, <b>c</b><b>l</b><b>o</b><b>c</b><b>k</b><b>2</b>, <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>0</b>, <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>1</b>, <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>2</b>, <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>3</b>,
            <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>4</b>, <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>5</b>, <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>6</b> or <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>7</b>. If this option is not specified,
            <b>d</b><b>a</b><b>e</b><b>m</b><b>o</b><b>n</b> is used as the default for the local system syslog and  <b>l</b><b>o</b>‚Äê‚Äê
            <b>c</b><b>a</b><b>l</b><b>0</b>  is  used  while sending a message to the target provided via
            the <b>-</b><b>-</b><b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b><b>-</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> option.

       <b>-</b><b>-</b><b>l</b><b>o</b><b>g</b><b>-</b><b>f</b><b>i</b><b>l</b><b>e</b>[<b>=</b><u>f</u><u>i</u><u>l</u><u>e</u>]
            Enables logging to a file. If <u>f</u><u>i</u><u>l</u><u>e</u> is specified, then it  is  used
            as the exact name for the log file. The default log file name used
            if <u>f</u><u>i</u><u>l</u><u>e</u> is omitted is <b>/</b><b>u</b><b>s</b><b>r</b><b>/</b><b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>/</b><b>v</b><b>a</b><b>r</b><b>/</b><b>l</b><b>o</b><b>g</b><b>/</b><b>o</b><b>v</b><b>n</b><b>/</b><u>p</u><u>r</u><u>o</u><u>g</u><u>r</u><u>a</u><u>m</u><b>.</b><b>l</b><b>o</b><b>g</b>.

       <b>-</b><b>-</b><b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b><b>-</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b><b>=</b><u>h</u><u>o</u><u>s</u><u>t</u><b>:</b><u>p</u><u>o</u><u>r</u><u>t</u>
            Send  syslog messages to UDP <u>p</u><u>o</u><u>r</u><u>t</u> on <u>h</u><u>o</u><u>s</u><u>t</u>, in addition to the sys‚Äê
            tem syslog. The <u>h</u><u>o</u><u>s</u><u>t</u> must be a numerical IP address, not  a  host‚Äê
            name.

       <b>-</b><b>-</b><b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b><b>-</b><b>m</b><b>e</b><b>t</b><b>h</b><b>o</b><b>d</b><b>=</b><u>m</u><u>e</u><u>t</u><u>h</u><u>o</u><u>d</u>
            Specify  <u>m</u><u>e</u><u>t</u><u>h</u><u>o</u><u>d</u>  as  how  syslog messages should be sent to syslog
            daemon. The following forms are supported:

            ‚Ä¢      <b>l</b><b>i</b><b>b</b><b>c</b>, to use the libc <b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b><b>(</b><b>)</b> function. Downside of  using
                   this  options  is that libc adds fixed prefix to every mes‚Äê
                   sage before it is actually sent to the syslog  daemon  over
                   <b>/</b><b>d</b><b>e</b><b>v</b><b>/</b><b>l</b><b>o</b><b>g</b> UNIX domain socket.

            ‚Ä¢      <b>u</b><b>n</b><b>i</b><b>x</b><b>:</b><u>f</u><u>i</u><u>l</u><u>e</u>, to use a UNIX domain socket directly. It is pos‚Äê
                   sible to specify arbitrary message format with this option.
                   However,  <b>r</b><b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b><b>d</b>  <b>8</b><b>.</b><b>9</b>  and  older versions use hard coded
                   parser function anyway that limits UNIX domain socket  use.
                   If  you  want  to  use  arbitrary message format with older
                   <b>r</b><b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b><b>d</b> versions, then use UDP socket to localhost IP  ad‚Äê
                   dress instead.

            ‚Ä¢      <b>u</b><b>d</b><b>p</b><b>:</b><u>i</u><u>p</u><b>:</b><u>p</u><u>o</u><u>r</u><u>t</u>,  to  use  a UDP socket. With this method it is
                   possible to use arbitrary message format  also  with  older
                   <b>r</b><b>s</b><b>y</b><b>s</b><b>l</b><b>o</b><b>g</b><b>d</b>.  When sending syslog messages over UDP socket ex‚Äê
                   tra precaution needs to be taken into account, for example,
                   syslog daemon needs to be configured to listen on the spec‚Äê
                   ified UDP port, accidental iptables rules could  be  inter‚Äê
                   fering  with  local syslog traffic and there are some secu‚Äê
                   rity considerations that apply to UDP sockets, but  do  not
                   apply to UNIX domain sockets.

            ‚Ä¢      <b>n</b><b>u</b><b>l</b><b>l</b>, to discard all messages logged to syslog.

            The  default is taken from the <b>O</b><b>V</b><b>S</b><b>_</b><b>S</b><b>Y</b><b>S</b><b>L</b><b>O</b><b>G</b><b>_</b><b>M</b><b>E</b><b>T</b><b>H</b><b>O</b><b>D</b> environment vari‚Äê
            able; if it is unset, the default is <b>l</b><b>i</b><b>b</b><b>c</b>.

   <b>P</b><b>K</b><b>I</b> <b>O</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>
       PKI configuration is required in order to use SSL for  the  connections
       to the Northbound and Southbound databases.

              <b>-</b><b>p</b> <u>p</u><u>r</u><u>i</u><u>v</u><u>k</u><u>e</u><u>y</u><u>.</u><u>p</u><u>e</u><u>m</u>
              <b>-</b><b>-</b><b>p</b><b>r</b><b>i</b><b>v</b><b>a</b><b>t</b><b>e</b><b>-</b><b>k</b><b>e</b><b>y</b><b>=</b><u>p</u><u>r</u><u>i</u><u>v</u><u>k</u><u>e</u><u>y</u><u>.</u><u>p</u><u>e</u><u>m</u>
                   Specifies  a  PEM  file  containing the private key used as
                   identity for outgoing SSL connections.

              <b>-</b><b>c</b> <u>c</u><u>e</u><u>r</u><u>t</u><u>.</u><u>p</u><u>e</u><u>m</u>
              <b>-</b><b>-</b><b>c</b><b>e</b><b>r</b><b>t</b><b>i</b><b>f</b><b>i</b><b>c</b><b>a</b><b>t</b><b>e</b><b>=</b><u>c</u><u>e</u><u>r</u><u>t</u><u>.</u><u>p</u><u>e</u><u>m</u>
                   Specifies a PEM file containing a certificate  that  certi‚Äê
                   fies the private key specified on <b>-</b><b>p</b> or <b>-</b><b>-</b><b>p</b><b>r</b><b>i</b><b>v</b><b>a</b><b>t</b><b>e</b><b>-</b><b>k</b><b>e</b><b>y</b> to be
                   trustworthy. The certificate must be signed by the certifi‚Äê
                   cate  authority  (CA) that the peer in SSL connections will
                   use to verify it.

              <b>-</b><b>C</b> <u>c</u><u>a</u><u>c</u><u>e</u><u>r</u><u>t</u><u>.</u><u>p</u><u>e</u><u>m</u>
              <b>-</b><b>-</b><b>c</b><b>a</b><b>-</b><b>c</b><b>e</b><b>r</b><b>t</b><b>=</b><u>c</u><u>a</u><u>c</u><u>e</u><u>r</u><u>t</u><u>.</u><u>p</u><u>e</u><u>m</u>
                   Specifies a PEM file containing the CA certificate for ver‚Äê
                   ifying certificates presented to this program by SSL peers.
                   (This may be the same certificate that  SSL  peers  use  to
                   verify the certificate specified on <b>-</b><b>c</b> or <b>-</b><b>-</b><b>c</b><b>e</b><b>r</b><b>t</b><b>i</b><b>f</b><b>i</b><b>c</b><b>a</b><b>t</b><b>e</b>, or
                   it  may  be a different one, depending on the PKI design in
                   use.)

              <b>-</b><b>C</b> <b>n</b><b>o</b><b>n</b><b>e</b>
              <b>-</b><b>-</b><b>c</b><b>a</b><b>-</b><b>c</b><b>e</b><b>r</b><b>t</b><b>=</b><b>n</b><b>o</b><b>n</b><b>e</b>
                   Disables verification  of  certificates  presented  by  SSL
                   peers.  This  introduces  a security risk, because it means
                   that certificates cannot be verified to be those  of  known
                   trusted hosts.

   <b>O</b><b>t</b><b>h</b><b>e</b><b>r</b> <b>O</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>
       <b>-</b><b>-</b><b>u</b><b>n</b><b>i</b><b>x</b><b>c</b><b>t</b><b>l</b><b>=</b><u>s</u><u>o</u><u>c</u><u>k</u><u>e</u><u>t</u>
              Sets the name of the control socket on which <u>p</u><u>r</u><u>o</u><u>g</u><u>r</u><u>a</u><u>m</u> listens for
              runtime  management  commands  (see <u>R</u><u>U</u><u>N</u><u>T</u><u>I</u><u>M</u><u>E</u> <u>M</u><u>A</u><u>N</u><u>A</u><u>G</u><u>E</u><u>M</u><u>E</u><u>N</u><u>T</u> <u>C</u><u>O</u><u>M</u><u>M</u><u>A</u><u>N</u><u>D</u><u>S</u><u>,</u>
              below). If <u>s</u><u>o</u><u>c</u><u>k</u><u>e</u><u>t</u> does not begin with <b>/</b>, it  is  interpreted  as
              relative  to  .  If  <b>-</b><b>-</b><b>u</b><b>n</b><b>i</b><b>x</b><b>c</b><b>t</b><b>l</b>  is  not used at all, the default
              socket is <b>/</b><u>p</u><u>r</u><u>o</u><u>g</u><u>r</u><u>a</u><u>m</u><b>.</b><u>p</u><u>i</u><u>d</u><b>.</b><b>c</b><b>t</b><b>l</b>, where <u>p</u><u>i</u><u>d</u> is <u>p</u><u>r</u><u>o</u><u>g</u><u>r</u><u>a</u><u>m</u>‚Äôs process ID.

              On Windows a local named pipe is used to listen for runtime man‚Äê
              agement commands. A file is created  in  the  absolute  path  as
              pointed  by <u>s</u><u>o</u><u>c</u><u>k</u><u>e</u><u>t</u> or if <b>-</b><b>-</b><b>u</b><b>n</b><b>i</b><b>x</b><b>c</b><b>t</b><b>l</b> is not used at all, a file is
              created as <u>p</u><u>r</u><u>o</u><u>g</u><u>r</u><u>a</u><u>m</u> in the configured <u>O</u><u>V</u><u>S</u><b>_</b><u>R</u><u>U</u><u>N</u><u>D</u><u>I</u><u>R</u>  directory.  The
              file exists just to mimic the behavior of a Unix domain socket.

              Specifying <b>n</b><b>o</b><b>n</b><b>e</b> for <u>s</u><u>o</u><u>c</u><u>k</u><u>e</u><u>t</u> disables the control socket feature.



       <b>-</b><b>h</b>
       <b>-</b><b>-</b><b>h</b><b>e</b><b>l</b><b>p</b>
            Prints a brief help message to the console.

       <b>-</b><b>V</b>
       <b>-</b><b>-</b><b>v</b><b>e</b><b>r</b><b>s</b><b>i</b><b>o</b><b>n</b>
            Prints version information to the console.

<b>R</b><b>U</b><b>N</b><b>T</b><b>I</b><b>M</b><b>E</b> <b>M</b><b>A</b><b>N</b><b>A</b><b>G</b><b>E</b><b>M</b><b>E</b><b>N</b><b>T</b> <b>C</b><b>O</b><b>M</b><b>M</b><b>A</b><b>N</b><b>D</b><b>S</b>
       <b>o</b><b>v</b><b>s</b><b>-</b><b>a</b><b>p</b><b>p</b><b>c</b><b>t</b><b>l</b>  can send commands to a running <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> process. The cur‚Äê
       rently supported commands are described below.

              <b>e</b><b>x</b><b>i</b><b>t</b>   Causes <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> to gracefully terminate.

              <b>p</b><b>a</b><b>u</b><b>s</b><b>e</b>  Pauses <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>. When it is paused, <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> receives
                     changes  from  the  Northbound  and  Southbound  database
                     changes  as  usual,  but  it does not send any updates. A
                     paused <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> also drops database locks, which allows
                     any other non-paused instance of <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> to take over.

              <b>r</b><b>e</b><b>s</b><b>u</b><b>m</b><b>e</b> Resumes the ovn-northd operation  to  process  Northbound
                     and  Southbound  database  contents  and generate logical
                     flows. This will also instruct ovn-northd to  aspire  for
                     the lock on SB DB.

              <b>i</b><b>s</b><b>-</b><b>p</b><b>a</b><b>u</b><b>s</b><b>e</b><b>d</b>
                     Returns "true" if ovn-northd is currently paused, "false"
                     otherwise.

              <b>s</b><b>t</b><b>a</b><b>t</b><b>u</b><b>s</b> Prints  this  server‚Äôs status. Status will be "active" if
                     ovn-northd has acquired OVSDB lock on SB DB, "standby" if
                     it has not or "paused" if this instance is paused.

              <b>s</b><b>b</b><b>-</b><b>c</b><b>l</b><b>u</b><b>s</b><b>t</b><b>e</b><b>r</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>-</b><b>r</b><b>e</b><b>s</b><b>e</b><b>t</b>
                     Reset southbound database cluster status  when  databases
                     are destroyed and rebuilt.

                     If  all  databases in a clustered southbound database are
                     removed from disk, then the stored index of all databases
                     will be reset to zero. This will cause ovn-northd  to  be
                     unable  to  read or write to the southbound database, be‚Äê
                     cause it will always detect the data as stale. In such  a
                     case,  run this command so that ovn-northd will reset its
                     local index so that it can interact with  the  southbound
                     database again.

              <b>n</b><b>b</b><b>-</b><b>c</b><b>l</b><b>u</b><b>s</b><b>t</b><b>e</b><b>r</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>-</b><b>r</b><b>e</b><b>s</b><b>e</b><b>t</b>
                     Reset  northbound  database cluster status when databases
                     are destroyed and rebuilt.

                     This performs the same task as <b>s</b><b>b</b><b>-</b><b>c</b><b>l</b><b>u</b><b>s</b><b>t</b><b>e</b><b>r</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>-</b><b>r</b><b>e</b><b>s</b><b>e</b><b>t</b> ex‚Äê
                     cept for the northbound database client.

              <b>s</b><b>e</b><b>t</b><b>-</b><b>n</b><b>-</b><b>t</b><b>h</b><b>r</b><b>e</b><b>a</b><b>d</b><b>s</b> <b>N</b>
                     Set the number  of  threads  used  for  building  logical
                     flows.  When  N is within [2-256], parallelization is en‚Äê
                     abled. When N is 1 parallelization is disabled. When N is
                     less than 1 or more than 256, an error  is  returned.  If
                     ovn-northd  fails to start parallelization (e.g. fails to
                     setup semaphores, parallelization is disabled and an  er‚Äê
                     ror is returned.

              <b>g</b><b>e</b><b>t</b><b>-</b><b>n</b><b>-</b><b>t</b><b>h</b><b>r</b><b>e</b><b>a</b><b>d</b><b>s</b>
                     Return  the  number  of threads used for building logical
                     flows.

              <b>i</b><b>n</b><b>c</b><b>-</b><b>e</b><b>n</b><b>g</b><b>i</b><b>n</b><b>e</b><b>/</b><b>s</b><b>h</b><b>o</b><b>w</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>s</b>
                     Display <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> engine counters. For each engine  node
                     the following counters have been added:

                     ‚Ä¢      <b>r</b><b>e</b><b>c</b><b>o</b><b>m</b><b>p</b><b>u</b><b>t</b><b>e</b>

                     ‚Ä¢      <b>c</b><b>o</b><b>m</b><b>p</b><b>u</b><b>t</b><b>e</b>

                     ‚Ä¢      <b>a</b><b>b</b><b>o</b><b>r</b><b>t</b>

              <b>i</b><b>n</b><b>c</b><b>-</b><b>e</b><b>n</b><b>g</b><b>i</b><b>n</b><b>e</b><b>/</b><b>s</b><b>h</b><b>o</b><b>w</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>s</b> <u>e</u><u>n</u><u>g</u><u>i</u><u>n</u><u>e</u><b>_</b><u>n</u><u>o</u><u>d</u><u>e</u><b>_</b><u>n</u><u>a</u><u>m</u><u>e</u> <u>c</u><u>o</u><u>u</u><u>n</u><u>t</u><u>e</u><u>r</u><b>_</b><u>n</u><u>a</u><u>m</u><u>e</u>
                     Display  the  <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> engine counter(s) for the speci‚Äê
                     fied <u>e</u><u>n</u><u>g</u><u>i</u><u>n</u><u>e</u><b>_</b><u>n</u><u>o</u><u>d</u><u>e</u><b>_</b><u>n</u><u>a</u><u>m</u><u>e</u>. <u>c</u><u>o</u><u>u</u><u>n</u><u>t</u><u>e</u><u>r</u><b>_</b><u>n</u><u>a</u><u>m</u><u>e</u> is optional  and  can
                     be one of <b>r</b><b>e</b><b>c</b><b>o</b><b>m</b><b>p</b><b>u</b><b>t</b><b>e</b>, <b>c</b><b>o</b><b>m</b><b>p</b><b>u</b><b>t</b><b>e</b> or <b>a</b><b>b</b><b>o</b><b>r</b><b>t</b>.

              <b>i</b><b>n</b><b>c</b><b>-</b><b>e</b><b>n</b><b>g</b><b>i</b><b>n</b><b>e</b><b>/</b><b>c</b><b>l</b><b>e</b><b>a</b><b>r</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>s</b>
                     Reset <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> engine counters.

       Only <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b><b>-</b><b>d</b><b>d</b><b>l</b><b>o</b><b>g</b> supports the following commands:

              <b>e</b><b>n</b><b>a</b><b>b</b><b>l</b><b>e</b><b>-</b><b>c</b><b>p</b><b>u</b><b>-</b><b>p</b><b>r</b><b>o</b><b>f</b><b>i</b><b>l</b><b>i</b><b>n</b><b>g</b>
              <b>d</b><b>i</b><b>s</b><b>a</b><b>b</b><b>l</b><b>e</b><b>-</b><b>c</b><b>p</b><b>u</b><b>-</b><b>p</b><b>r</b><b>o</b><b>f</b><b>i</b><b>l</b><b>i</b><b>n</b><b>g</b>
                   Enables or disables profiling of CPU time used by the DDlog
                   engine.  When CPU profiling is enabled, the <b>p</b><b>r</b><b>o</b><b>f</b><b>i</b><b>l</b><b>e</b> command
                   (see below) will include DDlog CPU usage statistics in  its
                   output.  Enabling CPU profiling will slow <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b><b>-</b><b>d</b><b>d</b><b>l</b><b>o</b><b>g</b>.
                   Disabling CPU  profiling  does  not  clear  any  previously
                   recorded statistics.

              <b>p</b><b>r</b><b>o</b><b>f</b><b>i</b><b>l</b><b>e</b>
                   Outputs a profile of the current and peak sizes of arrange‚Äê
                   ments  inside  DDlog. This profiling data can be useful for
                   optimizing DDlog code. If CPU profiling was previously  en‚Äê
                   abled  (even if it was later disabled), the output also in‚Äê
                   cludes a CPU time profile. See <b>P</b><b>r</b><b>o</b><b>f</b><b>i</b><b>l</b><b>i</b><b>n</b><b>g</b> inside the  tutor‚Äê
                   ial  in the DDlog repository for an introduction to profil‚Äê
                   ing DDlog.

<b>A</b><b>C</b><b>T</b><b>I</b><b>V</b><b>E</b><b>-</b><b>S</b><b>T</b><b>A</b><b>N</b><b>D</b><b>B</b><b>Y</b> <b>F</b><b>O</b><b>R</b> <b>H</b><b>I</b><b>G</b><b>H</b> <b>A</b><b>V</b><b>A</b><b>I</b><b>L</b><b>A</b><b>B</b><b>I</b><b>L</b><b>I</b><b>T</b><b>Y</b>
       You may run <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> more than once in an OVN deployment.  When  con‚Äê
       nected  to  a  standalone or clustered DB setup, OVN will automatically
       ensure that only one of them is active at a time. If multiple instances
       of <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> are running and the active <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> fails, one  of  the
       hot standby instances of <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> will automatically take over.

   <b>A</b><b>c</b><b>t</b><b>i</b><b>v</b><b>e</b><b>-</b><b>S</b><b>t</b><b>a</b><b>n</b><b>d</b><b>b</b><b>y</b> <b>w</b><b>i</b><b>t</b><b>h</b> <b>m</b><b>u</b><b>l</b><b>t</b><b>i</b><b>p</b><b>l</b><b>e</b> <b>O</b><b>V</b><b>N</b> <b>D</b><b>B</b> <b>s</b><b>e</b><b>r</b><b>v</b><b>e</b><b>r</b><b>s</b>
       You may run multiple OVN DB servers in an OVN deployment with:

              ‚Ä¢      OVN  DB  servers deployed in active/passive mode with one
                     active and multiple passive ovsdb-servers.

              ‚Ä¢      <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> also deployed on all these nodes,  using  unix
                     ctl sockets to connect to the local OVN DB servers.

       In  such deployments, the ovn-northds on the passive nodes will process
       the DB changes and compute logical flows to be thrown  out  later,  be‚Äê
       cause  write transactions are not allowed by the passive ovsdb-servers.
       It results in unnecessary CPU usage.

       With the help of  runtime  management  command  <b>p</b><b>a</b><b>u</b><b>s</b><b>e</b>,  you  can  pause
       <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>  on these nodes. When a passive node becomes master, you can
       use the runtime management command <b>r</b><b>e</b><b>s</b><b>u</b><b>m</b><b>e</b> to resume the  <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>  to
       process the DB changes.

<b>L</b><b>O</b><b>G</b><b>I</b><b>C</b><b>A</b><b>L</b> <b>F</b><b>L</b><b>O</b><b>W</b> <b>T</b><b>A</b><b>B</b><b>L</b><b>E</b> <b>S</b><b>T</b><b>R</b><b>U</b><b>C</b><b>T</b><b>U</b><b>R</b><b>E</b>
       One  of the main purposes of <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> is to populate the <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>F</b><b>l</b><b>o</b><b>w</b>
       table in  the  <b>O</b><b>V</b><b>N</b><b>_</b><b>S</b><b>o</b><b>u</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database.  This  section  describes  how
       <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> does this for switch and router logical datapaths.

   <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b> <b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b> <b>D</b><b>a</b><b>t</b><b>a</b><b>p</b><b>a</b><b>t</b><b>h</b><b>s</b>
     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>0</u><u>:</u> <u>A</u><u>d</u><u>m</u><u>i</u><u>s</u><u>s</u><u>i</u><u>o</u><u>n</u> <u>C</u><u>o</u><u>n</u><u>t</u><u>r</u><u>o</u><u>l</u> <u>a</u><u>n</u><u>d</u> <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>P</u><u>o</u><u>r</u><u>t</u> <u>S</u><u>e</u><u>c</u><u>u</u><u>r</u><u>i</u><u>t</u><u>y</u> <u>c</u><u>h</u><u>e</u><u>c</u><u>k</u>

       Ingress table 0 contains these logical flows:

              ‚Ä¢      Priority 100 flows to drop packets with VLAN tags or mul‚Äê
                     ticast Ethernet source addresses.

              ‚Ä¢      For  each  disabled  logical port, a priority 100 flow is
                     added which matches on all packets and applies the action
                     <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b><b>"</b> <b>=</b> <b>1</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b><b>"</b> so that the packets are
                     dropped in the next stage.

              ‚Ä¢      For each (enabled) vtep logical port, a priority 70  flow
                     is added which matches on all packets and applies the ac‚Äê
                     tion  <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>i</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b> <b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>=</b><b>S</b><b>_</b><b>S</b><b>W</b><b>I</b><b>T</b><b>C</b><b>H</b><b>_</b><b>I</b><b>N</b><b>_</b><b>L</b><b>2</b><b>_</b><b>L</b><b>K</b><b>U</b><b>P</b><b>)</b> <b>=</b>
                     <b>1</b><b>;</b> to skip most stages of ingress  pipeline  and  go  di‚Äê
                     rectly to ingress L2 lookup table to determine the output
                     port.  Packets from VTEP (RAMP) switch should not be sub‚Äê
                     jected to any ACL checks. Egress pipeline will do the ACL
                     checks.

              ‚Ä¢      For each enabled logical port configured with qdisc queue
                     id  in  the  <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>q</b><b>d</b><b>i</b><b>s</b><b>c</b><b>_</b><b>q</b><b>u</b><b>e</b><b>u</b><b>e</b><b>_</b><b>i</b><b>d</b>   column   of   <b>L</b><b>o</b><b>g</b><b>i</b>‚Äê‚Äê
                     <b>c</b><b>a</b><b>l</b><b>_</b><b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b>,  a  priority  70  flow  is  added  which
                     matches  on  all   packets   and   applies   the   action
                     <b>s</b><b>e</b><b>t</b><b>_</b><b>q</b><b>u</b><b>e</b><b>u</b><b>e</b><b>(</b><b>i</b><b>d</b><b>)</b><b>;</b>           <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b><b>"</b>          <b>=</b>
                     <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>i</b><b>n</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>s</b><b>e</b><b>c</b><b>(</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b><b>"</b>.

              ‚Ä¢      A priority 1 flow is added which matches on  all  packets
                     for  all  the  logical  ports and applies the action <b>R</b><b>E</b><b>G</b>‚Äê‚Äê
                     <b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b><b>"</b> <b>=</b> <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>i</b><b>n</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>s</b><b>e</b><b>c</b><b>(</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> to evalu‚Äê
                     ate the port security. The action  <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>i</b><b>n</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>s</b><b>e</b><b>c</b>  ap‚Äê
                     plies  the  port security rules defined in the <b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>s</b><b>e</b><b>c</b><b>u</b>‚Äê‚Äê
                     <b>r</b><b>i</b><b>t</b><b>y</b> column of <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b> table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>:</u> <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>P</u><u>o</u><u>r</u><u>t</u> <u>S</u><u>e</u><u>c</u><u>u</u><u>r</u><u>i</u><u>t</u><u>y</u> <u>-</u> <u>A</u><u>p</u><u>p</u><u>l</u><u>y</u>

       This table drops the packets if the port security check failed  in  the
       previous stage i.e the register bit <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b> is set to 1.

       Ingress table 1 contains these logical flows:

              ‚Ä¢      A  priority-50 fallback flow that drops the packet if the
                     register bit <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b> is set to 1.

              ‚Ä¢      One priority-0 fallback flow that matches all packets and
                     advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>:</u> <u>L</u><u>o</u><u>o</u><u>k</u><u>u</u><u>p</u> <u>M</u><u>A</u><u>C</u> <u>a</u><u>d</u><u>d</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>l</u><u>e</u><u>a</u><u>r</u><u>n</u><u>i</u><u>n</u><u>g</u> <u>t</u><u>a</u><u>b</u><u>l</u><u>e</u>

       This table looks up the MAC learning table of the logical switch  data‚Äê
       path to check if the <b>p</b><b>o</b><b>r</b><b>t</b><b>-</b><b>m</b><b>a</b><b>c</b> pair is present or not. MAC is learnt for
       logical  switch VIF ports whose port security is disabled and ‚Äôunknown‚Äô
       address  setn  as  well  as  for  localnet  ports  with  option  local‚Äê
       net_learn_fdb.  A localnet port entry does not overwrite a VIF port en‚Äê
       try.

              ‚Ä¢      For each such VIF logical port <u>p</u> whose port  security  is
                     disabled  and  ‚Äôunknown‚Äô  address  set  following flow is
                     added.

                     ‚Ä¢      Priority 100 flow with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b>  <u>p</u>  and
                            action  <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>1</b><b>]</b>  <b>=</b>  <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>f</b><b>d</b><b>b</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b>  <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>)</b><b>;</b>
                            <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>

              ‚Ä¢      For each such localnet logical port <u>p</u> following  flow  is
                     added.

                     ‚Ä¢      Priority  100  flow with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>p</u> and
                            action   <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>n</b><b>e</b><b>t</b>   <b>=</b>    <b>1</b><b>;</b>    <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>1</b><b>]</b>    <b>=</b>
                            <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>f</b><b>d</b><b>b</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>

              ‚Ä¢      One priority-0 fallback flow that matches all packets and
                     advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>3</u><u>:</u> <u>L</u><u>e</u><u>a</u><u>r</u><u>n</u> <u>M</u><u>A</u><u>C</u> <u>o</u><u>f</u> <u>‚</u>Äô<u>u</u><u>n</u><u>k</u><u>n</u><u>o</u><u>w</u><u>n</u><u>‚</u>Äô <u>p</u><u>o</u><u>r</u><u>t</u><u>s</u><u>.</u>

       This table learns the MAC addresses seen on the VIF logical ports whose
       port  security  is disabled and ‚Äôunknown‚Äô address set as well as on lo‚Äê
       calnet ports with localnet_learn_fdb option set if the  <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>f</b><b>d</b><b>b</b>  ac‚Äê
       tion  returned  false  in  the previous table. For localnet ports (with
       flags.localnet = 1), lookup_fdb returns true if (port, mac) is found or
       if a mac is found for a port of type vif.

              ‚Ä¢      For each such VIF logical port <u>p</u> whose port  security  is
                     disabled and ‚Äôunknown‚Äô address set and localnet port fol‚Äê
                     lowing flow is added.

                     ‚Ä¢      Priority  100  flow  with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>p</u> &amp;&amp;&amp;&amp;
                            <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>1</b><b>]</b> <b>=</b><b>=</b> <b>0</b> and action <b>p</b><b>u</b><b>t</b><b>_</b><b>f</b><b>d</b><b>b</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>)</b><b>;</b>
                            <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> which stores the <b>p</b><b>o</b><b>r</b><b>t</b><b>-</b><b>m</b><b>a</b><b>c</b> in the mac  learn‚Äê
                            ing  table  of the logical switch datapath and ad‚Äê
                            vances the packet to the next table.

              ‚Ä¢      One priority-0 fallback flow that matches all packets and
                     advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>4</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>P</u><u>r</u><u>e</u><u>-</u><u>A</u><u>C</u><u>L</u><u>s</u>

       This table prepares flows  for  possible  stateful  ACL  processing  in
       ingress  table  <b>A</b><b>C</b><b>L</b><b>s</b>.  It  contains a priority-0 flow that simply moves
       traffic to the next table. If stateful ACLs are  used  in  the  logical
       datapath, a priority-100 flow is added that sets a hint (with <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>]</b> <b>=</b>
       <b>1</b><b>;</b>  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>)  for table <b>P</b><b>r</b><b>e</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>f</b><b>u</b><b>l</b> to send IP packets to the connection
       tracker before eventually advancing to ingress table <b>A</b><b>C</b><b>L</b><b>s</b>.  If  special
       ports  such  as  route ports or localnet ports can‚Äôt use ct(), a prior‚Äê
       ity-110 flow is added to  skip  over  stateful  ACLs.  Multicast,  IPv6
       Neighbor  Discovery  and MLD traffic also skips stateful ACLs. For "al‚Äê
       low-stateless" ACLs, a flow is added to bypass  setting  the  hint  for
       connection tracker processing when there are stateful ACLs or LB rules;
       <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>A</b><b>C</b><b>L</b><b>_</b><b>S</b><b>T</b><b>A</b><b>T</b><b>E</b><b>L</b><b>E</b><b>S</b><b>S</b> is set for traffic matching stateless ACL flows.

       This table also has a priority-110 flow with the match <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>E</u> for
       all logical switch datapaths to move traffic to the next table. Where <u>E</u>
       is  the service monitor mac defined in the <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>s</b><b>v</b><b>c</b><b>_</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b><b>_</b><b>m</b><b>a</b><b>c</b> col‚Äê
       umn of <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>5</u><u>:</u> <u>P</u><u>r</u><u>e</u><u>-</u><u>L</u><u>B</u>

       This table prepares flows for possible stateful load balancing process‚Äê
       ing in ingress table <b>L</b><b>B</b> and <b>S</b><b>t</b><b>a</b><b>t</b><b>e</b><b>f</b><b>u</b><b>l</b>. It  contains  a  priority-0  flow
       that  simply  moves traffic to the next table. Moreover it contains two
       priority-110 flows to move multicast, IPv6 Neighbor Discovery  and  MLD
       traffic  to  the next table. It also contains two priority-110 flows to
       move stateless traffic, i.e traffic for which  <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>A</b><b>C</b><b>L</b><b>_</b><b>S</b><b>T</b><b>A</b><b>T</b><b>E</b><b>L</b><b>E</b><b>S</b><b>S</b>  is
       set,  to  the  next  table. If load balancing rules with virtual IP ad‚Äê
       dresses (and ports) are configured in  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database  for  a
       logical switch datapath, a priority-100 flow is added with the match <b>i</b><b>p</b>
       to match on IP packets and sets the action <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>1</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> to act as
       a  hint  for  table  <b>P</b><b>r</b><b>e</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>f</b><b>u</b><b>l</b>  to send IP packets to the connection
       tracker for packet de-fragmentation (and to possibly do  DNAT  for  al‚Äê
       ready established load balanced traffic) before eventually advancing to
       ingress  table  <b>S</b><b>t</b><b>a</b><b>t</b><b>e</b><b>f</b><b>u</b><b>l</b>. If controller_event has been enabled and load
       balancing rules with empty backends have been added in  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>,
       a 130 flow is added to trigger ovn-controller events whenever the chas‚Äê
       sis  receives  a packet for that particular VIP. If <b>e</b><b>v</b><b>e</b><b>n</b><b>t</b><b>-</b><b>e</b><b>l</b><b>b</b> meter has
       been previously created, it will be associated to the empty_lb  logical
       flow

       Prior  to <b>O</b><b>V</b><b>N</b> <b>2</b><b>0</b><b>.</b><b>0</b><b>9</b> we were setting the <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>]</b> <b>=</b> <b>1</b> only if the IP des‚Äê
       tination matches the load balancer VIP. However  this  had  few  issues
       cases  where  a logical switch doesn‚Äôt have any ACLs with <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>r</b><b>e</b><b>l</b><b>a</b><b>t</b><b>e</b><b>d</b>
       action. To understand the issue lets a  take  a  TCP  load  balancer  -
       <b>1</b><b>0</b><b>.</b><b>0</b><b>.</b><b>0</b><b>.</b><b>1</b><b>0</b><b>:</b><b>8</b><b>0</b><b>=</b><b>1</b><b>0</b><b>.</b><b>0</b><b>.</b><b>0</b><b>.</b><b>3</b><b>:</b><b>8</b><b>0</b>.  If  a  logical  port - p1 with IP - 10.0.0.5
       opens a TCP connection with the VIP - 10.0.0.10, then the packet in the
       ingress pipeline of ‚Äôp1‚Äô is sent to the p1‚Äôs conntrack zone id and  the
       packet is load balanced to the backend - 10.0.0.3. For the reply packet
       from  the  backend  lport,  it  is not sent to the conntrack of backend
       lport‚Äôs zone id. This is fine as long as the packet is  valid.  Suppose
       the  backend lport sends an invalid TCP packet (like incorrect sequence
       number), the packet gets delivered to the lport ‚Äôp1‚Äô without  unDNATing
       the packet to the VIP - 10.0.0.10. And this causes the connection to be
       reset by the lport p1‚Äôs VIF.

       We can‚Äôt fix this issue by adding a logical flow to drop ct.inv packets
       in  the  egress  pipeline  since it will drop all other connections not
       destined to the load balancers. To fix this  issue,  we  send  all  the
       packets  to the conntrack in the ingress pipeline if a load balancer is
       configured. We can now add a lflow to drop ct.inv packets.

       This table also has priority-120 flows that punt all  IGMP/MLD  packets
       to  <b>o</b><b>v</b><b>n</b><b>-</b><b>c</b><b>o</b><b>n</b><b>t</b><b>r</b><b>o</b><b>l</b><b>l</b><b>e</b><b>r</b>  if the switch is an interconnect switch with multi‚Äê
       cast snooping enabled.

       This table also has a priority-110 flow with the match <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>E</u> for
       all logical switch datapaths to move traffic to the next table. Where <u>E</u>
       is the service monitor mac defined in the <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>s</b><b>v</b><b>c</b><b>_</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b><b>_</b><b>m</b><b>a</b><b>c</b>  col‚Äê
       umn of <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table.

       This  table also has a priority-110 flow with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>I</u> for
       all logical switch datapaths to move traffic to the next table. Where <u>I</u>
       is the peer of a logical router port. This flow is added  to  skip  the
       connection tracking of packets which enter from logical router datapath
       to logical switch datapath.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>6</u><u>:</u> <u>P</u><u>r</u><u>e</u><u>-</u><u>s</u><u>t</u><u>a</u><u>t</u><u>e</u><u>f</u><u>u</u><u>l</u>

       This  table prepares flows for all possible stateful processing in next
       tables. It contains a priority-0 flow that simply moves traffic to  the
       next table.

              ‚Ä¢      Priority-120  flows  that  send the packets to connection
                     tracker using <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>;</b> as the action so that  the  al‚Äê
                     ready  established  traffic destined to the load balancer
                     VIP gets DNATted. These flows  match  each  VIPs  IP  and
                     port.  For  IPv4 traffic the flows also load the original
                     destination IP and transport port in registers  <b>r</b><b>e</b><b>g</b><b>1</b>  and
                     <b>r</b><b>e</b><b>g</b><b>2</b>.  For  IPv6 traffic the flows also load the original
                     destination IP and transport port in registers <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b> and
                     <b>r</b><b>e</b><b>g</b><b>2</b>.

              ‚Ä¢      A priority-110 flow sends the packets  that  don‚Äôt  match
                     the  above  flows  to  connection tracker based on a hint
                     provided by the previous tables (with a match for <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>2</b><b>]</b>
                     <b>=</b><b>=</b> <b>1</b>) by using the <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>;</b> action.

              ‚Ä¢      A priority-100  flow  sends  the  packets  to  connection
                     tracker  based  on a hint provided by the previous tables
                     (with a match for <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>]</b> <b>=</b><b>=</b> <b>1</b>) by using the <b>c</b><b>t</b><b>_</b><b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> ac‚Äê
                     tion.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>7</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>A</u><u>C</u><u>L</u> <u>h</u><u>i</u><u>n</u><u>t</u><u>s</u>

       This table consists of logical flows that set hints (<b>r</b><b>e</b><b>g</b><b>0</b> bits)  to  be
       used  in  the next stage, in the ACL processing table, if stateful ACLs
       or load balancers are configured. Multiple hints can  be  set  for  the
       same packet. The possible hints are:

              ‚Ä¢      <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>7</b><b>]</b>:  the packet might match an <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>r</b><b>e</b><b>l</b><b>a</b><b>t</b><b>e</b><b>d</b> ACL and
                     might have to commit the connection to conntrack.

              ‚Ä¢      <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>8</b><b>]</b>: the packet might match an <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>r</b><b>e</b><b>l</b><b>a</b><b>t</b><b>e</b><b>d</b> ACL  but
                     there  will  be  no need to commit the connection to con‚Äê
                     ntrack because it already exists.

              ‚Ä¢      <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>9</b><b>]</b>: the packet might match a <b>d</b><b>r</b><b>o</b><b>p</b><b>/</b><b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b>.

              ‚Ä¢      <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>0</b><b>]</b>: the packet might match a  <b>d</b><b>r</b><b>o</b><b>p</b><b>/</b><b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b>  ACL  but
                     the connection was previously allowed so it might have to
                     be committed again with <b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b><b>=</b><b>1</b><b>/</b><b>1</b>.

       The table contains the following flows:

              ‚Ä¢      A priority-65535 flow to advance to the next table if the
                     logical switch has <b>n</b><b>o</b> ACLs configured, otherwise a prior‚Äê
                     ity-0 flow to advance to the next table.

              ‚Ä¢      A priority-7 flow that matches on packets that initiate a
                     new  session. This flow sets <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>7</b><b>]</b> and <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>9</b><b>]</b> and then
                     advances to the next table.

              ‚Ä¢      A priority-6 flow that matches on packets that are in the
                     request direction of an already existing session that has
                     been marked  as  blocked.  This  flow  sets  <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>7</b><b>]</b>  and
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>9</b><b>]</b> and then advances to the next table.

              ‚Ä¢      A  priority-5  flow  that matches untracked packets. This
                     flow sets <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>8</b><b>]</b> and <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>9</b><b>]</b> and then  advances  to  the
                     next table.

              ‚Ä¢      A priority-4 flow that matches on packets that are in the
                     request direction of an already existing session that has
                     not  been  marked  as blocked. This flow sets <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>8</b><b>]</b> and
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>0</b><b>]</b> and then advances to the next table.

              ‚Ä¢      A priority-3 flow that matches on packets that are in not
                     part of established sessions. This flow sets <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>9</b><b>]</b>  and
                     then advances to the next table.

              ‚Ä¢      A  priority-2  flow that matches on packets that are part
                     of  an  established  session  that  has  been  marked  as
                     blocked.  This flow sets <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>9</b><b>]</b> and then advances to the
                     next table.

              ‚Ä¢      A priority-1 flow that matches on packets that  are  part
                     of  an  established  session  that has not been marked as
                     blocked. This flow sets <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>0</b><b>]</b> and then advances to the
                     next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>t</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>8</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>A</u><u>C</u><u>L</u> <u>e</u><u>v</u><u>a</u><u>l</u><u>u</u><u>a</u><u>t</u><u>i</u><u>o</u><u>n</u> <u>b</u><u>e</u><u>f</u><u>o</u><u>r</u><u>e</u> <u>L</u><u>B</u>

       Logical flows in this table closely reproduce those in the <b>A</b><b>C</b><b>L</b> table in
       the <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database for the <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b>  direction  without  the
       option <b>a</b><b>p</b><b>p</b><b>l</b><b>y</b><b>-</b><b>a</b><b>f</b><b>t</b><b>e</b><b>r</b><b>-</b><b>l</b><b>b</b> set or set to <b>f</b><b>a</b><b>l</b><b>s</b><b>e</b>. The <b>p</b><b>r</b><b>i</b><b>o</b><b>r</b><b>i</b><b>t</b><b>y</b> values from the
       <b>A</b><b>C</b><b>L</b>  table  have  a  limited range and have 1000 added to them to leave
       room for OVN default flows at both higher and lower priorities.

              ‚Ä¢      This table is responsible for evaluating ACLs,  and  set‚Äê
                     ting  a  register bit to indicate whether the ACL decided
                     to allow, drop, or reject the traffic. The allow  bit  is
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>]</b>. The drop bit is <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>7</b><b>]</b>. All flows in this ta‚Äê
                     ble  will advance the packet to the next table, where the
                     bits from before are evaluated to determine  what  to  do
                     with  the packet. Any flows in this table that intend for
                     the packet to pass will set <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>]</b> to 1, even if an ACL
                     with an allow-type action was not matched. This lets  the
                     next  table know to allow the traffic to pass. These bits
                     will be referred to as the "allow", "drop", and  "reject"
                     bits in the upcoming paragraphs.

              ‚Ä¢      If  the  <b>t</b><b>i</b><b>e</b><b>r</b> column has been configured on the ACL, then
                     OVN will also match the current tier counter against  the
                     configured  ACL tier. OVN keeps count of the current tier
                     in <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>3</b><b>0</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b>.

              ‚Ä¢      <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b> ACLs translate into logical flows that set the  al‚Äê
                     low bit to 1 and advance the packet to the next table. If
                     there  are any stateful ACLs on this datapath, then <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b>
                     ACLs set the allow bit to one  and  in  addition  perform
                     <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b><b>;</b>  (which  acts  as  a hint for future tables to
                     commit the connection to conntrack). In case the <b>A</b><b>C</b><b>L</b>  has
                     a  label  then  <b>r</b><b>e</b><b>g</b><b>3</b>  is  loaded with the label value and
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>3</b><b>]</b> bit is set to 1 (which acts as a  hint  for  the
                     next tables to commit the label to conntrack).

              ‚Ä¢      <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>r</b><b>e</b><b>l</b><b>a</b><b>t</b><b>e</b><b>d</b>  ACLs translate into logical flows that set
                     the allow  bit  and  additionally  have  <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b><b>(</b><b>c</b><b>t</b><b>_</b><b>l</b><b>a</b>‚Äê‚Äê
                     <b>b</b><b>e</b><b>l</b><b>=</b><b>0</b><b>/</b><b>1</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> actions for new connections and <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>]</b> <b>=</b>
                     <b>1</b><b>;</b>  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> for existing connections. In case the <b>A</b><b>C</b><b>L</b> has a
                     label then <b>r</b><b>e</b><b>g</b><b>3</b>  is  loaded  with  the  label  value  and
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>3</b><b>]</b>  bit  is  set to 1 (which acts as a hint for the
                     next tables to commit the label to conntrack).

              ‚Ä¢      <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b> ACLs translate into  logical  flows  that
                     set the allow bit and advance to the next table.

              ‚Ä¢      <b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b>  ACLs  translate  into logical flows with that set
                     the reject bit and advance to the next table.

              ‚Ä¢      <b>p</b><b>a</b><b>s</b><b>s</b> ACLs translate into logical flows that  do  not  set
                     the  allow,  drop,  or reject bit and advance to the next
                     table.

              ‚Ä¢      Other ACLs set the drop bit and advance to the next table
                     for new or untracked connections. For known  connections,
                     they  set  the  drop  bit, as well as running the <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b>‚Äê‚Äê
                     <b>m</b><b>i</b><b>t</b><b>(</b><b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b><b>=</b><b>1</b><b>/</b><b>1</b><b>)</b><b>;</b> action. Setting <b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b> marks a  con‚Äê
                     nection as one that was previously allowed, but should no
                     longer be allowed due to a policy change.

       This  table contains a priority-65535 flow to set the allow bit and ad‚Äê
       vance to the next table if the logical switch has <b>n</b><b>o</b>  ACLs  configured,
       otherwise a priority-0 flow to advance to the next table is added. This
       flow  does  not  set  the  allow bit, so that the next table can decide
       whether to allow or drop the packet based  on  the  value  of  the  <b>o</b><b>p</b>‚Äê‚Äê
       <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>d</b><b>e</b><b>f</b><b>a</b><b>u</b><b>l</b><b>t</b><b>_</b><b>a</b><b>c</b><b>l</b><b>_</b><b>d</b><b>r</b><b>o</b><b>p</b> column of the <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table.

       A  priority-65532 flow is added that sets the allow bit for IPv6 Neigh‚Äê
       bor solicitation, Neighbor discover, Router solicitation, Router adver‚Äê
       tisement and MLD packets regardless of other ACLs defined.

       If the logical datapath has a stateful ACL or a load balancer with  VIP
       configured, the following flows will also be added:

              ‚Ä¢      If  <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>d</b><b>e</b><b>f</b><b>a</b><b>u</b><b>l</b><b>t</b><b>_</b><b>a</b><b>c</b><b>l</b><b>_</b><b>d</b><b>r</b><b>o</b><b>p</b> column of <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> is <b>f</b><b>a</b><b>l</b><b>s</b><b>e</b>
                     or not set, a priority-1 flow that sets the hint to  com‚Äê
                     mit  IP  traffic that is not part of established sessions
                     to the connection  tracker  (with  action  <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>]</b>  <b>=</b>  <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>).  This  is needed for the default allow policy be‚Äê
                     cause, while the initiator‚Äôs direction may not  have  any
                     stateful  rules,  the  server‚Äôs  may  and then its return
                     traffic would not be known and marked as invalid.

              ‚Ä¢      A priority-1 flow that sets the allow bit  and  sets  the
                     hint to commit IP traffic to the connection tracker (with
                     action  <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>]</b>  <b>=</b>  <b>1</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>). This is needed for the de‚Äê
                     fault allow policy because, while the initiator‚Äôs  direc‚Äê
                     tion  may  not  have any stateful rules, the server‚Äôs may
                     and then its return traffic would not be known and marked
                     as invalid.

              ‚Ä¢      A priority-65532 flow that sets the  allow  bit  for  any
                     traffic  in the reply direction for a connection that has
                     been committed to the connection  tracker  (i.e.,  estab‚Äê
                     lished  flows),  as  long  as the committed flow does not
                     have <b>c</b><b>t</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>.</b><b>b</b><b>l</b><b>o</b><b>c</b><b>k</b><b>e</b><b>d</b> set. We only handle traffic  in  the
                     reply direction here because we want all packets going in
                     the  request direction to still go through the flows that
                     implement the currently defined policy based on ACLs.  If
                     a   connection   is   no   longer   allowed   by  policy,
                     <b>c</b><b>t</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>.</b><b>b</b><b>l</b><b>o</b><b>c</b><b>k</b><b>e</b><b>d</b> will get set and packets in the reply di‚Äê
                     rection will no longer be allowed, either. This flow also
                     clears the register bits <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>9</b><b>]</b> and  <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>0</b><b>]</b>  and  sets
                     register  bit <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>7</b><b>]</b>. If ACL logging and logging of re‚Äê
                     lated packets is enabled, then a companion priority-65533
                     flow will be installed that accomplishes the  same  thing
                     but also logs the traffic.

              ‚Ä¢      A  priority-65532  flow  that  sets the allow bit for any
                     traffic that is considered related to a committed flow in
                     the connection tracker (e.g., an  ICMP  Port  Unreachable
                     from  a non-listening UDP port), as long as the committed
                     flow does not have <b>c</b><b>t</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>.</b><b>b</b><b>l</b><b>o</b><b>c</b><b>k</b><b>e</b><b>d</b> set.  This  flow  also
                     applies  NAT  to the related traffic so that ICMP headers
                     and the inner packet have correct addresses. If ACL  log‚Äê
                     ging  and  logging  of related packets is enabled, then a
                     companion priority-65533 flow will be installed that  ac‚Äê
                     complishes the same thing but also logs the traffic.

              ‚Ä¢      A  priority-65532  flow  that  sets  the drop bit for all
                     traffic marked by the connection tracker as invalid.

              ‚Ä¢      A priority-65532 flow that sets  the  drop  bit  for  all
                     traffic  in  the reply direction with <b>c</b><b>t</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>.</b><b>b</b><b>l</b><b>o</b><b>c</b><b>k</b><b>e</b><b>d</b> set
                     meaning that the connection should no longer  be  allowed
                     due  to a policy change. Packets in the request direction
                     are skipped here to let a newly created ACL re-allow this
                     connection.

       If the logical datapath has any ACL or a load balancer with VIP config‚Äê
       ured, the following flow will also be added:

              ‚Ä¢      A priority 34000 logical flow is added for  each  logical
                     switch  datapath  with the match <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u> to allow the
                     service monitor reply packet destined  to  <b>o</b><b>v</b><b>n</b><b>-</b><b>c</b><b>o</b><b>n</b><b>t</b><b>r</b><b>o</b><b>l</b><b>l</b><b>e</b><b>r</b>
                     that  sets  the allow bit, where <u>E</u> is the service monitor
                     mac defined  in  the  <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>s</b><b>v</b><b>c</b><b>_</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b><b>_</b><b>m</b><b>a</b><b>c</b>  column  of
                     <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>9</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>A</u><u>C</u><u>L</u> <u>a</u><u>c</u><u>t</u><u>i</u><u>o</u><u>n</u>

       Logical  flows  in this table decide how to proceed based on the values
       of the allow, drop, and reject bits that may have been set in the  pre‚Äê
       vious table.

              ‚Ä¢      If  no ACLs are configured, then a priority 0 flow is in‚Äê
                     stalled that matches everything and advances to the  next
                     table.

              ‚Ä¢      A  priority  1000 flow is installed that will advance the
                     packet to the next table if the allow bit is set.

              ‚Ä¢      A priority 1000 flow is installed that will run the <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>
                     action if the drop bit is set.

              ‚Ä¢      A priority 1000 flow  is  installed  that  will  run  the
                     <b>t</b><b>c</b><b>p</b><b>_</b><b>r</b><b>e</b><b>s</b><b>e</b><b>t</b>  <b>{</b>  <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b> <lt;<lt;<b>-</b>>gt;>gt; <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>e</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b><b>t</b><b>a</b>‚Äê‚Äê
                     <b>b</b><b>l</b><b>e</b><b>=</b><b>5</b><b>)</b><b>;</b><b>}</b> action for  TCP  connections,<b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>/</b><b>i</b><b>c</b><b>m</b><b>p</b><b>6</b>  action
                     for  UDP  connections,  and <b>s</b><b>c</b><b>t</b><b>p</b><b>_</b><b>a</b><b>b</b><b>o</b><b>r</b><b>t</b> <b>{</b><b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b> <lt;<lt;<b>-</b><b>%</b><b>g</b><b>t</b><b>;</b> <b>i</b><b>n</b>‚Äê‚Äê
                     <b>p</b><b>o</b><b>r</b><b>t</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>e</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b><b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>=</b><b>5</b><b>)</b><b>;</b><b>}</b> action for SCTP as‚Äê
                     sociations.

              ‚Ä¢      If any ACLs have tiers configured  on  them,  then  three
                     priority  500  flows  are  installed. If the current tier
                     counter is 0, 1, or 2, then the current tier  counter  is
                     incremented  by  one  and  the packet is sent back to the
                     previous table for re-evaluation.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>0</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>Q</u><u>o</u><u>S</u> <u>M</u><u>a</u><u>r</u><u>k</u><u>i</u><u>n</u><u>g</u>

       Logical flows in this table closely reproduce those in  the  <b>Q</b><b>o</b><b>S</b>  table
       with  the  <b>a</b><b>c</b><b>t</b><b>i</b><b>o</b><b>n</b>  column  set  in  the <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database for the
       <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> direction.

              ‚Ä¢      For every qos_rules entry in a logical switch  with  DSCP
                     marking  enabled,  a  flow  will be added at the priority
                     mentioned in the QoS table.

              ‚Ä¢      One priority-0 fallback flow that matches all packets and
                     advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>1</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>Q</u><u>o</u><u>S</u> <u>M</u><u>e</u><u>t</u><u>e</u><u>r</u>

       Logical flows in this table closely reproduce those in  the  <b>Q</b><b>o</b><b>S</b>  table
       with  the  <b>b</b><b>a</b><b>n</b><b>d</b><b>w</b><b>i</b><b>d</b><b>t</b><b>h</b>  column set in the <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database for the
       <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> direction.

              ‚Ä¢      For every qos_rules entry in a logical switch with meter‚Äê
                     ing enabled, a flow will be added at  the  priority  men‚Äê
                     tioned in the QoS table.

              ‚Ä¢      One priority-0 fallback flow that matches all packets and
                     advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>2</u><u>:</u> <u>L</u><u>o</u><u>a</u><u>d</u> <u>b</u><u>a</u><u>l</u><u>a</u><u>n</u><u>c</u><u>i</u><u>n</u><u>g</u> <u>a</u><u>f</u><u>f</u><u>i</u><u>n</u><u>i</u><u>t</u><u>y</u> <u>c</u><u>h</u><u>e</u><u>c</u><u>k</u>

       Load  balancing  affinity  check  table  contains the following logical
       flows:

              ‚Ä¢      For all the configured load balancing rules for a  switch
                     in  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database  where  a  positive affinity
                     timeout is specified in <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> column, that  includes  a
                     L4  port  <u>P</u><u>O</u><u>R</u><u>T</u> of protocol <u>P</u> and IP address <u>V</u><u>I</u><u>P</u>, a prior‚Äê
                     ity-100 flow is added. For IPv4 <u>V</u><u>I</u><u>P</u><u>s</u>,  the  flow  matches
                     <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp; <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>P</u><u>O</u><u>R</u><u>T</u>. For IPv6
                     <u>V</u><u>I</u><u>P</u><u>s</u>, the flow matches <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u>&amp;&amp;&amp;&amp; <u>P</u>
                     &amp;&amp;&amp;&amp;  <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>   <u>P</u><u>O</u><u>R</u><u>T</u>.  The  flow‚Äôs  action  is  <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>6</b><b>]</b> <b>=</b>
                     <b>c</b><b>h</b><b>k</b><b>_</b><b>l</b><b>b</b><b>_</b><b>a</b><b>f</b><b>f</b><b>(</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

              ‚Ä¢      A priority 0 flow is added which matches on  all  packets
                     and applies the action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>3</u><u>:</u> <u>L</u><u>B</u>

              ‚Ä¢      For  all the configured load balancing rules for a switch
                     in <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database  where  a  positive  affinity
                     timeout  is  specified in <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> column, that includes a
                     L4 port <u>P</u><u>O</u><u>R</u><u>T</u> of protocol <u>P</u> and IP address <u>V</u><u>I</u><u>P</u>,  a  prior‚Äê
                     ity-150  flow  is  added. For IPv4 <u>V</u><u>I</u><u>P</u><u>s</u>, the flow matches
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>6</b><b>]</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u>  &amp;&amp;&amp;&amp;  <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b>
                     <b>=</b><b>=</b> <u>P</u><u>O</u><u>R</u><u>T</u> . For IPv6 <u>V</u><u>I</u><u>P</u><u>s</u>, the flow matches <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>6</b><b>]</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp;
                     <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b>  &amp;&amp;&amp;&amp;  <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>  <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp; <u>P</u> &amp;&amp;&amp;&amp; <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>  <u>P</u><u>O</u><u>R</u><u>T</u>.
                     The flow‚Äôs action is <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>)</b>,  where  <u>a</u><u>r</u><u>g</u><u>s</u>  con‚Äê
                     tains  comma  separated  IP  addresses (and optional port
                     numbers) to load balance to. The address family of the IP
                     addresses of <u>a</u><u>r</u><u>g</u><u>s</u> is the same as the  address  family  of
                     <u>V</u><u>I</u><u>P</u>.

              ‚Ä¢      For  all the configured load balancing rules for a switch
                     in <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database that includes a L4  port  <u>P</u><u>O</u><u>R</u><u>T</u>
                     of  protocol <u>P</u> and IP address <u>V</u><u>I</u><u>P</u>, a priority-120 flow is
                     added. For IPv4 <u>V</u><u>I</u><u>P</u><u>s</u> , the flow matches <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp;  <b>i</b><b>p</b>  &amp;&amp;&amp;&amp;
                     <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp; <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>P</u><u>O</u><u>R</u><u>T</u>. For IPv6 <u>V</u><u>I</u><u>P</u><u>s</u>, the flow
                     matches <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp; <u>P</u> &amp;&amp;&amp;&amp;  <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>
                     <u>P</u><u>O</u><u>R</u><u>T</u>.  The flow‚Äôs action is <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>)</b> , where <u>a</u><u>r</u><u>g</u><u>s</u>
                     contains comma separated IP addresses (and optional  port
                     numbers) to load balance to. The address family of the IP
                     addresses  of  <u>a</u><u>r</u><u>g</u><u>s</u>  is the same as the address family of
                     <u>V</u><u>I</u><u>P</u>. If health check is enabled, then <u>a</u><u>r</u><u>g</u><u>s</u> will only con‚Äê
                     tain those endpoints whose service monitor  status  entry
                     in  <b>O</b><b>V</b><b>N</b><b>_</b><b>S</b><b>o</b><b>u</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> db is either <b>o</b><b>n</b><b>l</b><b>i</b><b>n</b><b>e</b> or empty. For IPv4
                     traffic the flow also loads the original  destination  IP
                     and  transport  port in registers <b>r</b><b>e</b><b>g</b><b>1</b> and <b>r</b><b>e</b><b>g</b><b>2</b>. For IPv6
                     traffic the flow also loads the original  destination  IP
                     and  transport  port  in  registers  <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b> and <b>r</b><b>e</b><b>g</b><b>2</b>. The
                     above flow is created even if the load  balancer  is  at‚Äê
                     tached to a logical router connected to the current logi‚Äê
                     cal  switch and the <b>i</b><b>n</b><b>s</b><b>t</b><b>a</b><b>l</b><b>l</b><b>_</b><b>l</b><b>s</b><b>_</b><b>l</b><b>b</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> variable in
                     <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> is set to true.

              ‚Ä¢      For all the configured load balancing rules for a  switch
                     in  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database that includes just an IP ad‚Äê
                     dress <u>V</u><u>I</u><u>P</u> to match on, OVN adds a priority-110 flow.  For
                     IPv4  <u>V</u><u>I</u><u>P</u><u>s</u>,  the  flow matches <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>
                     <u>V</u><u>I</u><u>P</u>. For IPv6 <u>V</u><u>I</u><u>P</u><u>s</u>, the flow  matches  <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b>  &amp;&amp;&amp;&amp;  <b>i</b><b>p</b>  &amp;&amp;&amp;&amp;
                     <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>   <b>=</b><b>=</b>   <u>V</u><u>I</u><u>P</u>.   The   action   on   this   flow  is
                     <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>)</b>, where <u>a</u><u>r</u><u>g</u><u>s</u> contains comma separated  IP
                     addresses  of  the  same  address family as <u>V</u><u>I</u><u>P</u>. For IPv4
                     traffic the flow also loads the original  destination  IP
                     and  transport  port in registers <b>r</b><b>e</b><b>g</b><b>1</b> and <b>r</b><b>e</b><b>g</b><b>2</b>. For IPv6
                     traffic the flow also loads the original  destination  IP
                     and  transport  port  in  registers  <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b> and <b>r</b><b>e</b><b>g</b><b>2</b>. The
                     above flow is created even if the load  balancer  is  at‚Äê
                     tached to a logical router connected to the current logi‚Äê
                     cal  switch and the <b>i</b><b>n</b><b>s</b><b>t</b><b>a</b><b>l</b><b>l</b><b>_</b><b>l</b><b>s</b><b>_</b><b>l</b><b>b</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> variable in
                     <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> is set to true.

              ‚Ä¢      If the load balancer is created with <b>-</b><b>-</b><b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b> option  and
                     it  has no active backends, a TCP reset segment (for tcp)
                     or an ICMP port unreachable packet (for all other kind of
                     traffic) will be sent whenever an incoming packet is  re‚Äê
                     ceived for this load-balancer. Please note using <b>-</b><b>-</b><b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b>
                     option will disable empty_lb SB controller event for this
                     load balancer.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>4</u><u>:</u> <u>L</u><u>o</u><u>a</u><u>d</u> <u>b</u><u>a</u><u>l</u><u>a</u><u>n</u><u>c</u><u>i</u><u>n</u><u>g</u> <u>a</u><u>f</u><u>f</u><u>i</u><u>n</u><u>i</u><u>t</u><u>y</u> <u>l</u><u>e</u><u>a</u><u>r</u><u>n</u>

       Load  balancing  affinity  learn  table  contains the following logical
       flows:

              ‚Ä¢      For all the configured load balancing rules for a  switch
                     in  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database  where  a  positive affinity
                     timeout <u>T</u> is specified in <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> column, that includes a
                     L4 port <u>P</u><u>O</u><u>R</u><u>T</u> of protocol <u>P</u> and IP address <u>V</u><u>I</u><u>P</u>,  a  prior‚Äê
                     ity-100  flow  is  added. For IPv4 <u>V</u><u>I</u><u>P</u><u>s</u>, the flow matches
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>6</b><b>]</b> <b>=</b><b>=</b> <b>0</b> &amp;&amp;&amp;&amp; <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u>  &amp;&amp;&amp;&amp;  <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b>
                     <b>=</b><b>=</b>  <u>P</u><u>O</u><u>R</u><u>T</u>. For IPv6 <u>V</u><u>I</u><u>P</u><u>s</u>, the flow matches <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp;
                     <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp; <u>P</u> &amp;&amp;&amp;&amp; <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>P</u><u>O</u><u>R</u><u>T</u> . The flow‚Äôs  action
                     is  <b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>a</b><b>f</b><b>f</b><b>(</b><b>v</b><b>i</b><b>p</b>  <b>=</b>  <u>V</u><u>I</u><u>P</u><b>:</b><u>P</u><u>O</u><u>R</u><u>T</u><b>,</b> <b>b</b><b>a</b><b>c</b><b>k</b><b>e</b><b>n</b><b>d</b> <b>=</b> <u>b</u><u>a</u><u>c</u><u>k</u><u>e</u><u>n</u><u>d</u> <u>i</u><u>p</u><b>:</b>
                     <u>b</u><u>a</u><u>c</u><u>k</u><u>e</u><u>n</u><u>d</u> <u>p</u><u>o</u><u>r</u><u>t</u><b>,</b> <b>p</b><b>r</b><b>o</b><b>t</b><b>o</b> <b>=</b> <u>P</u><b>,</b> <b>t</b><b>i</b><b>m</b><b>e</b><b>o</b><b>u</b><b>t</b> <b>=</b> <u>T</u><b>)</b><b>;</b> .

              ‚Ä¢      A priority 0 flow is added which matches on  all  packets
                     and applies the action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>5</u><u>:</u> <u>P</u><u>r</u><u>e</u><u>-</u><u>H</u><u>a</u><u>i</u><u>r</u><u>p</u><u>i</u><u>n</u>

              ‚Ä¢      If  the  logical  switch has load balancer(s) configured,
                     then a priority-100 flow is added with the  match  <b>i</b><b>p</b>  &amp;&amp;&amp;&amp;
                     <b>c</b><b>t</b><b>.</b><b>t</b><b>r</b><b>k</b>  to check if the packet needs to be hairpinned (if
                     after load  balancing  the  destination  IP  matches  the
                     source  IP)  or  not  by  executing the actions <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>6</b><b>]</b> <b>=</b>
                     <b>c</b><b>h</b><b>k</b><b>_</b><b>l</b><b>b</b><b>_</b><b>h</b><b>a</b><b>i</b><b>r</b><b>p</b><b>i</b><b>n</b><b>(</b><b>)</b><b>;</b> and <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>2</b><b>]</b> <b>=</b>  <b>c</b><b>h</b><b>k</b><b>_</b><b>l</b><b>b</b><b>_</b><b>h</b><b>a</b><b>i</b><b>r</b><b>p</b><b>i</b><b>n</b><b>_</b><b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>(</b><b>)</b><b>;</b>
                     and advances the packet to the next table.

              ‚Ä¢      A  priority-0  flow that simply moves traffic to the next
                     table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>6</u><u>:</u> <u>N</u><u>a</u><u>t</u><u>-</u><u>H</u><u>a</u><u>i</u><u>r</u><u>p</u><u>i</u><u>n</u>

              ‚Ä¢      If the logical switch has  load  balancer(s)  configured,
                     then  a  priority-100  flow is added with the match <b>i</b><b>p</b> &amp;&amp;&amp;&amp;
                     <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>c</b><b>t</b><b>.</b><b>t</b><b>r</b><b>k</b> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>6</b><b>]</b> <b>=</b><b>=</b> <b>1</b> which hairpins the traf‚Äê
                     fic by NATting source IP to the load balancer VIP by exe‚Äê
                     cuting the action <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>t</b><b>o</b><b>_</b><b>v</b><b>i</b><b>p</b> and advances the  packet
                     to the next table.

              ‚Ä¢      If  the  logical  switch has load balancer(s) configured,
                     then a priority-100 flow is added with the  match  <b>i</b><b>p</b>  &amp;&amp;&amp;&amp;
                     <b>c</b><b>t</b><b>.</b><b>e</b><b>s</b><b>t</b> &amp;&amp;&amp;&amp; <b>c</b><b>t</b><b>.</b><b>t</b><b>r</b><b>k</b> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>6</b><b>]</b> <b>=</b><b>=</b> <b>1</b> which hairpins the traf‚Äê
                     fic by NATting source IP to the load balancer VIP by exe‚Äê
                     cuting  the action <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> and advances the packet to the
                     next table.

              ‚Ä¢      If the logical switch has  load  balancer(s)  configured,
                     then  a  priority-90  flow  is added with the match <b>i</b><b>p</b> &amp;&amp;&amp;&amp;
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>2</b><b>]</b> <b>=</b><b>=</b> <b>1</b> which matches on the replies of  hairpinned
                     traffic  (i.e.,  destination  IP is VIP, source IP is the
                     backend IP and source L4 port is backend port for L4 load
                     balancers) and executes <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> and advances  the  packet
                     to the next table.

              ‚Ä¢      A  priority-0  flow that simply moves traffic to the next
                     table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>7</u><u>:</u> <u>H</u><u>a</u><u>i</u><u>r</u><u>p</u><u>i</u><u>n</u>

              ‚Ä¢      If logical switch has attached  logical  switch  port  of
                     <u>v</u><u>t</u><u>e</u><u>p</u>  type, then for each distributed gateway router port
                     <u>R</u><u>P</u> attached to this logical switch and has chassis  redi‚Äê
                     rect  port  <u>c</u><u>r</u><u>-</u><u>R</u><u>P</u>, a priority-2000 flow is added with the
                     match .IP
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>4</b><b>]</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><u>c</u><u>r</u><u>-</u><u>R</u><u>P</u><b>)</b>

                     and action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>4</b><b>]</b> register bit is set in the ingress L2 port secu‚Äê
                     rity check table for traffic received from HW VTEP (ramp)
                     ports.

              ‚Ä¢      If logical switch has attached  logical  switch  port  of
                     <u>v</u><u>t</u><u>e</u><u>p</u>  type,  then  a  priority-1000  flow that matches on
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>4</b><b>]</b> register bit for the traffic  received  from  HW
                     VTEP  (ramp) ports. This traffic is passed to ingress ta‚Äê
                     ble ls_in_l2_lkup.

              ‚Ä¢      A priority-1 flow that hairpins traffic matched  by  non-
                     default  flows  in  the Pre-Hairpin table. Hairpinning is
                     done at L2, Ethernet addresses are swapped and the  pack‚Äê
                     ets are looped back on the input port.

              ‚Ä¢      A  priority-0  flow that simply moves traffic to the next
                     table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>t</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>8</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>A</u><u>C</u><u>L</u> <u>e</u><u>v</u><u>a</u><u>l</u><u>u</u><u>a</u><u>t</u><u>i</u><u>o</u><u>n</u> <u>a</u><u>f</u><u>t</u><u>e</u><u>r</u> <u>L</u><u>B</u>

       Logical flows in this table closely reproduce those in the <b>A</b><b>C</b><b>L</b> <b>e</b><b>v</b><b>a</b><b>l</b> ta‚Äê
       ble in the <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database for the  <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b>  direction  with
       the option <b>a</b><b>p</b><b>p</b><b>l</b><b>y</b><b>-</b><b>a</b><b>f</b><b>t</b><b>e</b><b>r</b><b>-</b><b>l</b><b>b</b> set to <b>t</b><b>r</b><b>u</b><b>e</b>. The <b>p</b><b>r</b><b>i</b><b>o</b><b>r</b><b>i</b><b>t</b><b>y</b> values from the <b>A</b><b>C</b><b>L</b>
       table  have  a  limited range and have 1000 added to them to leave room
       for OVN default flows at both higher and lower priorities. The flows in
       this table indicate the ACL verdict by setting <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>]</b> for  <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>t</b><b>y</b><b>p</b><b>e</b>
       ACLs,  <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>7</b><b>]</b>  for  <b>d</b><b>r</b><b>o</b><b>p</b> ACLs, and <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>7</b><b>]</b> for <b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b> ACLs, and then
       advancing the packet to the next table. These will be  reffered  to  as
       the  allow  bit,  drop bit, and reject bit throughout the documentation
       for this table and the next one.

       Like with ACLs that are evaluated before load balancers, if the ACL  is
       configured  with  a tier value, then the current tier counter, supplied
       in reg8[30..31] is matched against the ACL‚Äôs configured tier  in  addi‚Äê
       tion to the ACL‚Äôs match.

              ‚Ä¢      <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b>  apply-after-lb  ACLs  translate into logical flows
                     that set the allow bit. If there are  any  stateful  ACLs
                     (including  both  before-lb  and  after-lb  ACLs) on this
                     datapath, then  <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b>  ACLs  also  run  <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b><b>;</b>  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>
                     (which acts as a hint for an upcoming table to commit the
                     connection  to  conntrack).  In  case the <b>A</b><b>C</b><b>L</b> has a label
                     then <b>r</b><b>e</b><b>g</b><b>3</b> is loaded with the label value and <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>3</b><b>]</b> bit
                     is set to 1 (which acts as a hint for the next tables  to
                     commit the label to conntrack).

              ‚Ä¢      <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>r</b><b>e</b><b>l</b><b>a</b><b>t</b><b>e</b><b>d</b>  apply-after-lb ACLs translate into logical
                     flows that set the allow bit and run the <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b><b>(</b><b>c</b><b>t</b><b>_</b><b>l</b><b>a</b>‚Äê‚Äê
                     <b>b</b><b>e</b><b>l</b><b>=</b><b>0</b><b>/</b><b>1</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> actions for new connections and <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>]</b> <b>=</b>
                     <b>1</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> for existing connections. In case the <b>A</b><b>C</b><b>L</b> has  a
                     label  then  <b>r</b><b>e</b><b>g</b><b>3</b>  is  loaded  with  the  label value and
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>3</b><b>]</b> bit is set to 1 (which acts as a  hint  for  the
                     next tables to commit the label to conntrack).

              ‚Ä¢      <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b>  apply-after-lb ACLs translate into logi‚Äê
                     cal flows that set the allow bit and advance to the  next
                     table.

              ‚Ä¢      <b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b>  apply-after-lb  ACLs translate into logical flows
                     that set the reject bit and advance to the next table.

              ‚Ä¢      <b>p</b><b>a</b><b>s</b><b>s</b> apply-after-lb ACLs  translate  into  logical  flows
                     that  do  not  set the allow, drop, or reject bit and ad‚Äê
                     vance to the next table.

              ‚Ä¢      Other apply-after-lb ACLs set the drop bit for new or un‚Äê
                     tracked  connections  and  <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b><b>(</b><b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b><b>=</b><b>1</b><b>/</b><b>1</b><b>)</b><b>;</b>   for
                     known connections. Setting <b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b> marks a connection as
                     one  that was previously allowed, but should no longer be
                     allowed due to a policy change.

              ‚Ä¢      One priority-65532 flow matching  packets  with  <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>7</b><b>]</b>
                     set  (either  replies to existing sessions or traffic re‚Äê
                     lated to existing sessions) and allows these  by  setting
                     the allow bit and advancing to the next table.

              ‚Ä¢      One priority-0 fallback flow that matches all packets and
                     advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>9</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>A</u><u>C</u><u>L</u> <u>a</u><u>c</u><u>t</u><u>i</u><u>o</u><u>n</u> <u>a</u><u>f</u><u>t</u><u>e</u><u>r</u> <u>L</u><u>B</u>

       Logical  flows  in this table decide how to proceed based on the values
       of the allow, drop, and reject bits that may have been set in the  pre‚Äê
       vious table.

              ‚Ä¢      If  no ACLs are configured, then a priority 0 flow is in‚Äê
                     stalled that matches everything and advances to the  next
                     table.

              ‚Ä¢      A  priority  1000 flow is installed that will advance the
                     packet to the next table if the allow bit is set.

              ‚Ä¢      A priority 1000 flow is installed that will run the <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>
                     action if the drop bit is set.

              ‚Ä¢      A priority 1000 flow  is  installed  that  will  run  the
                     <b>t</b><b>c</b><b>p</b><b>_</b><b>r</b><b>e</b><b>s</b><b>e</b><b>t</b>  <b>{</b>  <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b> <lt;<lt;<b>-</b>>gt;>gt; <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>e</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b><b>t</b><b>a</b>‚Äê‚Äê
                     <b>b</b><b>l</b><b>e</b><b>=</b><b>5</b><b>)</b><b>;</b><b>}</b> action for  TCP  connections,<b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>/</b><b>i</b><b>c</b><b>m</b><b>p</b><b>6</b>  action
                     for  UDP  connections,  and <b>s</b><b>c</b><b>t</b><b>p</b><b>_</b><b>a</b><b>b</b><b>o</b><b>r</b><b>t</b> <b>{</b><b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b> <lt;<lt;<b>-</b><b>%</b><b>g</b><b>t</b><b>;</b> <b>i</b><b>n</b>‚Äê‚Äê
                     <b>p</b><b>o</b><b>r</b><b>t</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>e</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b><b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>=</b><b>5</b><b>)</b><b>;</b><b>}</b> action for SCTP as‚Äê
                     sociations.

              ‚Ä¢      If any ACLs have tiers configured  on  them,  then  three
                     priority  500  flows  are  installed. If the current tier
                     counter is 0, 1, or 2, then the current tier  counter  is
                     incremented  by  one  and  the packet is sent back to the
                     previous table for re-evaluation.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>0</u><u>:</u> <u>S</u><u>t</u><u>a</u><u>t</u><u>e</u><u>f</u><u>u</u><u>l</u>

              ‚Ä¢      A priority 100 flow is added which commits the packet  to
                     the  conntrack  and  sets the most significant 32-bits of
                     <b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b> with the <b>r</b><b>e</b><b>g</b><b>3</b> value based on the  hint  provided
                     by  previous  tables  (with  a  match for <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>]</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp;
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>3</b><b>]</b> <b>=</b><b>=</b> <b>1</b>). This is used by the <b>A</b><b>C</b><b>L</b><b>s</b>  with  label  to
                     commit the label value to conntrack.

              ‚Ä¢      For  <b>A</b><b>C</b><b>L</b><b>s</b>  without label, a second priority-100 flow com‚Äê
                     mits packets to connection tracker using <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>
                     action based on a hint provided by  the  previous  tables
                     (with a match for <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>]</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>1</b><b>3</b><b>]</b> <b>=</b><b>=</b> <b>0</b>).

              ‚Ä¢      A  priority-0  flow that simply moves traffic to the next
                     table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>1</u><u>:</u> <u>A</u><u>R</u><u>P</u><u>/</u><u>N</u><u>D</u> <u>r</u><u>e</u><u>s</u><u>p</u><u>o</u><u>n</u><u>d</u><u>e</u><u>r</u>

       This table implements ARP/ND responder in a logical  switch  for  known
       IPs. The advantage of the ARP responder flow is to limit ARP broadcasts
       by locally responding to ARP requests without the need to send to other
       hypervisors. One common case is when the inport is a logical port asso‚Äê
       ciated with a VIF and the broadcast is responded to on the local hyper‚Äê
       visor  rather  than broadcast across the whole network and responded to
       by the destination VM. This behavior is proxy ARP.

       ARP requests arrive from VMs from a logical switch inport of  type  de‚Äê
       fault.  For  this  case,  the logical switch proxy ARP rules can be for
       other VMs or logical router ports. Logical switch proxy ARP  rules  may
       be  programmed  both  for  mac binding of IP addresses on other logical
       switch VIF ports (which are of the default logical  switch  port  type,
       representing connectivity to VMs or containers), and for mac binding of
       IP  addresses  on  logical switch router type ports, representing their
       logical router port peers. In order to support proxy  ARP  for  logical
       router  ports,  an  IP address must be configured on the logical switch
       router type port, with the same value as the peer logical router  port.
       The configured MAC addresses must match as well. When a VM sends an ARP
       request  for  a  distributed logical router port and if the peer router
       type port of the attached logical switch does not have  an  IP  address
       configured,  the  ARP  request will be broadcast on the logical switch.
       One of the copies of the ARP request will go through the logical switch
       router type port to the logical  router  datapath,  where  the  logical
       router  ARP  responder will generate a reply. The MAC binding of a dis‚Äê
       tributed logical router, once learned by an associated VM, is used  for
       all  that VM‚Äôs communication needing routing. Hence, the action of a VM
       re-arping for the mac binding of the  logical  router  port  should  be
       rare.

       Logical  switch  ARP responder proxy ARP rules can also be hit when re‚Äê
       ceiving ARP requests externally on a L2 gateway port. In this case, the
       hypervisor acting as an L2 gateway, responds to the ARP request on  be‚Äê
       half of a destination VM.

       Note  that  ARP requests received from <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>n</b><b>e</b><b>t</b> logical inports can ei‚Äê
       ther go directly to VMs, in which case the VM responds or  can  hit  an
       ARP  responder  for  a logical router port if the packet is used to re‚Äê
       solve a logical router port next hop address. In either  case,  logical
       switch  ARP  responder rules will not be hit. It contains these logical
       flows:

              ‚Ä¢      If the logical  switch  has  no  router  ports  with  op‚Äê
                     tions:arp_proxy  configured  add  a priority-100 flows to
                     skip the ARP responder if inport is of type <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>n</b><b>e</b><b>t</b>  ad‚Äê
                     vances  directly  to the next table. ARP requests sent to
                     <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>n</b><b>e</b><b>t</b> ports can be received by  multiple  hypervisors.
                     Now, because the same mac binding rules are downloaded to
                     all  hypervisors,  each  of the multiple hypervisors will
                     respond. This will confuse L2 learning on the  source  of
                     the  ARP  requests. ARP requests received on an inport of
                     type <b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> are not expected to hit  any  logical  switch
                     ARP responder flows. However, no skip flows are installed
                     for these packets, as there would be some additional flow
                     cost for this and the value appears limited.

              ‚Ä¢      If  inport <b>V</b> is of type <b>v</b><b>i</b><b>r</b><b>t</b><b>u</b><b>a</b><b>l</b> adds a priority-100 logi‚Äê
                     cal flows for each <u>P</u> configured in  the  <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>v</b><b>i</b><b>r</b><b>t</b><b>u</b><b>a</b><b>l</b><b>-</b>
                     <b>p</b><b>a</b><b>r</b><b>e</b><b>n</b><b>t</b><b>s</b> column with the match

                     <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; &amp;&amp;&amp;&amp; <b>(</b><b>(</b><b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u><b>)</b> <b>|</b><b>|</b> <b>(</b><b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>2</b> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u><b>)</b><b>)</b>
                     <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; &amp;&amp;&amp;&amp; <b>(</b><b>(</b><b>n</b><b>d</b><b>_</b><b>n</b><b>s</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>{</u><u>V</u><u>I</u><u>P</u><u>,</u> <u>N</u><u>S</u><b>_</b><u>M</u><u>U</u><u>L</u><u>T</u><u>I</u><u>C</u><u>A</u><u>S</u><u>T</u><b>_</b><u>A</u><u>D</u><u>D</u><u>R</u><u>}</u> &amp;&amp;&amp;&amp; <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u><b>)</b> <b>|</b><b>|</b> <b>(</b><b>n</b><b>d</b><b>_</b><b>n</b><b>a</b> &amp;&amp;&amp;&amp; <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u><b>)</b><b>)</b>


                     and applies the action

                     <b>b</b><b>i</b><b>n</b><b>d</b><b>_</b><b>v</b><b>p</b><b>o</b><b>r</b><b>t</b><b>(</b><u>V</u><b>,</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>)</b><b>;</b>


                     and advances the packet to the next table.

                     Where  <u>V</u><u>I</u><u>P</u> is the virtual ip configured in the column <b>o</b><b>p</b>‚Äê‚Äê
                     <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>v</b><b>i</b><b>r</b><b>t</b><b>u</b><b>a</b><b>l</b><b>-</b><b>i</b><b>p</b> and NS_MULTICAST_ADDR is  solicited-node
                     multicast address corresponding to the VIP.

              ‚Ä¢      Priority-50  flows  that match ARP requests to each known
                     IP address <u>A</u> of every logical switch  port,  and  respond
                     with ARP replies directly with corresponding Ethernet ad‚Äê
                     dress <u>E</u>:

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b> <b>2</b><b>;</b> <b>/</b><b>*</b> <b>A</b><b>R</b><b>P</b> <b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>.</b> <b>*</b><b>/</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>h</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b> <b>=</b> <u>E</u>;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b> <u>A</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     These  flows  are  omitted  for logical ports (other than
                     router ports or <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> ports) that  are  down  (unless
                     <b>i</b><b>g</b><b>n</b><b>o</b><b>r</b><b>e</b><b>_</b><b>l</b><b>s</b><b>p</b><b>_</b><b>d</b><b>o</b><b>w</b><b>n</b>  is  configured as true in <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> column
                     of <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table of the <b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database), for logi‚Äê
                     cal ports of type <b>v</b><b>i</b><b>r</b><b>t</b><b>u</b><b>a</b><b>l</b>, for logical  ports  with  ‚Äôun‚Äê
                     known‚Äô  address  set  and  for logical ports of a logical
                     switch configured with <b>o</b><b>t</b><b>h</b><b>e</b><b>r</b><b>_</b><b>c</b><b>o</b><b>n</b><b>f</b><b>i</b><b>g</b><b>:</b><b>v</b><b>l</b><b>a</b><b>n</b><b>-</b><b>p</b><b>a</b><b>s</b><b>s</b><b>t</b><b>h</b><b>r</b><b>u</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b>.

                     The above ARP responder flows are added for the  list  of
                     IPv4  addresses if defined in <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>a</b><b>r</b><b>p</b><b>_</b><b>p</b><b>r</b><b>o</b><b>x</b><b>y</b> column of
                     <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b> table for  logical  switch  ports  of
                     type <b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b>.

              ‚Ä¢      Priority-50  flows  that match IPv6 ND neighbor solicita‚Äê
                     tions to each known IP address <u>A</u> (and <u>A</u>‚Äôs solicited  node
                     address)  of  every  logical  switch  port except of type
                     router, and respond with neighbor advertisements directly
                     with corresponding Ethernet address <u>E</u>:

                     <b>n</b><b>d</b><b>_</b><b>n</b><b>a</b> <b>{</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b> <b>=</b> <u>E</u>;
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


                     Priority-50 flows that match IPv6 ND  neighbor  solicita‚Äê
                     tions  to each known IP address <u>A</u> (and <u>A</u>‚Äôs solicited node
                     address) of logical switch port of type router,  and  re‚Äê
                     spond  with  neighbor advertisements directly with corre‚Äê
                     sponding Ethernet address <u>E</u>:

                     <b>n</b><b>d</b><b>_</b><b>n</b><b>a</b><b>_</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> <b>{</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b> <b>=</b> <u>E</u>;
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


                     These flows are omitted for  logical  ports  (other  than
                     router  ports  or  <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> ports) that are down (unless
                     <b>i</b><b>g</b><b>n</b><b>o</b><b>r</b><b>e</b><b>_</b><b>l</b><b>s</b><b>p</b><b>_</b><b>d</b><b>o</b><b>w</b><b>n</b> is configured as true in  <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>  column
                     of <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table of the <b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database), for logi‚Äê
                     cal ports of type <b>v</b><b>i</b><b>r</b><b>t</b><b>u</b><b>a</b><b>l</b> and for logical ports with ‚Äôun‚Äê
                     known‚Äô address set.

                     The  above  NDP responder flows are added for the list of
                     IPv6 addresses if defined in <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>a</b><b>r</b><b>p</b><b>_</b><b>p</b><b>r</b><b>o</b><b>x</b><b>y</b> column  of
                     <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b>  table  for  logical  switch ports of
                     type <b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b>.

              ‚Ä¢      Priority-100 flows with match criteria like the  ARP  and
                     ND  flows above, except that they only match packets from
                     the <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> that owns the IP addresses in  question,  with
                     action  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.  These flows prevent OVN from replying to,
                     for example, an ARP request emitted by a VM for  its  own
                     IP  address.  A VM only makes this kind of request to at‚Äê
                     tempt to detect a duplicate  IP  address  assignment,  so
                     sending a reply will prevent the VM from accepting the IP
                     address that it owns.

                     In  place  of  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>, it would be reasonable to use <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>
                     for the flows‚Äô actions. If everything is working as it is
                     configured, then this would produce  equivalent  results,
                     since no host should reply to the request. But ARPing for
                     one‚Äôs  own  IP  address  is intended to detect situations
                     where the network is not working as configured, so  drop‚Äê
                     ping the request would frustrate that intent.

              ‚Ä¢      For  each  <u>S</u><u>V</u><u>C</u><b>_</b><u>M</u><u>O</u><u>N</u><b>_</b><u>S</u><u>R</u><u>C</u><b>_</b><u>I</u><u>P</u>  defined  in  the  value of the
                     <b>i</b><b>p</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>m</b><b>a</b><b>p</b><b>p</b><b>i</b><b>n</b><b>g</b><b>s</b><b>:</b><b>E</b><b>N</b><b>D</b><b>P</b><b>O</b><b>I</b><b>N</b><b>T</b><b>_</b><b>I</b><b>P</b> column of <b>L</b><b>o</b><b>a</b><b>d</b><b>_</b><b>B</b><b>a</b><b>l</b><b>a</b><b>n</b><b>c</b><b>e</b><b>r</b>  ta‚Äê
                     ble,  priority-110  logical  flow is added with the match
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>S</u><u>V</u><u>C</u><b>_</b><u>M</u><u>O</u><u>N</u><b>_</b><u>S</u><u>R</u><u>C</u><b>_</b><u>I</u><u>P</u> &amp;&amp;&amp;&amp; &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>1</b>  and  applies
                     the action

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b> <b>2</b><b>;</b> <b>/</b><b>*</b> <b>A</b><b>R</b><b>P</b> <b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>.</b> <b>*</b><b>/</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>h</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b> <b>=</b> <u>E</u>;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b> <u>A</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     where  <u>E</u> is the service monitor source mac defined in the
                     <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>s</b><b>v</b><b>c</b><b>_</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b><b>_</b><b>m</b><b>a</b><b>c</b> column in  the  <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b>  table.
                     This mac is used as the source mac in the service monitor
                     packets for the load balancer endpoint IP health checks.

                     <u>S</u><u>V</u><u>C</u><b>_</b><u>M</u><u>O</u><u>N</u><b>_</b><u>S</u><u>R</u><u>C</u><b>_</b><u>I</u><u>P</u>  is  used  as the source ip in the service
                     monitor IPv4 packets for the load  balancer  endpoint  IP
                     health checks.

                     These  flows  are  required if an ARP request is sent for
                     the IP <u>S</u><u>V</u><u>C</u><b>_</b><u>M</u><u>O</u><u>N</u><b>_</b><u>S</u><u>R</u><u>C</u><b>_</b><u>I</u><u>P</u>.

                     For IPv6 the similar flow is added with the following ac‚Äê
                     tion

                     <b>n</b><b>d</b><b>_</b><b>n</b><b>a</b> <b>{</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b> <b>=</b> <u>E</u>;
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


              ‚Ä¢      For each <u>V</u><u>I</u><u>P</u> configured in the table  <b>F</b><b>o</b><b>r</b><b>w</b><b>a</b><b>r</b><b>d</b><b>i</b><b>n</b><b>g</b><b>_</b><b>G</b><b>r</b><b>o</b><b>u</b><b>p</b>  a
                     priority-50  logical flow is added with the match <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b>
                     <b>=</b><b>=</b> <u>v</u><u>i</u><u>p</u> &amp;&amp;&amp;&amp; &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>1</b>
                      and applies the action

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b> <b>2</b><b>;</b> <b>/</b><b>*</b> <b>A</b><b>R</b><b>P</b> <b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>.</b> <b>*</b><b>/</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>h</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b> <b>=</b> <u>E</u>;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b> <u>A</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     where <u>E</u> is the forwarding  group‚Äôs  mac  defined  in  the
                     <b>v</b><b>m</b><b>a</b><b>c</b>.

                     <u>A</u> is used as either the destination ip for load balancing
                     traffic  to child ports or as nexthop to hosts behind the
                     child ports.

                     These flows are required to respond to an ARP request  if
                     an ARP request is sent for the IP <u>v</u><u>i</u><u>p</u>.

              ‚Ä¢      One priority-0 fallback flow that matches all packets and
                     advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>2</u><u>:</u> <u>D</u><u>H</u><u>C</u><u>P</u> <u>o</u><u>p</u><u>t</u><u>i</u><u>o</u><u>n</u> <u>p</u><u>r</u><u>o</u><u>c</u><u>e</u><u>s</u><u>s</u><u>i</u><u>n</u><u>g</u>

       This  table adds the DHCPv4 options to a DHCPv4 packet from the logical
       ports configured with IPv4 address(es) and DHCPv4  options,  and  simi‚Äê
       larly  for  DHCPv6  options. This table also adds flows for the logical
       ports of type <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b>.

              ‚Ä¢      A priority-100 logical flow is added  for  these  logical
                     ports which matches the IPv4 packet with <b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b> = 68 and
                     <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> = 67 and applies the action <b>p</b><b>u</b><b>t</b><b>_</b><b>d</b><b>h</b><b>c</b><b>p</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b> and ad‚Äê
                     vances the packet to the next table.

                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>3</b><b>]</b> <b>=</b> <b>p</b><b>u</b><b>t</b><b>_</b><b>d</b><b>h</b><b>c</b><b>p</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b><b>(</b><b>o</b><b>f</b><b>f</b><b>e</b><b>r</b><b>_</b><b>i</b><b>p</b> <b>=</b> <u>i</u><u>p</u>, <u>o</u><u>p</u><u>t</u><u>i</u><u>o</u><u>n</u><u>s</u>...);
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     For  DHCPDISCOVER  and  DHCPREQUEST,  this transforms the
                     packet into a DHCP reply, adds the DHCP offer IP  <u>i</u><u>p</u>  and
                     options  to  the  packet,  and stores 1 into reg0[3]. For
                     other kinds of packets, it just stores  0  into  reg0[3].
                     Either way, it continues to the next table.

              ‚Ä¢      A  priority-100  logical  flow is added for these logical
                     ports which matches the IPv6 packet with  <b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b>  =  546
                     and  <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> = 547 and applies the action <b>p</b><b>u</b><b>t</b><b>_</b><b>d</b><b>h</b><b>c</b><b>p</b><b>v</b><b>6</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b>
                     and advances the packet to the next table.

                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>3</b><b>]</b> <b>=</b> <b>p</b><b>u</b><b>t</b><b>_</b><b>d</b><b>h</b><b>c</b><b>p</b><b>v</b><b>6</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b><b>(</b><b>i</b><b>a</b><b>_</b><b>a</b><b>d</b><b>d</b><b>r</b> <b>=</b> <u>i</u><u>p</u>, <u>o</u><u>p</u><u>t</u><u>i</u><u>o</u><u>n</u><u>s</u>...);
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     For DHCPv6 Solicit/Request/Confirm packets,  this  trans‚Äê
                     forms  the packet into a DHCPv6 Advertise/Reply, adds the
                     DHCPv6 offer IP <u>i</u><u>p</u> and options to the packet, and  stores
                     1  into  reg0[3].  For  other  kinds  of packets, it just
                     stores 0 into reg0[3]. Either way, it  continues  to  the
                     next table.

              ‚Ä¢      A priority-0 flow that matches all packets to advances to
                     table 16.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>3</u><u>:</u> <u>D</u><u>H</u><u>C</u><u>P</u> <u>r</u><u>e</u><u>s</u><u>p</u><u>o</u><u>n</u><u>s</u><u>e</u><u>s</u>

       This  table implements DHCP responder for the DHCP replies generated by
       the previous table.

              ‚Ä¢      A priority 100 logical flow  is  added  for  the  logical
                     ports  configured  with DHCPv4 options which matches IPv4
                     packets with <b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <b>6</b><b>8</b> &amp;&amp;&amp;&amp; <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <b>6</b><b>7</b> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>3</b><b>]</b> <b>=</b><b>=</b>
                     <b>1</b> and responds back to the <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b>  after  applying  these
                     actions. If <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>3</b><b>]</b> is set to 1, it means that the action
                     <b>p</b><b>u</b><b>t</b><b>_</b><b>d</b><b>h</b><b>c</b><b>p</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b> was successful.

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>S</u>;
                     <b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <b>6</b><b>7</b><b>;</b>
                     <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>6</b><b>8</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>P</u>;
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     where  <u>E</u>  is  the  server MAC address and <u>S</u> is the server
                     IPv4 address defined in the  DHCPv4  options.  Note  that
                     <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> field is handled by <b>p</b><b>u</b><b>t</b><b>_</b><b>d</b><b>h</b><b>c</b><b>p</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b>.

                     (This  terminates  ingress  packet processing; the packet
                     does not go to the next ingress table.)

              ‚Ä¢      A priority 100 logical flow  is  added  for  the  logical
                     ports  configured  with DHCPv6 options which matches IPv6
                     packets with <b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <b>5</b><b>4</b><b>6</b> &amp;&amp;&amp;&amp; <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <b>5</b><b>4</b><b>7</b> &amp;&amp;&amp;&amp;  <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>3</b><b>]</b>
                     <b>=</b><b>=</b> <b>1</b> and responds back to the <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> after applying these
                     actions. If <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>3</b><b>]</b> is set to 1, it means that the action
                     <b>p</b><b>u</b><b>t</b><b>_</b><b>d</b><b>h</b><b>c</b><b>p</b><b>v</b><b>6</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b> was successful.

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>A</u>;
                     <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>S</u>;
                     <b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <b>5</b><b>4</b><b>7</b><b>;</b>
                     <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>5</b><b>4</b><b>6</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>P</u>;
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     where  <u>E</u>  is  the  server MAC address and <u>S</u> is the server
                     IPv6 LLA address generated from the <b>s</b><b>e</b><b>r</b><b>v</b><b>e</b><b>r</b><b>_</b><b>i</b><b>d</b> defined  in
                     the  DHCPv6  options and <u>A</u> is the IPv6 address defined in
                     the logical port‚Äôs addresses column.

                     (This terminates packet processing; the packet  does  not
                     go on the next ingress table.)

              ‚Ä¢      A priority-0 flow that matches all packets to advances to
                     table 17.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>4</u> <u>D</u><u>N</u><u>S</u> <u>L</u><u>o</u><u>o</u><u>k</u><u>u</u><u>p</u>

       This  table  looks  up  and resolves the DNS names to the corresponding
       configured IP address(es).

              ‚Ä¢      A priority-100 logical flow for each logical switch data‚Äê
                     path if it is configured with DNS records, which  matches
                     the  IPv4  and IPv6 packets with <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> = 53 and applies
                     the action <b>d</b><b>n</b><b>s</b><b>_</b><b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b> and advances the packet to the next
                     table.

                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>4</b><b>]</b> <b>=</b> <b>d</b><b>n</b><b>s</b><b>_</b><b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>(</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     For valid DNS packets, this transforms the packet into  a
                     DNS  reply  if the DNS name can be resolved, and stores 1
                     into reg0[4]. For failed DNS resolution or other kinds of
                     packets, it just stores 0 into reg0[4].  Either  way,  it
                     continues to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>5</u> <u>D</u><u>N</u><u>S</u> <u>R</u><u>e</u><u>s</u><u>p</u><u>o</u><u>n</u><u>s</u><u>e</u><u>s</u>

       This  table  implements  DNS responder for the DNS replies generated by
       the previous table.

              ‚Ä¢      A priority-100 logical flow for each logical switch data‚Äê
                     path if it is configured with DNS records, which  matches
                     the IPv4 and IPv6 packets with <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>5</b><b>3</b> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>4</b><b>]</b> <b>=</b><b>=</b>
                     <b>1</b>  and  responds  back to the <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> after applying these
                     actions. If <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>4</b><b>]</b> is set to 1, it means that the action
                     <b>d</b><b>n</b><b>s</b><b>_</b><b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b> was successful.

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <lt;<lt;<b>-</b>>gt;>gt; <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <lt;<lt;<b>-</b>>gt;>gt; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b><b>;</b>
                     <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <b>5</b><b>3</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>P</u>;
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     (This terminates ingress packet  processing;  the  packet
                     does not go to the next ingress table.)

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>t</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>6</u> <u>E</u><u>x</u><u>t</u><u>e</u><u>r</u><u>n</u><u>a</u><u>l</u> <u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>

       Traffic  from  the  <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b>  logical  ports enter the ingress datapath
       pipeline via the <b>l</b><b>o</b><b>c</b><b>a</b><b>l</b><b>n</b><b>e</b><b>t</b> port. This table adds the below logical flows
       to handle the traffic from these ports.

              ‚Ä¢      A priority-100 flow is added for  each  <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b>  logical
                     port  which  doesn‚Äôt  reside  on  a  chassis  to drop the
                     ARP/IPv6 NS request to the router IP(s) (of  the  logical
                     switch) which matches on the <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> of the <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b> logi‚Äê
                     cal  port and the valid <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> address(es) of the <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b>‚Äê‚Äê
                     <b>n</b><b>a</b><b>l</b> logical port.

                     This flow guarantees  that  the  ARP/NS  request  to  the
                     router IP address from the external ports is responded by
                     only  the chassis which has claimed these external ports.
                     All the other chassis, drops these packets.

                     A priority-100 flow is added for  each  <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b>  logical
                     port which doesn‚Äôt reside on a chassis to drop any packet
                     destined to the router mac - with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>e</u><u>x</u><u>‚</u>Äê
                     <u>t</u><u>e</u><u>r</u><u>n</u><u>a</u><u>l</u>  &amp;&amp;&amp;&amp;  <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b>  <b>=</b><b>=</b>  <u>E</u>  &amp;&amp;&amp;&amp;  <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>R</u> &amp;&amp;&amp;&amp; <b>!</b><b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b>‚Äê‚Äê
                     <b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><b>"</b><u>e</u><u>x</u><u>t</u><u>e</u><u>r</u><u>n</u><u>a</u><u>l</u><b>"</b><b>)</b> where <u>E</u> is the external port mac
                     and <u>R</u> is the router port mac.

              ‚Ä¢      A priority-0 flow that matches all packets to advances to
                     table 20.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>7</u> <u>D</u><u>e</u><u>s</u><u>t</u><u>i</u><u>n</u><u>a</u><u>t</u><u>i</u><u>o</u><u>n</u> <u>L</u><u>o</u><u>o</u><u>k</u><u>u</u><u>p</u>

       This table implements switching behavior.  It  contains  these  logical
       flows:

              ‚Ä¢      A  priority-110  flow with the match <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>E</u> for all
                     logical switch datapaths  and  applies  the  action  <b>h</b><b>a</b><b>n</b>‚Äê‚Äê
                     <b>d</b><b>l</b><b>e</b><b>_</b><b>s</b><b>v</b><b>c</b><b>_</b><b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>)</b>. Where <u>E</u> is the service monitor mac
                     defined   in   the   <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>s</b><b>v</b><b>c</b><b>_</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b><b>_</b><b>m</b><b>a</b><b>c</b>   column  of
                     <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table.

              ‚Ä¢      A priority-100 flow that punts all  IGMP/MLD  packets  to
                     <b>o</b><b>v</b><b>n</b><b>-</b><b>c</b><b>o</b><b>n</b><b>t</b><b>r</b><b>o</b><b>l</b><b>l</b><b>e</b><b>r</b>  if  multicast  snooping is enabled on the
                     logical switch.

              ‚Ä¢      Priority-90 flows for transit switches that forward  reg‚Äê
                     istered  IP multicast traffic to their corresponding mul‚Äê
                     ticast group , which <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> creates based  on  learnt
                     <b>I</b><b>G</b><b>M</b><b>P</b><b>_</b><b>G</b><b>r</b><b>o</b><b>u</b><b>p</b> entries.

              ‚Ä¢      Priority-90  flows  for non-transit switches that forward
                     registered IP multicast traffic  to  their  corresponding
                     multicast group, which <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> creates based on learnt
                     <b>I</b><b>G</b><b>M</b><b>P</b><b>_</b><b>G</b><b>r</b><b>o</b><b>u</b><b>p</b> entries. The flows also forward packets to the
                     <b>M</b><b>C</b><b>_</b><b>M</b><b>R</b><b>O</b><b>U</b><b>T</b><b>E</b><b>R</b><b>_</b><b>F</b><b>L</b><b>O</b><b>O</b><b>D</b>  multicast group, which <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>d</b><b>h</b> popu‚Äê
                     lates with all the logical ports that  are  connected  to
                     logical routers with <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>:mcast_relay=‚Äôtrue‚Äô.

              ‚Ä¢      A priority-85 flow that forwards all IP multicast traffic
                     destined to 224.0.0.X to the <b>M</b><b>C</b><b>_</b><b>F</b><b>L</b><b>O</b><b>O</b><b>D</b><b>_</b><b>L</b><b>2</b> multicast group,
                     which  <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>  populates  with all non-router logical
                     ports.

              ‚Ä¢      A priority-85 flow that forwards all IP multicast traffic
                     destined to reserved multicast IPv6 addresses (RFC  4291,
                     2.7.1,  e.g.,  Solicited-Node  multicast) to the <b>M</b><b>C</b><b>_</b><b>F</b><b>L</b><b>O</b><b>O</b><b>D</b>
                     multicast group, which <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> populates with all  en‚Äê
                     abled logical ports.

              ‚Ä¢      A priority-80 flow that forwards all unregistered IP mul‚Äê
                     ticast  traffic  to  the <b>M</b><b>C</b><b>_</b><b>S</b><b>T</b><b>A</b><b>T</b><b>I</b><b>C</b> multicast group, which
                     <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> populates with all the logical ports that have
                     <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>f</b><b>l</b><b>o</b><b>o</b><b>d</b><b>=</b>‚Äô‚Äô<b>t</b><b>r</b><b>u</b><b>e</b>‚Äô‚Äô. The flow also  forwards  un‚Äê
                     registered  IP  multicast traffic to the <b>M</b><b>C</b><b>_</b><b>M</b><b>R</b><b>O</b><b>U</b><b>T</b><b>E</b><b>R</b><b>_</b><b>F</b><b>L</b><b>O</b><b>O</b><b>D</b>
                     multicast group, which <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> populates with all  the
                     logical  ports connected to logical routers that have <b>o</b><b>p</b>‚Äê‚Äê
                     <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>r</b><b>e</b><b>l</b><b>a</b><b>y</b><b>=</b>‚Äô‚Äô<b>t</b><b>r</b><b>u</b><b>e</b>‚Äô‚Äô.

              ‚Ä¢      A priority-80 flow that drops all unregistered IP  multi‚Äê
                     cast  traffic  if  <b>o</b><b>t</b><b>h</b><b>e</b><b>r</b><b>_</b><b>c</b><b>o</b><b>n</b><b>f</b><b>i</b><b>g</b>  <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>s</b><b>n</b><b>o</b><b>o</b><b>p</b><b>=</b>‚Äô‚Äô<b>t</b><b>r</b><b>u</b><b>e</b>‚Äô‚Äô  and
                     <b>o</b><b>t</b><b>h</b><b>e</b><b>r</b><b>_</b><b>c</b><b>o</b><b>n</b><b>f</b><b>i</b><b>g</b>  <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>f</b><b>l</b><b>o</b><b>o</b><b>d</b><b>_</b><b>u</b><b>n</b><b>r</b><b>e</b><b>g</b><b>i</b><b>s</b><b>t</b><b>e</b><b>r</b><b>e</b><b>d</b><b>=</b>‚Äô‚Äô<b>f</b><b>a</b><b>l</b><b>s</b><b>e</b>‚Äô‚Äô  and  the
                     switch  is not connected to a logical router that has <b>o</b><b>p</b>‚Äê‚Äê
                     <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>r</b><b>e</b><b>l</b><b>a</b><b>y</b><b>=</b>‚Äô‚Äô<b>t</b><b>r</b><b>u</b><b>e</b>‚Äô‚Äô and the switch doesn‚Äôt have any
                     logical port with <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>f</b><b>l</b><b>o</b><b>o</b><b>d</b><b>=</b>‚Äô‚Äô<b>t</b><b>r</b><b>u</b><b>e</b>‚Äô‚Äô.

              ‚Ä¢      Priority-80 flows for  each  IP  address/VIP/NAT  address
                     owned  by  a  router  port connected to the switch. These
                     flows match ARP requests and ND packets for the  specific
                     IP  addresses.  Matched packets are forwarded only to the
                     router that owns the IP address and  to  the  <b>M</b><b>C</b><b>_</b><b>F</b><b>L</b><b>O</b><b>O</b><b>D</b><b>_</b><b>L</b><b>2</b>
                     multicast  group  which  contains  all non-router logical
                     ports.

              ‚Ä¢      Priority-75 flows for each port connected  to  a  logical
                     router  matching  self  originated  ARP  request/RARP re‚Äê
                     quest/ND  packets.  These  packets  are  flooded  to  the
                     <b>M</b><b>C</b><b>_</b><b>F</b><b>L</b><b>O</b><b>O</b><b>D</b><b>_</b><b>L</b><b>2</b> which contains all non-router logical ports.

              ‚Ä¢      A  priority-72  flow that outputs all ARP requests and ND
                     packets with an Ethernet broadcast or  multicast  <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b>
                     to the <b>M</b><b>C</b><b>_</b><b>F</b><b>L</b><b>O</b><b>O</b><b>D</b><b>_</b><b>L</b><b>2</b> multicast group if <b>o</b><b>t</b><b>h</b><b>e</b><b>r</b><b>_</b><b>c</b><b>o</b><b>n</b><b>f</b><b>i</b><b>g</b><b>:</b><b>b</b><b>r</b><b>o</b><b>a</b><b>d</b>‚Äê‚Äê
                     <b>c</b><b>a</b><b>s</b><b>t</b><b>-</b><b>a</b><b>r</b><b>p</b><b>s</b><b>-</b><b>t</b><b>o</b><b>-</b><b>a</b><b>l</b><b>l</b><b>-</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b>.

              ‚Ä¢      A  priority-70 flow that outputs all packets with an Eth‚Äê
                     ernet broadcast or multicast <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> to the <b>M</b><b>C</b><b>_</b><b>F</b><b>L</b><b>O</b><b>O</b><b>D</b> mul‚Äê
                     ticast group.

              ‚Ä¢      One priority-50 flow that matches each known Ethernet ad‚Äê
                     dress against <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b>. Action of this  flow  outputs  the
                     packet  to the single associated output port if it is en‚Äê
                     abled. <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b> action is applied if LSP is disabled.

                     For the Ethernet address on a logical switch port of type
                     <b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b>, when that logical switch port‚Äôs <b>a</b><b>d</b><b>d</b><b>r</b><b>e</b><b>s</b><b>s</b><b>e</b><b>s</b>  column
                     is  set  to  <b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> and the connected logical router port
                     has a gateway chassis:

                     ‚Ä¢      The flow for the connected logical  router  port‚Äôs
                            Ethernet address is only programmed on the gateway
                            chassis.

                     ‚Ä¢      If  the  logical router has rules specified in <b>n</b><b>a</b><b>t</b>
                            with <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b><b>_</b><b>m</b><b>a</b><b>c</b>, then those addresses  are  also
                            used  to  populate the switch‚Äôs destination lookup
                            on the chassis where <b>l</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b> is resident.

                     For the Ethernet address on a logical switch port of type
                     <b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b>, when that logical switch port‚Äôs <b>a</b><b>d</b><b>d</b><b>r</b><b>e</b><b>s</b><b>s</b><b>e</b><b>s</b>  column
                     is  set  to  <b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> and the connected logical router port
                     specifies a <b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>-</b><b>o</b><b>n</b><b>-</b><b>r</b><b>e</b><b>d</b><b>i</b><b>r</b><b>e</b><b>c</b><b>t</b><b>-</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b>  and  the  logical
                     router to which the connected logical router port belongs
                     to has a distributed gateway LRP:

                     ‚Ä¢      The  flow  for the connected logical router port‚Äôs
                            Ethernet address is only programmed on the gateway
                            chassis.

                     For each  forwarding  group  configured  on  the  logical
                     switch  datapath,  a  priority-50  flow  that  matches on
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u>
                      with an action  of  <b>f</b><b>w</b><b>d</b><b>_</b><b>g</b><b>r</b><b>o</b><b>u</b><b>p</b><b>(</b><b>c</b><b>h</b><b>i</b><b>l</b><b>d</b><b>p</b><b>o</b><b>r</b><b>t</b><b>s</b><b>=</b><u>a</u><u>r</u><u>g</u><u>s</u>  <b>)</b>,  where
                     <u>a</u><u>r</u><u>g</u><u>s</u>  contains comma separated logical switch child ports
                     to load balance to. If <b>l</b><b>i</b><b>v</b><b>e</b><b>n</b><b>e</b><b>s</b><b>s</b> is enabled,  then  action
                     also includes  <b>l</b><b>i</b><b>v</b><b>e</b><b>n</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b>.

              ‚Ä¢      One  priority-0  fallback  flow  that matches all packets
                     with the action <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b>  <b>g</b><b>e</b><b>t</b><b>_</b><b>f</b><b>d</b><b>b</b><b>(</b><b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b><b>)</b><b>;</b>  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.  The
                     action  <b>g</b><b>e</b><b>t</b><b>_</b><b>f</b><b>d</b><b>b</b>  gets the port for the <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> in the MAC
                     learning table of the logical switch datapath.  If  there
                     is  no  entry for <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> in the MAC learning table, then
                     it stores <b>n</b><b>o</b><b>n</b><b>e</b> in the <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>8</u> <u>D</u><u>e</u><u>s</u><u>t</u><u>i</u><u>n</u><u>a</u><u>t</u><u>i</u><u>o</u><u>n</u> <u>u</u><u>n</u><u>k</u><u>n</u><u>o</u><u>w</u><u>n</u>

       This table handles the packets whose destination was not found  or  and
       looked  up in the MAC learning table of the logical switch datapath. It
       contains the following flows.

              ‚Ä¢      Priority 50 flow with the match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> is added for
                     each disabled Logical Switch Port <b>P</b>. This flow has action
                     <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>.

              ‚Ä¢      If the logical switch has logical  ports  with  ‚Äôunknown‚Äô
                     addresses set, then the below logical flow is added

                     ‚Ä¢      Priority  50 flow with the match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <b>"</b><b>n</b><b>o</b><b>n</b><b>e</b><b>"</b>
                            then outputs  them  to  the  <b>M</b><b>C</b><b>_</b><b>U</b><b>N</b><b>K</b><b>N</b><b>O</b><b>W</b><b>N</b>  multicast
                            group, which <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> populates with all enabled
                            logical  ports  that  accept  unknown  destination
                            packets. As a small optimization,  if  no  logical
                            ports    accept   unknown   destination   packets,
                            <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> omits this multicast group and  logical
                            flow.

                     If the logical switch has no logical ports with ‚Äôunknown‚Äô
                     address set, then the below logical flow is added

                     ‚Ä¢      Priority  50  flow  with the match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <b>n</b><b>o</b><b>n</b><b>e</b>
                            and drops the packets.

              ‚Ä¢      One priority-0 fallback flow that outputs the  packet  to
                     the egress stage with the outport learnt from <b>g</b><b>e</b><b>t</b><b>_</b><b>f</b><b>d</b><b>b</b> ac‚Äê
                     tion.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>0</u><u>:</u> <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>P</u><u>r</u><u>e</u><u>-</u><u>A</u><u>C</u><u>L</u><u>s</u>

       This is similar to ingress table <b>P</b><b>r</b><b>e</b><b>-</b><b>A</b><b>C</b><b>L</b><b>s</b> except for <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> traffic.

       This table also has a priority-110 flow with the match <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>E</u> for
       all logical switch datapaths to move traffic to the next table. Where <u>E</u>
       is  the service monitor mac defined in the <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>s</b><b>v</b><b>c</b><b>_</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b><b>_</b><b>m</b><b>a</b><b>c</b> col‚Äê
       umn of <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table.

       This table also has a priority-110 flow with the match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>I</u> for
       all logical switch datapaths to move traffic to the next table. Where <u>I</u>
       is the peer of a logical router port. This flow is added  to  skip  the
       connection  tracking  of  packets which will be entering logical router
       datapath from logical switch datapath for routing.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>:</u> <u>P</u><u>r</u><u>e</u><u>-</u><u>L</u><u>B</u>

       This table is similar to ingress table <b>P</b><b>r</b><b>e</b><b>-</b><b>L</b><b>B</b>. It contains a priority-0
       flow that simply moves traffic to the next table. Moreover it  contains
       two  priority-110  flows to move multicast, IPv6 Neighbor Discovery and
       MLD traffic to the next table. If any load balancing  rules  exist  for
       the  datapath,  a priority-100 flow is added with a match of <b>i</b><b>p</b> and ac‚Äê
       tion of <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>1</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> to act as a hint for table  <b>P</b><b>r</b><b>e</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>f</b><b>u</b><b>l</b>  to
       send  IP  packets to the connection tracker for packet de-fragmentation
       and possibly DNAT the destination VIP to one of  the  selected  backend
       for already committed load balanced traffic.

       This table also has a priority-110 flow with the match <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>E</u> for
       all logical switch datapaths to move traffic to the next table. Where <u>E</u>
       is  the service monitor mac defined in the <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>s</b><b>v</b><b>c</b><b>_</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b><b>_</b><b>m</b><b>a</b><b>c</b> col‚Äê
       umn of <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b> table.

       This table also has a priority-110 flow with the match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>I</u> for
       all logical switch datapaths to move traffic to the next table, and, if
       there are no stateful_acl, clear the ct_state. Where <u>I</u> is the peer of a
       logical router port. This flow is added to skip the connection tracking
       of packets which will be entering logical router datapath from  logical
       switch datapath for routing.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>:</u> <u>P</u><u>r</u><u>e</u><u>-</u><u>s</u><u>t</u><u>a</u><u>t</u><u>e</u><u>f</u><u>u</u><u>l</u>

       This  is similar to ingress table <b>P</b><b>r</b><b>e</b><b>-</b><b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>f</b><b>u</b><b>l</b>. This table adds the be‚Äê
       low 3 logical flows.

              ‚Ä¢      A Priority-120 flow that send the packets  to  connection
                     tracker  using  <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>;</b> as the action so that the al‚Äê
                     ready established traffic gets unDNATted from the backend
                     IP to the load balancer VIP based on a hint  provided  by
                     the previous tables with a match for <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>2</b><b>]</b> <b>=</b><b>=</b> <b>1</b>. If the
                     packet was not DNATted earlier, then <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b> functions
                     like <b>c</b><b>t</b><b>_</b><b>n</b><b>e</b><b>x</b><b>t</b>.

              ‚Ä¢      A  priority-100  flow  sends  the  packets  to connection
                     tracker based on a hint provided by the  previous  tables
                     (with a match for <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>]</b> <b>=</b><b>=</b> <b>1</b>) by using the <b>c</b><b>t</b><b>_</b><b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> ac‚Äê
                     tion.

              ‚Ä¢      A  priority-0 flow that matches all packets to advance to
                     the next table.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>3</u><u>:</u> <b>f</b><b>r</b><b>o</b><b>m</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>A</u><u>C</u><u>L</u> <u>h</u><u>i</u><u>n</u><u>t</u><u>s</u>

       This is similar to ingress table <b>A</b><b>C</b><b>L</b> <b>h</b><b>i</b><b>n</b><b>t</b><b>s</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>4</u><u>:</u> <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>A</u><u>C</u><u>L</u> <u>e</u><u>v</u><u>a</u><u>l</u><u>u</u><u>a</u><u>t</u><u>i</u><u>o</u><u>n</u>

       This is similar to ingress table <b>A</b><b>C</b><b>L</b> <b>e</b><b>v</b><b>a</b><b>l</b> except for <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> ACLs.  As
       a  reminder,  these  flows  use the following register bits to indicate
       their verdicts. <b>A</b><b>l</b><b>l</b><b>o</b><b>w</b><b>-</b><b>t</b><b>y</b><b>p</b><b>e</b> ACLs set <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>]</b>, <b>d</b><b>r</b><b>o</b><b>p</b> ACLs  set  <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>7</b><b>]</b>,
       and <b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b> ACLs set <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>8</b><b>]</b>.

       Also like with ingress ACLs, egress ACLs can have a configured <b>t</b><b>i</b><b>e</b><b>r</b>. If
       a  tier  is  configured,  then  the  current  tier counter is evaluated
       against the ACL‚Äôs configured tier in addition to the ACL‚Äôs  match.  The
       current tier counter is stored in <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>3</b><b>0</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b>.

       Similar  to ingress table, a priority-65532 flow is added to allow IPv6
       Neighbor solicitation, Neighbor discover, Router  solicitation,  Router
       advertisement and MLD packets regardless of other ACLs defined.

       In addition, the following flows are added.

              ‚Ä¢      A  priority  34000 logical flow is added for each logical
                     port which has DHCPv4 options defined to allow the DHCPv4
                     reply packet and which has DHCPv6 options defined to  al‚Äê
                     low  the  DHCPv6  reply packet from the <b>I</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b> <b>T</b><b>a</b><b>b</b><b>l</b><b>e</b> <b>1</b><b>8</b><b>:</b>
                     <b>D</b><b>H</b><b>C</b><b>P</b> <b>r</b><b>e</b><b>s</b><b>p</b><b>o</b><b>n</b><b>s</b><b>e</b><b>s</b>. This is indicated by  setting  the  allow
                     bit.

              ‚Ä¢      A  priority  34000 logical flow is added for each logical
                     switch datapath configured  with  DNS  records  with  the
                     match <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>5</b><b>3</b> to allow the DNS reply packet from the
                     <b>I</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b>  <b>T</b><b>a</b><b>b</b><b>l</b><b>e</b>  <b>2</b><b>0</b><b>:</b>  <b>D</b><b>N</b><b>S</b>  <b>r</b><b>e</b><b>s</b><b>p</b><b>o</b><b>n</b><b>s</b><b>e</b><b>s</b>. This is indicated by
                     setting the allow bit.

              ‚Ä¢      A priority 34000 logical flow is added for  each  logical
                     switch  datapath  with the match <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u> to allow the
                     service monitor  request  packet  generated  by  <b>o</b><b>v</b><b>n</b><b>-</b><b>c</b><b>o</b><b>n</b>‚Äê‚Äê
                     <b>t</b><b>r</b><b>o</b><b>l</b><b>l</b><b>e</b><b>r</b> with the action <b>n</b><b>e</b><b>x</b><b>t</b>, where <u>E</u> is the service mon‚Äê
                     itor mac defined in the <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>s</b><b>v</b><b>c</b><b>_</b><b>m</b><b>o</b><b>n</b><b>i</b><b>t</b><b>o</b><b>r</b><b>_</b><b>m</b><b>a</b><b>c</b> column of
                     <b>N</b><b>B</b><b>_</b><b>G</b><b>l</b><b>o</b><b>b</b><b>a</b><b>l</b>  table.  This is indicated by setting the allow
                     bit.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>5</u><u>:</u> <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>A</u><u>C</u><u>L</u> <u>a</u><u>c</u><u>t</u><u>i</u><u>o</u><u>n</u>

       This is similar to ingress table <b>A</b><b>C</b><b>L</b> <b>a</b><b>c</b><b>t</b><b>i</b><b>o</b><b>n</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>6</u><u>:</u> <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>Q</u><u>o</u><u>S</u> <u>M</u><u>a</u><u>r</u><u>k</u><u>i</u><u>n</u><u>g</u>

       This is similar to ingress table  <b>Q</b><b>o</b><b>S</b>  <b>m</b><b>a</b><b>r</b><b>k</b><b>i</b><b>n</b><b>g</b>  except  they  apply  to
       <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> QoS rules.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>7</u><u>:</u> <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> <u>Q</u><u>o</u><u>S</u> <u>M</u><u>e</u><u>t</u><u>e</u><u>r</u>

       This  is  similar  to  ingress  table  <b>Q</b><b>o</b><b>S</b>  <b>m</b><b>e</b><b>t</b><b>e</b><b>r</b>  except they apply to
       <b>t</b><b>o</b><b>-</b><b>l</b><b>p</b><b>o</b><b>r</b><b>t</b> QoS rules.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>8</u><u>:</u> <u>S</u><u>t</u><u>a</u><u>t</u><u>e</u><u>f</u><u>u</u><u>l</u>

       This is similar to ingress table <b>S</b><b>t</b><b>a</b><b>t</b><b>e</b><b>f</b><b>u</b><b>l</b>  except  that  there  are  no
       rules added for load balancing new connections.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>9</u><u>:</u> <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>P</u><u>o</u><u>r</u><u>t</u> <u>S</u><u>e</u><u>c</u><u>u</u><u>r</u><u>i</u><u>t</u><u>y</u> <u>-</u> <u>c</u><u>h</u><u>e</u><u>c</u><u>k</u>

       This  is similar to the port security logic in table <b>I</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b> <b>P</b><b>o</b><b>r</b><b>t</b> <b>S</b><b>e</b><b>c</b><b>u</b>‚Äê‚Äê
       <b>r</b><b>i</b><b>t</b><b>y</b> <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b> except that action <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>o</b><b>u</b><b>t</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>s</b><b>e</b><b>c</b> is used to  check  the
       port security rules. This table adds the below logical flows.

              ‚Ä¢      A  priority 100 flow which matches on the multicast traf‚Äê
                     fic and applies the  action  <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b><b>"</b>  <b>=</b>  <b>0</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b><b>"</b> to skip the out port security checks.

              ‚Ä¢      A  priority  0 logical flow is added which matches on all
                     the packets and applies the action  <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b><b>"</b>
                     <b>=</b>     <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>o</b><b>u</b><b>t</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>s</b><b>e</b><b>c</b><b>(</b><b>)</b><b>;</b>     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b><b>"</b>.     The    action
                     <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>o</b><b>u</b><b>t</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>s</b><b>e</b><b>c</b> applies the port security rules  based
                     on  the  addresses defined in the <b>p</b><b>o</b><b>r</b><b>t</b><b>_</b><b>s</b><b>e</b><b>c</b><b>u</b><b>r</b><b>i</b><b>t</b><b>y</b> column of
                     <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b> table before delivering the packet to
                     the <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>0</u><u>:</u> <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>P</u><u>o</u><u>r</u><u>t</u> <u>S</u><u>e</u><u>c</u><u>u</u><u>r</u><u>i</u><u>t</u><u>y</u> <u>-</u> <u>A</u><u>p</u><u>p</u><u>l</u><u>y</u>

       This is similar to the ingress port security logic in ingress  table  <b>A</b>
       <b>I</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b> <b>P</b><b>o</b><b>r</b><b>t</b> <b>S</b><b>e</b><b>c</b><b>u</b><b>r</b><b>i</b><b>t</b><b>y</b> <b>-</b> <b>A</b><b>p</b><b>p</b><b>l</b><b>y</b>. This table drops the packets if the port
       security  check  failed in the previous stage i.e the register bit <b>R</b><b>E</b><b>G</b>‚Äê‚Äê
       <b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b> is set to 1.

       The following flows are added.

              ‚Ä¢      For each port configured  with  egress  qos  in  the  <b>o</b><b>p</b>‚Äê‚Äê
                     <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>q</b><b>d</b><b>i</b><b>s</b><b>c</b><b>_</b><b>q</b><b>u</b><b>e</b><b>u</b><b>e</b><b>_</b><b>i</b><b>d</b>  column of <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b>, run‚Äê
                     ning a localnet port on the same logical switch, a prior‚Äê
                     ity 110 flow is added which matches on the localnet  <b>o</b><b>u</b><b>t</b>‚Äê‚Äê
                     <b>p</b><b>o</b><b>r</b><b>t</b>  and  on  the  port  <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b>  and  applies the action
                     <b>s</b><b>e</b><b>t</b><b>_</b><b>q</b><b>u</b><b>e</b><b>u</b><b>e</b><b>(</b><b>i</b><b>d</b><b>)</b><b>;</b> <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b><b>"</b>.

              ‚Ä¢      For each localnet port configured with egress qos in  the
                     <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>q</b><b>d</b><b>i</b><b>s</b><b>c</b><b>_</b><b>q</b><b>u</b><b>e</b><b>u</b><b>e</b><b>_</b><b>i</b><b>d</b>  column  of <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b>, a
                     priority 100 flow is added which matches on the  localnet
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> and applies the action <b>s</b><b>e</b><b>t</b><b>_</b><b>q</b><b>u</b><b>e</b><b>u</b><b>e</b><b>(</b><b>i</b><b>d</b><b>)</b><b>;</b> <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b><b>"</b>.

                     Please remember to mark the corresponding physical inter‚Äê
                     face with <b>o</b><b>v</b><b>n</b><b>-</b><b>e</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>-</b><b>i</b><b>f</b><b>a</b><b>c</b><b>e</b> set to true in <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b><b>_</b><b>i</b><b>d</b><b>s</b>.

              ‚Ä¢      A  priority-50 flow that drops the packet if the register
                     bit <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>_</b><b>S</b><b>E</b><b>C</b><b>_</b><b>D</b><b>R</b><b>O</b><b>P</b> is set to 1.

              ‚Ä¢      A priority-0 flow that outputs the packet to the <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>.

   <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b> <b>R</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> <b>D</b><b>a</b><b>t</b><b>a</b><b>p</b><b>a</b><b>t</b><b>h</b><b>s</b>
       Logical router datapaths will only exist for <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>R</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> rows in the
       <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database that do not have <b>e</b><b>n</b><b>a</b><b>b</b><b>l</b><b>e</b><b>d</b> set to <b>f</b><b>a</b><b>l</b><b>s</b><b>e</b>

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>0</u><u>:</u> <u>L</u><u>2</u> <u>A</u><u>d</u><u>m</u><u>i</u><u>s</u><u>s</u><u>i</u><u>o</u><u>n</u> <u>C</u><u>o</u><u>n</u><u>t</u><u>r</u><u>o</u><u>l</u>

       This table drops packets that the router shouldn‚Äôt see at all based  on
       their Ethernet headers. It contains the following flows:

              ‚Ä¢      Priority-100 flows to drop packets with VLAN tags or mul‚Äê
                     ticast Ethernet source addresses.

              ‚Ä¢      For each enabled router port <u>P</u> with Ethernet address <u>E</u>, a
                     priority-50  flow  that matches <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>(</b><b>e</b><b>t</b><b>h</b><b>.</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b>
                     <b>|</b><b>|</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>E</u>), stores the router port ethernet address
                     and advances to next table, with  action  <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>=</b><b>E</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     For  the  gateway  port  on  a distributed logical router
                     (where one of the logical router ports specifies a  gate‚Äê
                     way  chassis),  the  above  flow matching <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>E</u> is
                     only programmed on the gateway port instance on the gate‚Äê
                     way chassis. If LRP‚Äôs logical switch has attached LSP  of
                     <b>v</b><b>t</b><b>e</b><b>p</b> type, the <b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><b>)</b> part is not added to
                     lflow  to allow traffic originated from logical switch to
                     reach LR services (LBs, NAT).

                     For a distributed logical router or  for  gateway  router
                     where the port is configured with <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b> the
                     action   of   the   above   flow   is   modified   adding
                     <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>p</b><b>k</b><b>t</b><b>_</b><b>l</b><b>a</b><b>r</b><b>g</b><b>e</b><b>r</b> in order to mark the packet setting <b>R</b><b>E</b><b>G</b>‚Äê‚Äê
                     <b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> if the size is greater than  the  MTU.  If
                     the  port is also configured with <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b><b>_</b><b>b</b><b>y</b>‚Äê‚Äê
                     <b>p</b><b>a</b><b>s</b><b>s</b> then another flow is added, with priority-55, to by‚Äê
                     pass the <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>p</b><b>k</b><b>t</b><b>_</b><b>l</b><b>a</b><b>r</b><b>g</b><b>e</b><b>r</b> flow. This is useful for  traf‚Äê
                     fic  that  normally doesn‚Äôt need to be fragmented and for
                     which check_pkt_larger, which might not  be  offloadable,
                     is not really needed. One such example is TCP traffic.

              ‚Ä¢      For  each  <b>d</b><b>n</b><b>a</b><b>t</b><b>_</b><b>a</b><b>n</b><b>d</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> NAT rule on a distributed router
                     that specifies an external Ethernet address <u>E</u>,  a  prior‚Äê
                     ity-50  flow  that  matches <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u> &amp;&amp;&amp;&amp; <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>E</u>,
                     where <u>G</u><u>W</u> is the logical router distributed  gateway  port
                     corresponding  to  the  NAT rule (specified or inferred),
                     with action <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>=</b><b>E</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     This flow is only programmed on the gateway port instance
                     on the chassis where the <b>l</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b>  specified  in  the
                     NAT rule resides.

              ‚Ä¢      A  priority-0  logical  flow that matches all packets not
                     already handled (match <b>1</b>) and drops them (action <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>).

       Other packets are implicitly dropped.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>:</u> <u>N</u><u>e</u><u>i</u><u>g</u><u>h</u><u>b</u><u>o</u><u>r</u> <u>l</u><u>o</u><u>o</u><u>k</u><u>u</u><u>p</u>

       For ARP and IPv6 Neighbor Discovery packets, this table looks into  the
       <b>M</b><b>A</b><b>C</b><b>_</b><b>B</b><b>i</b><b>n</b><b>d</b><b>i</b><b>n</b><b>g</b>  records  to  determine if OVN needs to learn the mac bind‚Äê
       ings. Following flows are added:

              ‚Ä¢      For each router port <u>P</u> that owns IP address <u>A</u>, which  be‚Äê
                     longs to subnet <u>S</u> with prefix length <u>L</u>, if the option <b>a</b><b>l</b>‚Äê‚Äê
                     <b>w</b><b>a</b><b>y</b><b>s</b><b>_</b><b>l</b><b>e</b><b>a</b><b>r</b><b>n</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b>  is  <b>t</b><b>r</b><b>u</b><b>e</b>  for this router, a
                     priority-100 flow is added which matches <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b>  <u>P</u>  &amp;&amp;&amp;&amp;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>S</u><b>/</b><u>L</u> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>1</b> (ARP request) with the fol‚Äê
                     lowing actions:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>a</b><b>r</b><b>p</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>)</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     If the option <b>a</b><b>l</b><b>w</b><b>a</b><b>y</b><b>s</b><b>_</b><b>l</b><b>e</b><b>a</b><b>r</b><b>n</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> is <b>f</b><b>a</b><b>l</b><b>s</b><b>e</b>, the
                     following two flows are added.

                     A priority-110 flow is added which matches <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b>  <b>=</b><b>=</b>  <u>S</u><b>/</b><u>L</u>  &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>A</u> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>1</b> (ARP re‚Äê
                     quest) with the following actions:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>a</b><b>r</b><b>p</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>)</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>3</b><b>]</b> <b>=</b> <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     A priority-100 flow is added which matches <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp;
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>S</u><b>/</b><u>L</u> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>1</b> (ARP request) with the fol‚Äê
                     lowing actions:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>a</b><b>r</b><b>p</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>)</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>3</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>i</b><b>p</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>)</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     If the logical router port <u>P</u>  is  a  distributed  gateway
                     router  port,  additional match <b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><b>c</b><b>r</b><b>-</b><u>P</u><b>)</b>
                     is added for all these flows.

              ‚Ä¢      A priority-100 flow which matches on  ARP  reply  packets
                     and    applies    the   actions   if   the   option   <b>a</b><b>l</b>‚Äê‚Äê
                     <b>w</b><b>a</b><b>y</b><b>s</b><b>_</b><b>l</b><b>e</b><b>a</b><b>r</b><b>n</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> is <b>t</b><b>r</b><b>u</b><b>e</b>:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>a</b><b>r</b><b>p</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>)</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     If the option <b>a</b><b>l</b><b>w</b><b>a</b><b>y</b><b>s</b><b>_</b><b>l</b><b>e</b><b>a</b><b>r</b><b>n</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> is <b>f</b><b>a</b><b>l</b><b>s</b><b>e</b>, the
                     above actions will be:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>a</b><b>r</b><b>p</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>)</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>3</b><b>]</b> <b>=</b> <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


              ‚Ä¢      A priority-100 flow which matches on IPv6  Neighbor  Dis‚Äê
                     covery  advertisement  packet  and applies the actions if
                     the option <b>a</b><b>l</b><b>w</b><b>a</b><b>y</b><b>s</b><b>_</b><b>l</b><b>e</b><b>a</b><b>r</b><b>n</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> is <b>t</b><b>r</b><b>u</b><b>e</b>:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>n</b><b>d</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b><b>)</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     If the option <b>a</b><b>l</b><b>w</b><b>a</b><b>y</b><b>s</b><b>_</b><b>l</b><b>e</b><b>a</b><b>r</b><b>n</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> is <b>f</b><b>a</b><b>l</b><b>s</b><b>e</b>, the
                     above actions will be:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>n</b><b>d</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b><b>)</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>3</b><b>]</b> <b>=</b> <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


              ‚Ä¢      A priority-100 flow which matches on IPv6  Neighbor  Dis‚Äê
                     covery solicitation packet and applies the actions if the
                     option <b>a</b><b>l</b><b>w</b><b>a</b><b>y</b><b>s</b><b>_</b><b>l</b><b>e</b><b>a</b><b>r</b><b>n</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> is <b>t</b><b>r</b><b>u</b><b>e</b>:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>n</b><b>d</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>s</b><b>l</b><b>l</b><b>)</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     If the option <b>a</b><b>l</b><b>w</b><b>a</b><b>y</b><b>s</b><b>_</b><b>l</b><b>e</b><b>a</b><b>r</b><b>n</b><b>_</b><b>f</b><b>r</b><b>o</b><b>m</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> is <b>f</b><b>a</b><b>l</b><b>s</b><b>e</b>, the
                     above actions will be:

                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>n</b><b>d</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>s</b><b>l</b><b>l</b><b>)</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>3</b><b>]</b> <b>=</b> <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>n</b><b>d</b><b>_</b><b>i</b><b>p</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>)</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


              ‚Ä¢      A  priority-0  fallback flow that matches all packets and
                     applies the action  <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b>  <b>=</b>  <b>1</b><b>;</b>  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>  advancing  the
                     packet to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>:</u> <u>N</u><u>e</u><u>i</u><u>g</u><u>h</u><u>b</u><u>o</u><u>r</u> <u>l</u><u>e</u><u>a</u><u>r</u><u>n</u><u>i</u><u>n</u><u>g</u>

       This  table  adds flows to learn the mac bindings from the ARP and IPv6
       Neighbor Solicitation/Advertisement packets if it is  needed  according
       to the lookup results from the previous stage.

       reg9[2] will be <b>1</b> if the <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>a</b><b>r</b><b>p</b><b>/</b><b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>n</b><b>d</b> in the previous table was
       successful  or  skipped,  meaning no need to learn mac binding from the
       packet.

       reg9[3] will be <b>1</b> if the <b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>a</b><b>r</b><b>p</b><b>_</b><b>i</b><b>p</b><b>/</b><b>l</b><b>o</b><b>o</b><b>k</b><b>u</b><b>p</b><b>_</b><b>n</b><b>d</b><b>_</b><b>i</b><b>p</b> in the previous ta‚Äê
       ble was successful or skipped, meaning it is ok to  learn  mac  binding
       from the packet (if reg9[2] is 0).

              ‚Ä¢      A  priority-100  flow  with  the  match  <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>2</b><b>]</b>  <b>=</b><b>=</b> <b>1</b> <b>|</b><b>|</b>
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>3</b><b>]</b> <b>=</b><b>=</b> <b>0</b> and advances the packet to the next table as
                     there is no need to learn the neighbor.

              ‚Ä¢      A priority-95 flow with the match <b>n</b><b>d</b><b>_</b><b>n</b><b>s</b> &amp;&amp;&amp;&amp; <b>(</b><b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b>  <b>0</b>
                     <b>|</b><b>|</b> <b>n</b><b>d</b><b>.</b><b>s</b><b>l</b><b>l</b> <b>=</b><b>=</b> <b>0</b><b>)</b> and applies the action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>

              ‚Ä¢      A priority-90 flow with the match <b>a</b><b>r</b><b>p</b> and applies the ac‚Äê
                     tion <b>p</b><b>u</b><b>t</b><b>_</b><b>a</b><b>r</b><b>p</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>,</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>

              ‚Ä¢      A  priority-95  flow with the match <b>n</b><b>d</b><b>_</b><b>n</b><b>a</b>  &amp;&amp;&amp;&amp; <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b> <b>=</b><b>=</b> <b>0</b>
                     and  applies   the   action   <b>p</b><b>u</b><b>t</b><b>_</b><b>n</b><b>d</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b>   <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b><b>,</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>

              ‚Ä¢      A  priority-90  flow with the match <b>n</b><b>d</b><b>_</b><b>n</b><b>a</b> and applies the
                     action <b>p</b><b>u</b><b>t</b><b>_</b><b>n</b><b>d</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>

              ‚Ä¢      A priority-90 flow with the match <b>n</b><b>d</b><b>_</b><b>n</b><b>s</b> and  applies  the
                     action <b>p</b><b>u</b><b>t</b><b>_</b><b>n</b><b>d</b><b>(</b><b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>,</b> <b>n</b><b>d</b><b>.</b><b>s</b><b>l</b><b>l</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>

              ‚Ä¢      A  priority-0  logical  flow that matches all packets not
                     already handled (match <b>1</b>) and drops them (action <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>).

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>3</u><u>:</u> <u>I</u><u>P</u> <u>I</u><u>n</u><u>p</u><u>u</u><u>t</u>

       This table is the core of the logical router datapath functionality. It
       contains the following flows to implement very basic IP host  function‚Äê
       ality.

              ‚Ä¢      For  each <b>d</b><b>n</b><b>a</b><b>t</b><b>_</b><b>a</b><b>n</b><b>d</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> NAT rule on a distributed logical
                     routers or gateway routers with gateway  port  configured
                     with  <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b>  to  a valid integer value <u>M</u>, a
                     priority-160 flow with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b>  <u>L</u><u>R</u><u>P</u>  &amp;&amp;&amp;&amp;  <b>R</b><b>E</b><b>G</b>‚Äê‚Äê
                     <b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b>  &amp;&amp;&amp;&amp; <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> <b>=</b><b>=</b> <b>0</b>, where <u>L</u><u>R</u><u>P</u>
                     is the logical router port and applies the following  ac‚Äê
                     tion for ipv4 and ipv6 respectively:

                     <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>_</b><b>e</b><b>r</b><b>r</b><b>o</b><b>r</b> <b>{</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>3</b><b>;</b> <b>/</b><b>*</b> <b>D</b><b>e</b><b>s</b><b>t</b><b>i</b><b>n</b><b>a</b><b>t</b><b>i</b><b>o</b><b>n</b> <b>U</b><b>n</b><b>r</b><b>e</b><b>a</b><b>c</b><b>h</b><b>a</b><b>b</b><b>l</b><b>e</b><b>.</b> <b>*</b><b>/</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b> <b>4</b><b>;</b>  <b>/</b><b>*</b> <b>F</b><b>r</b><b>a</b><b>g</b> <b>N</b><b>e</b><b>e</b><b>d</b><b>e</b><b>d</b> <b>a</b><b>n</b><b>d</b> <b>D</b><b>F</b> <b>w</b><b>a</b><b>s</b> <b>S</b><b>e</b><b>t</b><b>.</b> <b>*</b><b>/</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>f</b><b>r</b><b>a</b><b>g</b><b>_</b><b>m</b><b>t</b><b>u</b> <b>=</b> <u>M</u>;
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                         <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>I</u>;
                         <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>5</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> <b>=</b> <b>1</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> <b>0</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>L</u><u>R</u><u>P</u>;
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>
                     <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>_</b><b>e</b><b>r</b><b>r</b><b>o</b><b>r</b> <b>{</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>2</b><b>;</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b> <b>0</b><b>;</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>f</b><b>r</b><b>a</b><b>g</b><b>_</b><b>m</b><b>t</b><b>u</b> <b>=</b> <u>M</u>;
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>I</u>;
                         <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>5</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> <b>=</b> <b>1</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> <b>0</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>L</u><u>R</u><u>P</u>;
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


                     where  <u>E</u>  and  <u>I</u> are the NAT rule external mac and IP re‚Äê
                     spectively.

              ‚Ä¢      For distributed logical routers or gateway  routers  with
                     gateway  port  configured  with  <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b> to a
                     valid integer value, a priority-150 flow with  the  match
                     <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>L</u><u>R</u><u>P</u> &amp;&amp;&amp;&amp; <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> &amp;&amp;&amp;&amp; <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b>‚Äê‚Äê
                     <b>B</b><b>A</b><b>C</b><b>K</b>  <b>=</b><b>=</b>  <b>0</b>, where <u>L</u><u>R</u><u>P</u> is the logical router port and ap‚Äê
                     plies the following action  for  ipv4  and  ipv6  respec‚Äê
                     tively:

                     <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>_</b><b>e</b><b>r</b><b>r</b><b>o</b><b>r</b> <b>{</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>3</b><b>;</b> <b>/</b><b>*</b> <b>D</b><b>e</b><b>s</b><b>t</b><b>i</b><b>n</b><b>a</b><b>t</b><b>i</b><b>o</b><b>n</b> <b>U</b><b>n</b><b>r</b><b>e</b><b>a</b><b>c</b><b>h</b><b>a</b><b>b</b><b>l</b><b>e</b><b>.</b> <b>*</b><b>/</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b> <b>4</b><b>;</b>  <b>/</b><b>*</b> <b>F</b><b>r</b><b>a</b><b>g</b> <b>N</b><b>e</b><b>e</b><b>d</b><b>e</b><b>d</b> <b>a</b><b>n</b><b>d</b> <b>D</b><b>F</b> <b>w</b><b>a</b><b>s</b> <b>S</b><b>e</b><b>t</b><b>.</b> <b>*</b><b>/</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>f</b><b>r</b><b>a</b><b>g</b><b>_</b><b>m</b><b>t</b><b>u</b> <b>=</b> <u>M</u>;
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u>;
                         <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>I</u>;
                         <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>5</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> <b>=</b> <b>1</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> <b>0</b><b>;</b>
                         <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>i</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b> <b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>=</b><b>0</b><b>)</b><b>;</b>
                     <b>}</b><b>;</b>
                     <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>_</b><b>e</b><b>r</b><b>r</b><b>o</b><b>r</b> <b>{</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>2</b><b>;</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b> <b>0</b><b>;</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>f</b><b>r</b><b>a</b><b>g</b><b>_</b><b>m</b><b>t</b><b>u</b> <b>=</b> <u>M</u>;
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u>;
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>I</u>;
                         <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>5</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> <b>=</b> <b>1</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> <b>0</b><b>;</b>
                         <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>i</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b> <b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>=</b><b>0</b><b>)</b><b>;</b>
                     <b>}</b><b>;</b>


              ‚Ä¢      For  each NAT entry of a distributed logical router (with
                     distributed gateway router port(s)) of type <b>s</b><b>n</b><b>a</b><b>t</b>, a  pri‚Äê
                     ority-120 flow with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>A</u>
                     advances  the packet to the next pipeline, where <u>P</u> is the
                     distributed logical router port corresponding to the  NAT
                     entry  (specified  or  inferred) and <u>A</u> is the <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b><b>_</b><b>i</b><b>p</b>
                     set in the NAT entry. If  <u>A</u>  is  an  IPv6  address,  then
                     <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> is used for the match.

                     The  above  flow is required to handle the routing of the
                     East/west NAT traffic.

              ‚Ä¢      For each BFD port the two  following  priority-110  flows
                     are added to manage BFD traffic:

                     ‚Ä¢      if  <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b>  or <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> is any IP address owned by
                            the router port and <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <b>3</b><b>7</b><b>8</b><b>4</b> ,  the  packet
                            is advanced to the next pipeline stage.

                     ‚Ä¢      if  <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b>  or <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> is any IP address owned by
                            the router port and <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>  <b>3</b><b>7</b><b>8</b><b>4</b>  ,  the  <b>h</b><b>a</b><b>n</b>‚Äê‚Äê
                            <b>d</b><b>l</b><b>e</b><b>_</b><b>b</b><b>f</b><b>d</b><b>_</b><b>m</b><b>s</b><b>g</b> action is executed.

              ‚Ä¢      L3  admission control: Priority-120 flows allows IGMP and
                     MLD packets if the router has logical ports that have <b>o</b><b>p</b>‚Äê‚Äê
                     <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>f</b><b>l</b><b>o</b><b>o</b><b>d</b><b>=</b>‚Äô‚Äô<b>t</b><b>r</b><b>u</b><b>e</b>‚Äô‚Äô.

              ‚Ä¢      L3 admission control: A priority-100 flow  drops  packets
                     that match any of the following:

                     ‚Ä¢      <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b><b>[</b><b>2</b><b>8</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b> <b>=</b><b>=</b> <b>0</b><b>x</b><b>e</b> (multicast source)

                     ‚Ä¢      <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <b>2</b><b>5</b><b>5</b><b>.</b><b>2</b><b>5</b><b>5</b><b>.</b><b>2</b><b>5</b><b>5</b><b>.</b><b>2</b><b>5</b><b>5</b> (broadcast source)

                     ‚Ä¢      <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b>  <b>=</b><b>=</b>  <b>1</b><b>2</b><b>7</b><b>.</b><b>0</b><b>.</b><b>0</b><b>.</b><b>0</b><b>/</b><b>8</b> <b>|</b><b>|</b> <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <b>1</b><b>2</b><b>7</b><b>.</b><b>0</b><b>.</b><b>0</b><b>.</b><b>0</b><b>/</b><b>8</b>
                            (localhost source or destination)

                     ‚Ä¢      <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <b>0</b><b>.</b><b>0</b><b>.</b><b>0</b><b>.</b><b>0</b><b>/</b><b>8</b> <b>|</b><b>|</b> <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <b>0</b><b>.</b><b>0</b><b>.</b><b>0</b><b>.</b><b>0</b><b>/</b><b>8</b> (zero
                            network source or destination)

                     ‚Ä¢      <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> or <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> is any IP address owned by  the
                            router,  unless the packet was recirculated due to
                            egress   loopback    as    indicated    by    <b>R</b><b>E</b><b>G</b>‚Äê‚Äê
                            <b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b>.

                     ‚Ä¢      <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> is the broadcast address of any IP network
                            known to the router.

              ‚Ä¢      A  priority-100 flow parses DHCPv6 replies from IPv6 pre‚Äê
                     fix delegation routers (<b>u</b><b>d</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b>  <b>=</b><b>=</b>  <b>5</b><b>4</b><b>7</b>  &amp;&amp;&amp;&amp;  <b>u</b><b>d</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>
                     <b>5</b><b>4</b><b>6</b>). The <b>h</b><b>a</b><b>n</b><b>d</b><b>l</b><b>e</b><b>_</b><b>d</b><b>h</b><b>c</b><b>p</b><b>v</b><b>6</b><b>_</b><b>r</b><b>e</b><b>p</b><b>l</b><b>y</b> is used to send IPv6 prefix
                     delegation messages to the delegation router.

              ‚Ä¢      ICMP  echo reply. These flows reply to ICMP echo requests
                     received for the router‚Äôs IP address. Let <u>A</u> be an IP  ad‚Äê
                     dress owned by a router port. Then, for each <u>A</u> that is an
                     IPv4  address, a priority-90 flow matches on <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>A</u>
                     and <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b><b>=</b> <b>8</b> &amp;&amp;&amp;&amp; <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b><b>=</b>  <b>0</b>  (ICMP  echo  re‚Äê
                     quest). For each <u>A</u> that is an IPv6 address, a priority-90
                     flow  matches  on  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b> <u>A</u> and <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b><b>=</b> <b>1</b><b>2</b><b>8</b> &amp;&amp;&amp;&amp;
                     <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b><b>=</b> <b>0</b> (ICMPv6 echo request). The  port  of  the
                     router  that  receives  the echo request does not matter.
                     Also, the <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b>  of  the  echo  request  packet  is  not
                     checked,  so  it complies with RFC 1812, section 4.2.2.9.
                     Flows for ICMPv4 echo requests use the following actions:

                     <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <lt;<lt;<b>-</b>>gt;>gt; <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>5</b><b>;</b>
                     <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>0</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     Flows for ICMPv6 echo requests use the following actions:

                     <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <lt;<lt;<b>-</b>>gt;>gt; <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>5</b><b>;</b>
                     <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>1</b><b>2</b><b>9</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


              ‚Ä¢      Reply to ARP requests.

                     These flows reply to ARP requests for the router‚Äôs own IP
                     address. The ARP requests are handled  only  if  the  re‚Äê
                     questor‚Äôs  IP  belongs to the same subnets of the logical
                     router port. For each router port <u>P</u> that owns IP  address
                     <u>A</u>,  which  belongs  to subnet <u>S</u> with prefix length <u>L</u>, and
                     Ethernet address <u>E</u>, a priority-90 flow matches <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b>  <b>=</b><b>=</b>
                     <u>P</u>  &amp;&amp;&amp;&amp;  <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>S</u><b>/</b><u>L</u> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>A</u> (ARP
                     request) with the following actions:

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b> <b>2</b><b>;</b> <b>/</b><b>*</b> <b>A</b><b>R</b><b>P</b> <b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>.</b> <b>*</b><b>/</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>h</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b> <b>=</b> <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b> <u>A</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     For the gateway port  on  a  distributed  logical  router
                     (where  one of the logical router ports specifies a gate‚Äê
                     way chassis), the above flows are only programmed on  the
                     gateway port instance on the gateway chassis. This behav‚Äê
                     ior avoids generation of multiple ARP responses from dif‚Äê
                     ferent chassis, and allows upstream MAC learning to point
                     to the gateway chassis.

                     For   the   logical  router  port  with  the  option  <b>r</b><b>e</b>‚Äê‚Äê
                     <b>s</b><b>i</b><b>d</b><b>e</b><b>-</b><b>o</b><b>n</b><b>-</b><b>r</b><b>e</b><b>d</b><b>i</b><b>r</b><b>e</b><b>c</b><b>t</b><b>-</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b> set (which is centralized),  the
                     above  flows  are only programmed on the gateway port in‚Äê
                     stance on the gateway chassis (if the logical router  has
                     a distributed gateway port). This behavior avoids genera‚Äê
                     tion  of  multiple  ARP responses from different chassis,
                     and allows upstream MAC learning to point to the  gateway
                     chassis.

              ‚Ä¢      Reply  to  IPv6 Neighbor Solicitations. These flows reply
                     to Neighbor Solicitation requests for  the  router‚Äôs  own
                     IPv6  address and populate the logical router‚Äôs mac bind‚Äê
                     ing table.

                     For each router port <u>P</u> that  owns  IPv6  address  <u>A</u>,  so‚Äê
                     licited  node address <u>S</u>, and Ethernet address <u>E</u>, a prior‚Äê
                     ity-90 flow matches <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>n</b><b>d</b><b>_</b><b>n</b><b>s</b>  &amp;&amp;&amp;&amp;  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>
                     <b>{</b><u>A</u><b>,</b> <u>E</u><b>}</b> &amp;&amp;&amp;&amp; <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b><b>=</b> <u>A</u> with the following actions:

                     <b>n</b><b>d</b><b>_</b><b>n</b><b>a</b><b>_</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b> <b>{</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>;</b>
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b> <b>=</b> <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


                     For  the  gateway  port  on  a distributed logical router
                     (where one of the logical router ports specifies a  gate‚Äê
                     way  chassis),  the above flows replying to IPv6 Neighbor
                     Solicitations are only programmed on the gateway port in‚Äê
                     stance on the gateway chassis. This behavior avoids  gen‚Äê
                     eration  of  multiple replies from different chassis, and
                     allows upstream MAC learning  to  point  to  the  gateway
                     chassis.

              ‚Ä¢      These flows reply to ARP requests or IPv6 neighbor solic‚Äê
                     itation  for  the  virtual IP addresses configured in the
                     router for NAT (both DNAT and SNAT) or load balancing.

                     IPv4: For a configured NAT (both DNAT and  SNAT)  IP  ad‚Äê
                     dress or a load balancer IPv4 VIP <u>A</u>, for each router port
                     <u>P</u>  with  Ethernet  address  <u>E</u>, a priority-90 flow matches
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b><b>=</b> <u>A</u> (ARP request) with  the  fol‚Äê
                     lowing actions:

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b> <b>2</b><b>;</b> <b>/</b><b>*</b> <b>A</b><b>R</b><b>P</b> <b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>.</b> <b>*</b><b>/</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>h</b><b>a</b> <b>=</b> <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b> <b>=</b> <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>;</b>
                     <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <lt;<lt;<b>-</b>>gt;>gt; <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     IPv4:  For a configured load balancer IPv4 VIP, a similar
                     flow is added with the additional match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b>  <b>=</b><b>=</b>  <u>P</u>  if
                     the  VIP is reachable from any logical router port of the
                     logical router.

                     If the router port <u>P</u>  is  a  distributed  gateway  router
                     port,  then  the  <b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><u>P</u><b>)</b> is also added in
                     the match condition for the load balancer IPv4 VIP <u>A</u>.

                     IPv6: For a configured NAT (both DNAT and  SNAT)  IP  ad‚Äê
                     dress or a load balancer IPv6 VIP <u>A</u> (if the VIP is reach‚Äê
                     able from any logical router port of the logical router),
                     solicited  node  address  <u>S</u>,  for each router port <u>P</u> with
                     Ethernet address <u>E</u>, a priority-90 flow matches <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b>  <b>=</b><b>=</b>
                     <u>P</u>  &amp;&amp;&amp;&amp;  <b>n</b><b>d</b><b>_</b><b>n</b><b>s</b>  &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <b>{</b><u>A</u><b>,</b> <u>S</u><b>}</b> &amp;&amp;&amp;&amp; <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b><b>=</b> <u>A</u> with
                     the following actions:

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>n</b><b>d</b><b>_</b><b>n</b><b>a</b> <b>{</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>;</b>
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b> <b>=</b> <b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>0</b><b>.</b><b>.</b><b>4</b><b>7</b><b>]</b><b>;</b>
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>A</u>;
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b> <u>A</u>;
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b>


                     If the router port <u>P</u>  is  a  distributed  gateway  router
                     port,  then  the  <b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><u>P</u><b>)</b> is also added in
                     the match condition for the load balancer IPv6 VIP <u>A</u>.

                     For the gateway port on a distributed logical router with
                     NAT (where one of the logical router  ports  specifies  a
                     gateway chassis):

                     ‚Ä¢      If the corresponding NAT rule cannot be handled in
                            a  distributed  manner, then a priority-92 flow is
                            programmed on the gateway  port  instance  on  the
                            gateway  chassis.  A priority-91 drop flow is pro‚Äê
                            grammed on the other chassis when ARP  requests/NS
                            packets are received on the gateway port. This be‚Äê
                            havior avoids generation of multiple ARP responses
                            from  different  chassis,  and allows upstream MAC
                            learning to point to the gateway chassis.

                     ‚Ä¢      If the corresponding NAT rule can be handled in  a
                            distributed  manner,  then  this flow is only pro‚Äê
                            grammed on the gateway  port  instance  where  the
                            <b>l</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b> specified in the NAT rule resides.

                            Some  of  the actions are different for this case,
                            using the <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b><b>_</b><b>m</b><b>a</b><b>c</b> specified in the  NAT  rule
                            rather than the gateway port‚Äôs Ethernet address <u>E</u>:

                            <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>e</u><u>x</u><u>t</u><u>e</u><u>r</u><u>n</u><u>a</u><u>l</u><b>_</b><u>m</u><u>a</u><u>c</u>;
                            <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>h</b><b>a</b> <b>=</b> <u>e</u><u>x</u><u>t</u><u>e</u><u>r</u><u>n</u><u>a</u><u>l</u><b>_</b><u>m</u><u>a</u><u>c</u>;


                            or in the case of IPv6 neighbor solicition:

                            <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>e</u><u>x</u><u>t</u><u>e</u><u>r</u><u>n</u><u>a</u><u>l</u><b>_</b><u>m</u><u>a</u><u>c</u>;
                            <b>n</b><b>d</b><b>.</b><b>t</b><b>l</b><b>l</b> <b>=</b> <u>e</u><u>x</u><u>t</u><u>e</u><u>r</u><u>n</u><u>a</u><u>l</u><b>_</b><u>m</u><u>a</u><u>c</u>;


                            This  behavior  avoids  generation of multiple ARP
                            responses from different chassis, and  allows  up‚Äê
                            stream  MAC learning to point to the correct chas‚Äê
                            sis.

              ‚Ä¢      Priority-85 flows which drops the ARP and  IPv6  Neighbor
                     Discovery packets.

              ‚Ä¢      A priority-84 flow explicitly allows IPv6 multicast traf‚Äê
                     fic  that is supposed to reach the router pipeline (i.e.,
                     router solicitation and router advertisement packets).

              ‚Ä¢      A priority-83 flow explicitly drops IPv6 multicast  traf‚Äê
                     fic that is destined to reserved multicast groups.

              ‚Ä¢      A  priority-82  flow  allows  IP multicast traffic if <b>o</b><b>p</b>‚Äê‚Äê
                     <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>:mcast_relay=‚Äôtrue‚Äô, otherwise drops it.

              ‚Ä¢      UDP port unreachable.  Priority-80  flows  generate  ICMP
                     port  unreachable  messages in reply to UDP datagrams di‚Äê
                     rected to the router‚Äôs IP address, except in the  special
                     case  of  gateways,  which  accept  traffic directed to a
                     router IP for load balancing and NAT purposes.

                     These flows should not match IP  fragments  with  nonzero
                     offset.

              ‚Ä¢      TCP  reset. Priority-80 flows generate TCP reset messages
                     in reply to TCP datagrams directed to the router‚Äôs IP ad‚Äê
                     dress, except in the special case of gateways, which  ac‚Äê
                     cept  traffic  directed to a router IP for load balancing
                     and NAT purposes.

                     These flows should not match IP  fragments  with  nonzero
                     offset.

              ‚Ä¢      Protocol or address unreachable. Priority-70 flows gener‚Äê
                     ate  ICMP  protocol  or  address unreachable messages for
                     IPv4 and IPv6 respectively in reply to  packets  directed
                     to  the  router‚Äôs  IP  address on IP protocols other than
                     UDP, TCP, and ICMP, except in the special case  of  gate‚Äê
                     ways,  which  accept  traffic directed to a router IP for
                     load balancing purposes.

                     These flows should not match IP  fragments  with  nonzero
                     offset.

              ‚Ä¢      Drop  other  IP  traffic to this router. These flows drop
                     any other traffic destined  to  an  IP  address  of  this
                     router  that  is  not already handled by one of the flows
                     above, which amounts to ICMP (other than  echo  requests)
                     and fragments with nonzero offsets. For each IP address <u>A</u>
                     owned  by  the router, a priority-60 flow matches <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b>
                     <b>=</b><b>=</b> <u>A</u> or <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>A</u> and drops the traffic. An  exception
                     is  made  and  the  above flow is not added if the router
                     port‚Äôs own IP address is used  to  SNAT  packets  passing
                     through  that  router or if it is used as a load balancer
                     VIP.

       The flows above handle all of the traffic that might be directed to the
       router itself. The following flows (with lower priorities)  handle  the
       remaining traffic, potentially for forwarding:

              ‚Ä¢      Drop  Ethernet  local  broadcast. A priority-50 flow with
                     match <b>e</b><b>t</b><b>h</b><b>.</b><b>b</b><b>c</b><b>a</b><b>s</b><b>t</b> drops traffic destined to the local  Eth‚Äê
                     ernet  broadcast  address.  By  definition  this  traffic
                     should not be forwarded.

              ‚Ä¢      Avoid ICMP time exceeded  for  multicast.  A  priority-32
                     flow  with  match  <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b>  <b>=</b><b>=</b> <b>{</b><b>0</b><b>,</b> <b>1</b><b>}</b> &amp;&amp;&amp;&amp; <b>!</b><b>i</b><b>p</b><b>.</b><b>l</b><b>a</b><b>t</b><b>e</b><b>r</b><b>_</b><b>f</b><b>r</b><b>a</b><b>g</b> &amp;&amp;&amp;&amp;
                     <b>(</b><b>i</b><b>p</b><b>4</b><b>.</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b> <b>|</b><b>|</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>)</b> and actions <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>  drops  multi‚Äê
                     cast  packets  whose TTL has expired without sending ICMP
                     time exceeded.

              ‚Ä¢      ICMP time exceeded. For each router port <u>P</u>, whose IP  ad‚Äê
                     dress  is <u>A</u>, a priority-31 flow with match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp;
                     <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b><b>=</b> <b>{</b><b>0</b><b>,</b> <b>1</b><b>}</b> &amp;&amp;&amp;&amp; <b>!</b><b>i</b><b>p</b><b>.</b><b>l</b><b>a</b><b>t</b><b>e</b><b>r</b><b>_</b><b>f</b><b>r</b><b>a</b><b>g</b> matches packets  whose
                     TTL  has  expired,  with the following actions to send an
                     ICMP time exceeded reply for IPv4 and IPv6 respectively:

                     <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b> <b>{</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>1</b><b>1</b><b>;</b> <b>/</b><b>*</b> <b>T</b><b>i</b><b>m</b><b>e</b> <b>e</b><b>x</b><b>c</b><b>e</b><b>e</b><b>d</b><b>e</b><b>d</b><b>.</b> <b>*</b><b>/</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b> <b>0</b><b>;</b>  <b>/</b><b>*</b> <b>T</b><b>T</b><b>L</b> <b>e</b><b>x</b><b>c</b><b>e</b><b>e</b><b>d</b><b>e</b><b>d</b> <b>i</b><b>n</b> <b>t</b><b>r</b><b>a</b><b>n</b><b>s</b><b>i</b><b>t</b><b>.</b> <b>*</b><b>/</b>
                         <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>A</u>;
                         <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>4</b><b>;</b>
                         <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>
                     <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b> <b>{</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>3</b><b>;</b> <b>/</b><b>*</b> <b>T</b><b>i</b><b>m</b><b>e</b> <b>e</b><b>x</b><b>c</b><b>e</b><b>e</b><b>d</b><b>e</b><b>d</b><b>.</b> <b>*</b><b>/</b>
                         <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b> <b>0</b><b>;</b>  <b>/</b><b>*</b> <b>T</b><b>T</b><b>L</b> <b>e</b><b>x</b><b>c</b><b>e</b><b>e</b><b>d</b><b>e</b><b>d</b> <b>i</b><b>n</b> <b>t</b><b>r</b><b>a</b><b>n</b><b>s</b><b>i</b><b>t</b><b>.</b> <b>*</b><b>/</b>
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>A</u>;
                         <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>4</b><b>;</b>
                         <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


              ‚Ä¢      TTL discard. A priority-30 flow with match <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b><b>=</b>  <b>{</b><b>0</b><b>,</b>
                     <b>1</b><b>}</b>  and  actions  <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b> drops other packets whose TTL has
                     expired, that should not receive a ICMP error reply (i.e.
                     fragments with nonzero offset).

              ‚Ä¢      Next table. A priority-0 flows  match  all  packets  that
                     aren‚Äôt  already  handled  and  uses actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> to feed
                     them to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>4</u><u>:</u> <u>U</u><u>N</u><u>S</u><u>N</u><u>A</u><u>T</u>

       This is for already established  connections‚Äô  reverse  traffic.  i.e.,
       SNAT  has  already  been done in egress pipeline and now the packet has
       entered the ingress pipeline as part of a reply. It is unSNATted here.

       Ingress Table 4: UNSNAT on Gateway and Distributed Routers

              ‚Ä¢      If the Router (Gateway or Distributed) is configured with
                     load balancers, then below lflows are added:

                     For each IPv4 address <u>A</u> defined as load balancer VIP with
                     the protocol <u>P</u> (and the protocol port <u>T</u>  if  defined)  is
                     also present as an <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b><b>_</b><b>i</b><b>p</b> in the NAT table, a prior‚Äê
                     ity-120  logical  flow  is  added  with  the match <b>i</b><b>p</b><b>4</b> &amp;&amp;&amp;&amp;
                     <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>A</u> &amp;&amp;&amp;&amp; <u>P</u> with the action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>  to  advance  the
                     packet to the next table. If the load balancer has proto‚Äê
                     col port <b>B</b> defined, then the match also has <u>P</u><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u>.

                     The above flows are also added for IPv6 load balancers.

       Ingress Table 4: UNSNAT on Gateway Routers

              ‚Ä¢      If  the  Gateway router has been configured to force SNAT
                     any previously DNATted packets to <u>B</u>, a priority-110  flow
                     matches  <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> or <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> with an
                     action <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>;</b> .

                     If   the    Gateway    router    is    configured    with
                     <b>l</b><b>b</b><b>_</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>i</b><b>p</b><b>=</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b><b>_</b><b>i</b><b>p</b>  then for every logical router
                     port <u>P</u> attached to the Gateway router with the router  ip
                     <u>B</u>,  a priority-110 flow is added with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b>
                     <u>P</u> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> or <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> with  an
                     action <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>;</b> .

                     If  the  Gateway router has been configured to force SNAT
                     any previously load-balanced packets to <u>B</u>, a priority-100
                     flow matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> or <b>i</b><b>p</b>  &amp;&amp;&amp;&amp;  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>  <u>B</u>
                     with an action <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>;</b> .

                     For  each  NAT  configuration in the OVN Northbound data‚Äê
                     base, that asks to change the  source  IP  address  of  a
                     packet  from  <u>A</u>  to  <u>B</u>,  a priority-90 flow matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp;
                     <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> or  <b>i</b><b>p</b>  &amp;&amp;&amp;&amp;  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>  <u>B</u>  with  an  action
                     <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>;</b>  .  If the NAT rule is of type dnat_and_snat and
                     has <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b> in the options, then the action  would
                     be <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

       Ingress Table 4: UNSNAT on Distributed Routers

              ‚Ä¢      For  each  configuration  in the OVN Northbound database,
                     that asks to change the source IP  address  of  a  packet
                     from <u>A</u> to <u>B</u>, two priority-100 flows are added.

                     If  the  NAT rule cannot be handled in a distributed man‚Äê
                     ner, then the below  priority-100  flows  are  only  pro‚Äê
                     grammed on the gateway chassis.

                     ‚Ä¢      The  first  flow matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> &amp;&amp;&amp;&amp; <b>i</b><b>n</b>‚Äê‚Äê
                            <b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u>
                             or <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> &amp;&amp;&amp;&amp; <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u> where <u>G</u><u>W</u> is
                            the distributed gateway port corresponding to  the
                            NAT  rule  (specified or inferred), with an action
                            <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>;</b> to unSNAT in the common zone. If the  NAT
                            rule  is  of  type  dnat_and_snat  and  has <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b>‚Äê‚Äê
                            <b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b> in the options, then the action would be
                            <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                            If the NAT entry is of type <b>s</b><b>n</b><b>a</b><b>t</b>, then there is an
                            additional match <b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><u>c</u><u>r</u><u>-</u><u>G</u><u>W</u><b>)</b>
                             where <u>c</u><u>r</u><u>-</u><u>G</u><u>W</u> is the chassis resident port of <u>G</u><u>W</u>.

                     A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>5</u><u>:</u> <u>D</u><u>E</u><u>F</u><u>R</u><u>A</u><u>G</u>

       This is to send packets to connection tracker for tracking and  defrag‚Äê
       mentation.  It  contains a priority-0 flow that simply moves traffic to
       the next table.

       For all load balancing rules  that  are  configured  in  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>
       database  for  a  Gateway router, a priority-100 flow is added for each
       configured virtual IP address <u>V</u><u>I</u><u>P</u>. For IPv4 <u>V</u><u>I</u><u>P</u><u>s</u> the flow matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp;
       <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u>. For IPv6 <u>V</u><u>I</u><u>P</u><u>s</u>, the flow matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>  <u>V</u><u>I</u><u>P</u>.
       The flow applies the action  <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>;</b> to send IP packets to the connec‚Äê
       tion tracker for packet de-fragmentation and to dnat the destination IP
       for the committed connection before sending it to the next table.

       If  ECMP  routes  with symmetric reply are configured in the <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b>‚Äê‚Äê
       <b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database for a gateway router, a priority-100 flow is  added  for
       each  router port on which symmetric replies are configured. The match‚Äê
       ing logic for these ports essentially reverses the configured logic  of
       the  ECMP  route.  So  for instance, a route with a destination routing
       policy will instead match if the source IP address matches  the  static
       route‚Äôs prefix. The flow uses the actions <b>c</b><b>h</b><b>k</b><b>_</b><b>e</b><b>c</b><b>m</b><b>p</b><b>_</b><b>n</b><b>h</b><b>_</b><b>m</b><b>a</b><b>c</b><b>(</b><b>)</b><b>;</b> <b>c</b><b>t</b><b>_</b><b>n</b><b>e</b><b>x</b><b>t</b> or
       <b>c</b><b>h</b><b>k</b><b>_</b><b>e</b><b>c</b><b>m</b><b>p</b><b>_</b><b>n</b><b>h</b><b>(</b><b>)</b><b>;</b> <b>c</b><b>t</b><b>_</b><b>n</b><b>e</b><b>x</b><b>t</b> to send IP packets to table <b>7</b><b>6</b> or to table <b>7</b><b>7</b> in
       order to check if source info are already stored by OVN and then to the
       connection  tracker  for  packet  de-fragmentation  and tracking before
       sending it to the next table.

       If load balancing rules are configured in <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database for a
       Gateway router, a priority 50 flow that matches <b>i</b><b>c</b><b>m</b><b>p</b> <b>|</b><b>|</b> <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b>  with  an
       action  of  <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>;</b>,  this  allows potentially related ICMP traffic to
       pass through CT.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>6</u><u>:</u> <u>L</u><u>o</u><u>a</u><u>d</u> <u>b</u><u>a</u><u>l</u><u>a</u><u>n</u><u>c</u><u>i</u><u>n</u><u>g</u> <u>a</u><u>f</u><u>f</u><u>i</u><u>n</u><u>i</u><u>t</u><u>y</u> <u>c</u><u>h</u><u>e</u><u>c</u><u>k</u>

       Load balancing affinity check  table  contains  the  following  logical
       flows:

              ‚Ä¢      For all the configured load balancing rules for a logical
                     router  where a positive affinity timeout is specified in
                     <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> column, that includes a L4 port <u>P</u><u>O</u><u>R</u><u>T</u> of  protocol
                     <u>P</u>  and IPv4 or IPv6 address <u>V</u><u>I</u><u>P</u>, a priority-100 flow that
                     matches on <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp; <u>P</u> &amp;&amp;&amp;&amp; <b>P</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>
                     <u>P</u><u>O</u><u>R</u><u>T</u> (<b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u>
                      in the IPv6 case) with  an  action  of  <b>r</b><b>e</b><b>g</b><b>0</b>  <b>=</b>  <b>i</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b>  <b>=</b>  <b>P</b><b>.</b><b>d</b><b>s</b><b>t</b><b>;</b>  <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>6</b><b>]</b>  <b>=</b>  <b>c</b><b>h</b><b>k</b><b>_</b><b>l</b><b>b</b><b>_</b><b>a</b><b>f</b><b>f</b><b>(</b><b>)</b><b>;</b>  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>
                     (<b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b><b>=</b> <u>i</u><u>p</u><u>6</u><u>.</u><u>d</u><u>s</u><u>t</u>  in the IPv6 case)

              ‚Ä¢      A priority 0 flow is added which matches on  all  packets
                     and applies the action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>7</u><u>:</u> <u>D</u><u>N</u><u>A</u><u>T</u>

       Packets enter the pipeline with destination IP address that needs to be
       DNATted  from a virtual IP address to a real IP address. Packets in the
       reverse direction needs to be unDNATed.

       Ingress Table 7: Load balancing DNAT rules

       Following load balancing DNAT flows are added  for  Gateway  router  or
       Router  with gateway port. These flows are programmed only on the gate‚Äê
       way chassis. These flows do not get programmed for load balancers  with
       IPv6 <u>V</u><u>I</u><u>P</u><u>s</u>.

              ‚Ä¢      For all the configured load balancing rules for a logical
                     router  where a positive affinity timeout is specified in
                     <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> column, that includes a L4 port <u>P</u><u>O</u><u>R</u><u>T</u> of  protocol
                     <u>P</u>  and IPv4 or IPv6 address <u>V</u><u>I</u><u>P</u>, a priority-150 flow that
                     matches on <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>6</b><b>]</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>  <u>V</u><u>I</u><u>P</u>
                     &amp;&amp;&amp;&amp; <u>P</u> &amp;&amp;&amp;&amp; <b>P</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>  <u>P</u><u>O</u><u>R</u><u>T</u> with an action of <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>)</b>
                     ,  where  <u>a</u><u>r</u><u>g</u><u>s</u> contains comma separated IP addresses (and
                     optional port numbers) to load balance  to.  The  address
                     family of the IP addresses of <u>a</u><u>r</u><u>g</u><u>s</u> is the same as the ad‚Äê
                     dress family of <u>V</u><u>I</u><u>P</u>.

              ‚Ä¢      If  controller_event has been enabled for all the config‚Äê
                     ured load balancing rules for a Gateway router or  Router
                     with  gateway  port  in <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database that does
                     not have configured  backends,  a  priority-130  flow  is
                     added to trigger ovn-controller events whenever the chas‚Äê
                     sis  receives  a  packet  for  that  particular  VIP.  If
                     <b>e</b><b>v</b><b>e</b><b>n</b><b>t</b><b>-</b><b>e</b><b>l</b><b>b</b> meter has been previously created, it  will  be
                     associated to the empty_lb logical flow

              ‚Ä¢      For all the configured load balancing rules for a Gateway
                     router  or  Router  with  gateway  port in <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>
                     database that includes a L4 port <u>P</u><u>O</u><u>R</u><u>T</u> of protocol  <u>P</u>  and
                     IPv4  or  IPv6  address  <u>V</u><u>I</u><u>P</u>,  a  priority-120  flow that
                     matches on <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>!</b><b>c</b><b>t</b><b>.</b><b>r</b><b>e</b><b>l</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp;  <u>P</u>
                     &amp;&amp;&amp;&amp; <b>P</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>
                      <u>P</u><u>O</u><u>R</u><u>T</u> with an action of <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>)</b>, where <u>a</u><u>r</u><u>g</u><u>s</u> con‚Äê
                     tains  comma  separated  IPv4  or IPv6 addresses (and op‚Äê
                     tional port numbers) to load balance to. If the router is
                     configured to force SNAT any load-balanced  packets,  the
                     above  action will be replaced by <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b>
                     <b>=</b> <b>1</b><b>;</b> <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>;</b> <b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>)</b><b>;</b>. If the load balancing
                     rule is configured with <b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> set to true, the  above
                     action  will  be  replaced by <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b> <b>1</b><b>;</b>
                     <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>;</b> <b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>)</b><b>;</b>. If health check is enabled,
                     then <u>a</u><u>r</u><u>g</u><u>s</u> will only contain those endpoints whose service
                     monitor status entry in <b>O</b><b>V</b><b>N</b><b>_</b><b>S</b><b>o</b><b>u</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> db is  either  <b>o</b><b>n</b>‚Äê‚Äê
                     <b>l</b><b>i</b><b>n</b><b>e</b> or empty.

              ‚Ä¢      For  all the configured load balancing rules for a router
                     in <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database that includes just an  IP  ad‚Äê
                     dress  <u>V</u><u>I</u><u>P</u>  to match on, a priority-110 flow that matches
                     on <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>!</b><b>c</b><b>t</b><b>.</b><b>r</b><b>e</b><b>l</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> with an  ac‚Äê
                     tion of <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>)</b>, where <u>a</u><u>r</u><u>g</u><u>s</u> contains comma sepa‚Äê
                     rated IPv4 or IPv6 addresses. If the router is configured
                     to force SNAT any load-balanced packets, the above action
                     will   be   replaced   by  <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b>  <b>=</b>  <b>1</b><b>;</b>
                     <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>;</b> <b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>)</b><b>;</b>. If the load balancing rule
                     is configured with <b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> set to true, the  above  ac‚Äê
                     tion  will  be  replaced  by  <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b> <b>1</b><b>;</b>
                     <b>c</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>(</b><u>a</u><u>r</u><u>g</u><u>s</u><b>;</b> <b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>)</b><b>;</b>.

                     The previous table <b>l</b><b>r</b><b>_</b><b>i</b><b>n</b><b>_</b><b>d</b><b>e</b><b>f</b><b>r</b><b>a</b><b>g</b> sets  the  register  <b>r</b><b>e</b><b>g</b><b>0</b>
                     (or  <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b>  for IPv6) and does <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b>. Hence for estab‚Äê
                     lished traffic, this table just advances  the  packet  to
                     the next stage.

              ‚Ä¢      If  the load balancer is created with <b>-</b><b>-</b><b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b> option and
                     it has no active backends, a TCP reset segment (for  tcp)
                     or an ICMP port unreachable packet (for all other kind of
                     traffic)  will be sent whenever an incoming packet is re‚Äê
                     ceived for this load-balancer. Please note using <b>-</b><b>-</b><b>r</b><b>e</b><b>j</b><b>e</b><b>c</b><b>t</b>
                     option will disable empty_lb SB controller event for this
                     load balancer.

              ‚Ä¢      For the related traffic, a priority 50 flow that  matches
                     <b>c</b><b>t</b><b>.</b><b>r</b><b>e</b><b>l</b>  &amp;&amp;&amp;&amp;  <b>!</b><b>c</b><b>t</b><b>.</b><b>e</b><b>s</b><b>t</b> &amp;&amp;&amp;&amp; <b>!</b><b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b>  with an action of <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b>‚Äê‚Äê
                     <b>m</b><b>i</b><b>t</b><b>_</b><b>n</b><b>a</b><b>t</b><b>;</b>, if the router has load balancer assigned to it.
                     Along with two priority 70 flows that match <b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> and
                     <b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> flags, setting the <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b> <b>1</b>
                     or <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b> <b>1</b> accordingly.

              ‚Ä¢      For the established traffic,  a  priority  50  flow  that
                     matches  <b>c</b><b>t</b><b>.</b><b>e</b><b>s</b><b>t</b>  &amp;&amp;&amp;&amp;  <b>!</b><b>c</b><b>t</b><b>.</b><b>r</b><b>e</b><b>l</b> &amp;&amp;&amp;&amp; <b>!</b><b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>c</b><b>t</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>.</b><b>n</b><b>a</b><b>t</b><b>t</b><b>e</b><b>d</b>
                     with an action of <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>, if the router has load  balancer
                     assigned  to  it.  Along  with two priority 70 flows that
                     match  <b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b>  and  <b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b>  flags,   setting   the
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b> <b>1</b> or <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b> <b>1</b>
                     accordingly.

       Ingress Table 7: DNAT on Gateway Routers

              ‚Ä¢      For  each  configuration  in the OVN Northbound database,
                     that asks to change  the  destination  IP  address  of  a
                     packet  from  <u>A</u>  to  <u>B</u>, a priority-100 flow matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp;
                     <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>A</u> or  <b>i</b><b>p</b>  &amp;&amp;&amp;&amp;  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>  <u>A</u>  with  an  action
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b> <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>(</b><u>B</u><b>)</b><b>;</b>. If the Gateway router is
                     configured to force SNAT any DNATed packet, the above ac‚Äê
                     tion  will  be replaced by <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b> <b>=</b> <b>1</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b> <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>(</b><u>B</u><b>)</b><b>;</b>. If the NAT  rule  is  of
                     type dnat_and_snat and has <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b> in the options,
                     then the action would be <b>i</b><b>p</b><b>4</b><b>/</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b><b>=</b> <b>(</b><u>B</u><b>)</b>.

                     If  the  NAT  rule  has  <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b> configured, then
                     there is an additional match <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>a</u><u>l</u><u>l</u><u>o</u><u>w</u><u>e</u><u>d</u><b>_</b><u>e</u><u>x</u><u>t</u><b>_</b><u>i</u><u>p</u><u>s</u> .
                     Similarly, for  IPV6,  match  would  be  <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b>  <b>=</b><b>=</b>  <u>a</u><u>l</u><u>‚</u>Äê
                     <u>l</u><u>o</u><u>w</u><u>e</u><u>d</u><b>_</b><u>e</u><u>x</u><u>t</u><b>_</b><u>i</u><u>p</u><u>s</u>.

                     If  the  NAT rule has <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b> set, then there is
                     an additional flow configured at priority 101.  The  flow
                     matches if source ip is an <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b> and the action
                     is <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> . This flow is used to bypass the ct_dnat action
                     for a packet originating from <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b>.

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

       Ingress Table 7: DNAT on Distributed Routers

       On distributed routers, the DNAT table only handles packets with desti‚Äê
       nation IP address that needs to be DNATted from a virtual IP address to
       a  real  IP  address. The unDNAT processing in the reverse direction is
       handled in a separate table in the egress pipeline.

              ‚Ä¢      For each configuration in the  OVN  Northbound  database,
                     that  asks  to  change  the  destination  IP address of a
                     packet from <u>A</u> to <u>B</u>, a priority-100  flow  matches  <b>i</b><b>p</b>  &amp;&amp;&amp;&amp;
                     <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>  <u>B</u>  &amp;&amp;&amp;&amp;  <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u>, where <u>G</u><u>W</u> is the logical
                     router gateway port corresponding to the NAT rule (speci‚Äê
                     fied or inferred), with an action <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>(</b><u>B</u><b>)</b><b>;</b>. The  match
                     will  include  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b> <u>B</u> in the IPv6 case. If the NAT
                     rule is of type dnat_and_snat and has  <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b>  in
                     the options, then the action would be <b>i</b><b>p</b><b>4</b><b>/</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b><b>=</b><b>(</b><u>B</u><b>)</b>.

                     If  the  NAT rule cannot be handled in a distributed man‚Äê
                     ner, then the priority-100 flow above is only  programmed
                     on the gateway chassis.

                     If  the  NAT  rule  has  <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b> configured, then
                     there is an additional match <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>a</u><u>l</u><u>l</u><u>o</u><u>w</u><u>e</u><u>d</u><b>_</b><u>e</u><u>x</u><u>t</u><b>_</b><u>i</u><u>p</u><u>s</u> .
                     Similarly, for  IPV6,  match  would  be  <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b>  <b>=</b><b>=</b>  <u>a</u><u>l</u><u>‚</u>Äê
                     <u>l</u><u>o</u><u>w</u><u>e</u><u>d</u><b>_</b><u>e</u><u>x</u><u>t</u><b>_</b><u>i</u><u>p</u><u>s</u>.

                     If  the  NAT rule has <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b> set, then there is
                     an additional flow configured at priority 101.  The  flow
                     matches if source ip is an <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b> and the action
                     is <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> . This flow is used to bypass the ct_dnat action
                     for a packet originating from <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b>.

                     A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>8</u><u>:</u> <u>L</u><u>o</u><u>a</u><u>d</u> <u>b</u><u>a</u><u>l</u><u>a</u><u>n</u><u>c</u><u>i</u><u>n</u><u>g</u> <u>a</u><u>f</u><u>f</u><u>i</u><u>n</u><u>i</u><u>t</u><u>y</u> <u>l</u><u>e</u><u>a</u><u>r</u><u>n</u>

       Load  balancing  affinity  learn  table  contains the following logical
       flows:

              ‚Ä¢      For all the configured load balancing rules for a logical
                     router where a positive affinity timeout <u>T</u>  is  specified
                     in <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>
                      column,  that  includes a L4 port <u>P</u><u>O</u><u>R</u><u>T</u> of protocol <u>P</u> and
                     IPv4 or  IPv6  address  <u>V</u><u>I</u><u>P</u>,  a  priority-100  flow  that
                     matches on <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>6</b><b>]</b> <b>=</b><b>=</b> <b>0</b> &amp;&amp;&amp;&amp; <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u> &amp;&amp;&amp;&amp;
                     <u>P</u>  &amp;&amp;&amp;&amp;  <b>r</b><b>e</b><b>g</b><b>9</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b>  <b>=</b><b>=</b>  <u>P</u><u>O</u><u>R</u><u>T</u> (<b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b><b>=</b> <u>V</u><u>I</u><u>P</u>  in the IPv6
                     case) with an action  of  <b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b><b>_</b><b>l</b><b>b</b><b>_</b><b>a</b><b>f</b><b>f</b><b>(</b><b>v</b><b>i</b><b>p</b>  <b>=</b>  <u>V</u><u>I</u><u>P</u><b>:</b><u>P</u><u>O</u><u>R</u><u>T</u><b>,</b>
                     <b>b</b><b>a</b><b>c</b><b>k</b><b>e</b><b>n</b><b>d</b>  <b>=</b> <u>b</u><u>a</u><u>c</u><u>k</u><u>e</u><u>n</u><u>d</u> <u>i</u><u>p</u><b>:</b> <u>b</u><u>a</u><u>c</u><u>k</u><u>e</u><u>n</u><u>d</u> <u>p</u><u>o</u><u>r</u><u>t</u><b>,</b> <b>p</b><b>r</b><b>o</b><b>t</b><b>o</b> <b>=</b> <u>P</u><b>,</b> <b>t</b><b>i</b><b>m</b><b>e</b><b>o</b><b>u</b><b>t</b> <b>=</b>
                     <u>T</u><b>)</b><b>;</b>.

              ‚Ä¢      A priority 0 flow is added which matches on  all  packets
                     and applies the action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>9</u><u>:</u> <u>E</u><u>C</u><u>M</u><u>P</u> <u>s</u><u>y</u><u>m</u><u>m</u><u>e</u><u>t</u><u>r</u><u>i</u><u>c</u> <u>r</u><u>e</u><u>p</u><u>l</u><u>y</u> <u>p</u><u>r</u><u>o</u><u>c</u><u>e</u><u>s</u><u>s</u><u>i</u><u>n</u><u>g</u>

              ‚Ä¢      If ECMP routes with symmetric reply are configured in the
                     <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database  for  a gateway router, a prior‚Äê
                     ity-100 flow is added for each router port on which  sym‚Äê
                     metric  replies  are  configured.  The matching logic for
                     these ports essentially reverses the configured logic  of
                     the  ECMP route. So for instance, a route with a destina‚Äê
                     tion routing policy will instead match if the  source  IP
                     address  matches the static route‚Äôs prefix. The flow uses
                     the  action   <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b>   <b>{</b>   <b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b><b>.</b><b>e</b><b>c</b><b>m</b><b>p</b><b>_</b><b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>_</b><b>e</b><b>t</b><b>h</b>   <b>=</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b><b>"</b>   <b>"</b>   <b>c</b><b>t</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>.</b><b>e</b><b>c</b><b>m</b><b>p</b><b>_</b><b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b>   <b>=</b>   <u>K</u><b>;</b><b>}</b><b>;</b>   <b>c</b><b>o</b><b>m</b>‚Äê‚Äê
                     <b>m</b><b>i</b><b>t</b><b>_</b><b>e</b><b>c</b><b>m</b><b>p</b><b>_</b><b>n</b><b>h</b><b>(</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>
                      to commit the connection and  storing  <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b>  and  the
                     ECMP  reply port binding tunnel key <u>K</u> in the <b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b> and
                     the traffic pattern to table <b>7</b><b>6</b> or <b>7</b><b>7</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>0</u><u>:</u> <u>I</u><u>P</u><u>v</u><u>6</u> <u>N</u><u>D</u> <u>R</u><u>A</u> <u>o</u><u>p</u><u>t</u><u>i</u><u>o</u><u>n</u> <u>p</u><u>r</u><u>o</u><u>c</u><u>e</u><u>s</u><u>s</u><u>i</u><u>n</u><u>g</u>

              ‚Ä¢      A priority-50 logical flow  is  added  for  each  logical
                     router  port  configured  with  IPv6  ND RA options which
                     matches IPv6 ND Router Solicitation  packet  and  applies
                     the  action <b>p</b><b>u</b><b>t</b><b>_</b><b>n</b><b>d</b><b>_</b><b>r</b><b>a</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b> and advances the packet to the
                     next table.

                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>5</b><b>]</b> <b>=</b> <b>p</b><b>u</b><b>t</b><b>_</b><b>n</b><b>d</b><b>_</b><b>r</b><b>a</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b><b>(</b><u>o</u><u>p</u><u>t</u><u>i</u><u>o</u><u>n</u><u>s</u>);next;


                     For a valid IPv6 ND RS packet, this transforms the packet
                     into an IPv6 ND RA reply and sets the RA options  to  the
                     packet  and  stores  1  into  reg0[5]. For other kinds of
                     packets, it just stores 0 into reg0[5].  Either  way,  it
                     continues to the next table.

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>1</u><u>:</u> <u>I</u><u>P</u><u>v</u><u>6</u> <u>N</u><u>D</u> <u>R</u><u>A</u> <u>r</u><u>e</u><u>s</u><u>p</u><u>o</u><u>n</u><u>d</u><u>e</u><u>r</u>

       This  table  implements IPv6 ND RA responder for the IPv6 ND RA replies
       generated by the previous table.

              ‚Ä¢      A priority-50 logical flow  is  added  for  each  logical
                     router  port  configured  with  IPv6  ND RA options which
                     matches IPv6 ND RA packets and <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>5</b><b>]</b> <b>=</b><b>=</b> <b>1</b> and  responds
                     back  to  the  <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b>  after  applying  these actions. If
                     <b>r</b><b>e</b><b>g</b><b>0</b><b>[</b><b>5</b><b>]</b>  is  set  to  1,  it  means   that   the   action
                     <b>p</b><b>u</b><b>t</b><b>_</b><b>n</b><b>d</b><b>_</b><b>r</b><b>a</b><b>_</b><b>o</b><b>p</b><b>t</b><b>s</b> was successful.

                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
                     <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>I</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>P</u>;
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>


                     where  <u>E</u>  is the MAC address and <u>I</u> is the IPv6 link local
                     address of the logical router port.

                     (This terminates packet processing in  ingress  pipeline;
                     the packet does not go to the next ingress table.)

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>2</u><u>:</u> <u>I</u><u>P</u> <u>R</u><u>o</u><u>u</u><u>t</u><u>i</u><u>n</u><u>g</u> <u>P</u><u>r</u><u>e</u>

       If  a packet arrived at this table from Logical Router Port <u>P</u> which has
       <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>_</b><b>t</b><b>a</b><b>b</b><b>l</b><b>e</b> value set, a logical flow with match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b>  <b>"</b><u>P</u><b>"</b>
       with  priority  100  and  action  setting unique-generated per-datapath
       32-bit value (non-zero) in OVS register 7.  This  register‚Äôs  value  is
       checked  in  next  table.  If packet didn‚Äôt match any configured inport
       (<u><</u>lt;<u>m</u><u>a</u><u>i</u><u>n</u><u>></u>gt; route table), register 7 value is set to 0.

       This table contains the following logical flows:

              ‚Ä¢      Priority-100 flow with match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b>  <b>"</b><b>L</b><b>R</b><b>P</b><b>_</b><b>N</b><b>A</b><b>M</b><b>E</b><b>"</b>  value
                     and action, which set route table identifier in reg7.

                     A priority-0 logical flow with match <b>1</b> has actions <b>r</b><b>e</b><b>g</b><b>7</b> <b>=</b>
                     <b>0</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>3</u><u>:</u> <u>I</u><u>P</u> <u>R</u><u>o</u><u>u</u><u>t</u><u>i</u><u>n</u><u>g</u>

       A  packet  that  arrives  at  this table is an IP packet that should be
       routed to the address in <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> or <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>. This table  implements  IP
       routing,  setting  <b>r</b><b>e</b><b>g</b><b>0</b> (or <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> for IPv6) to the next-hop IP address
       (leaving <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> or <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>, the packet‚Äôs final destination, unchanged)
       and advances to the next table for ARP resolution. It  also  sets  <b>r</b><b>e</b><b>g</b><b>1</b>
       (or  <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b>)  to  the  IP  address  owned  by  the selected router port
       (ingress table <b>A</b><b>R</b><b>P</b> <b>R</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> will generate an  ARP  request,  if  needed,
       with  <b>r</b><b>e</b><b>g</b><b>0</b> as the target protocol address and <b>r</b><b>e</b><b>g</b><b>1</b> as the source proto‚Äê
       col address).

       For ECMP routes, i.e. multiple static routes with same policy and  pre‚Äê
       fix  but different nexthops, the above actions are deferred to next ta‚Äê
       ble. This table, instead, is responsible for determine the  ECMP  group
       id and select a member id within the group based on 5-tuple hashing. It
       stores group id in <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> and member id in <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b>. This step
       is skipped with a priority-10300 rule if the traffic going out the ECMP
       route  is  reply traffic, and the ECMP route was configured to use sym‚Äê
       metric replies. Instead, the stored values  in  conntrack  is  used  to
       choose  the destination. The <b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b><b>.</b><b>e</b><b>c</b><b>m</b><b>p</b><b>_</b><b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>_</b><b>e</b><b>t</b><b>h</b> tells the destina‚Äê
       tion  MAC  address  to  which  the   packet   should   be   sent.   The
       <b>c</b><b>t</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>.</b><b>e</b><b>c</b><b>m</b><b>p</b><b>_</b><b>r</b><b>e</b><b>p</b><b>l</b><b>y</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b>  tells  the  logical  router  port on which the
       packet should be sent. These values saved to the conntrack fields  when
       the initial ingress traffic is received over the ECMP route and commit‚Äê
       ted  to  conntrack.  If <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>K</b><b>N</b><b>O</b><b>W</b><b>N</b><b>_</b><b>E</b><b>C</b><b>M</b><b>P</b><b>_</b><b>N</b><b>H</b> is set, the priority-10300
       flows in this stage set the <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>, while the <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> is set by  flows
       at the ARP/ND Resolution stage.

       This table contains the following logical flows:

              ‚Ä¢      Priority-10550  flow  that  drops  IPv6  Router Solicita‚Äê
                     tion/Advertisement packets that  were  not  processed  in
                     previous tables.

              ‚Ä¢      Priority-10550  flows that drop IGMP and MLD packets with
                     source MAC address owned by the router. These are used to
                     prevent looping statically forwarded IGMP and MLD packets
                     for which TTL is not decremented (it is always 1).

              ‚Ä¢      Priority-10500 flows that match IP multicast traffic des‚Äê
                     tined  to  groups  registered  on  any  of  the  attached
                     switches  and  sets  <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>  to the associated multicast
                     group that will eventually flood the traffic to  all  in‚Äê
                     terested attached logical switches. The flows also decre‚Äê
                     ment TTL.

              ‚Ä¢      Priority-10460  flows  that  match  IGMP  and MLD control
                     packets, set <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> to the  <b>M</b><b>C</b><b>_</b><b>S</b><b>T</b><b>A</b><b>T</b><b>I</b><b>C</b>  multicast  group,
                     which  <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>  populates  with the logical ports that
                     have <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b> <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>f</b><b>l</b><b>o</b><b>o</b><b>d</b><b>=</b>‚Äô‚Äô<b>t</b><b>r</b><b>u</b><b>e</b>‚Äô‚Äô. If no router ports  are
                     configured  to  flood  multicast  traffic the packets are
                     dropped.

              ‚Ä¢      Priority-10450 flow that matches unregistered  IP  multi‚Äê
                     cast  traffic  decrements  TTL  and  sets  <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> to the
                     <b>M</b><b>C</b><b>_</b><b>S</b><b>T</b><b>A</b><b>T</b><b>I</b><b>C</b> multicast  group,  which  <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>  populates
                     with    the    logical    ports    that    have   <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>
                     <b>:</b><b>m</b><b>c</b><b>a</b><b>s</b><b>t</b><b>_</b><b>f</b><b>l</b><b>o</b><b>o</b><b>d</b><b>=</b>‚Äô‚Äô<b>t</b><b>r</b><b>u</b><b>e</b>‚Äô‚Äô. If no router ports are configured to
                     flood multicast traffic the packets are dropped.

              ‚Ä¢      IPv4 routing table. For each route to IPv4 network <u>N</u> with
                     netmask <u>M</u>, on router port <u>P</u> with IP address <u>A</u> and  Ether‚Äê
                     net  address <u>E</u>, a logical flow with match <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>N</u><b>/</b><u>M</u>,
                     whose priority is the number of 1-bits in <u>M</u>, has the fol‚Äê
                     lowing actions:

                     <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b><b>-</b><b>-</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b> <b>0</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b> <u>G</u>;
                     <b>r</b><b>e</b><b>g</b><b>1</b> <b>=</b> <u>A</u>;
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>P</u>;
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     (Ingress table 1 already verified that <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b><b>-</b><b>-</b><b>;</b> will not
                     yield a TTL exceeded error.)

                     If the route has a gateway, <u>G</u> is the gateway IP  address.
                     Instead,  if the route is from a configured static route,
                     <u>G</u> is the next hop IP address. Else it is <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b>.

              ‚Ä¢      IPv6 routing table. For each route to IPv6 network <u>N</u> with
                     netmask <u>M</u>, on router port <u>P</u> with IP address <u>A</u> and  Ether‚Äê
                     net address <u>E</u>, a logical flow with match in CIDR notation
                     <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>N</u><b>/</b><u>M</u>, whose priority is the integer value of <u>M</u>,
                     has the following actions:

                     <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b><b>-</b><b>-</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b> <b>0</b><b>;</b>
                     <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b> <u>G</u>;
                     <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b> <b>=</b> <u>A</u>;
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     (Ingress table 1 already verified that <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b><b>-</b><b>-</b><b>;</b> will not
                     yield a TTL exceeded error.)

                     If  the route has a gateway, <u>G</u> is the gateway IP address.
                     Instead, if the route is from a configured static  route,
                     <u>G</u> is the next hop IP address. Else it is <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>.

                     If  the  address  <u>A</u> is in the link-local scope, the route
                     will be limited to sending on the ingress port.

                     For each static route the <b>r</b><b>e</b><b>g</b><b>7</b> <b>=</b><b>=</b> <b>i</b><b>d</b> &amp;&amp;&amp;&amp;  is  prefixed  in
                     logical  flow  match portion. For routes with <b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>_</b><b>t</b><b>a</b><b>b</b><b>l</b><b>e</b>
                     value set a unique non-zero id is used. For routes within
                     <lt;<lt;<b>m</b><b>a</b><b>i</b><b>n</b>>gt;>gt; route table (no route table set), this id value is
                     0.

                     For each <u>c</u><u>o</u><u>n</u><u>n</u><u>e</u><u>c</u><u>t</u><u>e</u><u>d</u> route (route to the LRP‚Äôs subnet CIDR)
                     the logical flow match portion has no <b>r</b><b>e</b><b>g</b><b>7</b> <b>=</b><b>=</b> <b>i</b><b>d</b> &amp;&amp;&amp;&amp;  pre‚Äê
                     fix to have route to LRP‚Äôs subnets in all routing tables.

              ‚Ä¢      For  ECMP  routes, they are grouped by policy and prefix.
                     An unique id (non-zero) is assigned to  each  group,  and
                     each  member  is  also  assigned  an unique id (non-zero)
                     within each group.

                     For each IPv4/IPv6 ECMP group with group id <u>G</u><u>I</u><u>D</u> and  mem‚Äê
                     ber  ids  <u>M</u><u>I</u><u>D</u><u>1</u>,  <u>M</u><u>I</u><u>D</u><u>2</u>,  ..., a logical flow with match in
                     CIDR notation <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>N</u><b>/</b><u>M</u>, or <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>  <u>N</u><b>/</b><u>M</u>,  whose
                     priority is the integer value of <u>M</u>, has the following ac‚Äê
                     tions:

                     <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b><b>-</b><b>-</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b> <u>G</u><u>I</u><u>D</u>;
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b> <b>=</b> <b>s</b><b>e</b><b>l</b><b>e</b><b>c</b><b>t</b><b>(</b><u>M</u><u>I</u><u>D</u><u>1</u>, <u>M</u><u>I</u><u>D</u><u>2</u>, ...);


                     However,  when  there is only one route in an ECMP group,
                     group actions will be:

                     <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b><b>-</b><b>-</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b> <u>G</u><u>I</u><u>D</u>;
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b> <b>=</b> <u>M</u><u>I</u><u>D</u><u>1</u>);


              ‚Ä¢      A priority-0 logical flow that matches  all  packets  not
                     already handled (match <b>1</b>) and drops them (action <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>).

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>4</u><u>:</u> <u>I</u><u>P</u><b>_</b><u>R</u><u>O</u><u>U</u><u>T</u><u>I</u><u>N</u><u>G</u><b>_</b><u>E</u><u>C</u><u>M</u><u>P</u>

       This  table  implements  the  second part of IP routing for ECMP routes
       following the previous table. If a packet matched a ECMP group  in  the
       previous  table,  this  table matches the group id and member id stored
       from the previous table, setting <b>r</b><b>e</b><b>g</b><b>0</b> (or <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> for IPv6) to the next-
       hop IP address (leaving <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> or <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>, the packet‚Äôs final destina‚Äê
       tion, unchanged) and advances to the next table for ARP resolution.  It
       also  sets  <b>r</b><b>e</b><b>g</b><b>1</b>  (or  <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b>)  to the IP address owned by the selected
       router port (ingress table <b>A</b><b>R</b><b>P</b> <b>R</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b> will generate an ARP request, if
       needed, with <b>r</b><b>e</b><b>g</b><b>0</b> as the target protocol address and <b>r</b><b>e</b><b>g</b><b>1</b> as the source
       protocol address).

       This processing is skipped for reply traffic being sent out of an  ECMP
       route if the route was configured to use symmetric replies.

       This table contains the following logical flows:

              ‚Ä¢      A  priority-150  flow  that matches <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b><b>=</b> <b>0</b> with
                     action  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>  directly  bypasses  packets  of   non-ECMP
                     routes.

              ‚Ä¢      For  each  member  with ID <u>M</u><u>I</u><u>D</u> in each ECMP group with ID
                     <u>G</u><u>I</u><u>D</u>, a priority-100 flow with match <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b><b>=</b> <u>G</u><u>I</u><u>D</u> &amp;&amp;&amp;&amp;
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b> <b>=</b><b>=</b> <u>M</u><u>I</u><u>D</u> has following actions:

                     <b>[</b><b>x</b><b>x</b><b>]</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b> <u>G</u>;
                     <b>[</b><b>x</b><b>x</b><b>]</b><b>r</b><b>e</b><b>g</b><b>1</b> <b>=</b> <u>A</u>;
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>P</u>;


              ‚Ä¢      A priority-0 logical flow that matches  all  packets  not
                     already handled (match <b>1</b>) and drops them (action <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>).

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>5</u><u>:</u> <u>R</u><u>o</u><u>u</u><u>t</u><u>e</u><u>r</u> <u>p</u><u>o</u><u>l</u><u>i</u><u>c</u><u>i</u><u>e</u><u>s</u>

       This table adds flows for the logical router policies configured on the
       logical   router.   Please   see   the  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database  <b>L</b><b>o</b><b>g</b><b>i</b>‚Äê‚Äê
       <b>c</b><b>a</b><b>l</b><b>_</b><b>R</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b><b>_</b><b>P</b><b>o</b><b>l</b><b>i</b><b>c</b><b>y</b> table documentation in <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>b</b> for supported actions.

              ‚Ä¢      For each router policy configured on the logical  router,
                     a  logical  flow  is added with specified priority, match
                     and actions.

              ‚Ä¢      If the policy action is <b>r</b><b>e</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b> with 2 or  more  nexthops
                     defined,  then the logical flow is added with the follow‚Äê
                     ing actions:

                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b> <u>G</u><u>I</u><u>D</u>;
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b> <b>=</b> <b>s</b><b>e</b><b>l</b><b>e</b><b>c</b><b>t</b><b>(</b><b>1</b><b>,</b><b>.</b><b>.</b><b>n</b><b>)</b><b>;</b>


                     where <u>G</u><u>I</u><u>D</u> is the ECMP group id  generated  by  <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>
                     for  this  policy and <u>n</u> is the number of nexthops. <b>s</b><b>e</b><b>l</b><b>e</b><b>c</b><b>t</b>
                     action selects one of the nexthop member id, stores it in
                     the register <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b> and advances the packet to  the
                     next stage.

              ‚Ä¢      If  the  policy  action  is <b>r</b><b>e</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b> with just one nexhop,
                     then the logical flow is added  with  the  following  ac‚Äê
                     tions:

                     <b>[</b><b>x</b><b>x</b><b>]</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b> <u>H</u>;
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>P</u>;
                     <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b> <b>0</b><b>;</b>
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>


                     where  <u>H</u>  is the <b>n</b><b>e</b><b>x</b><b>t</b><b>h</b><b>o</b><b>p</b>  defined in the router policy, <u>E</u>
                     is the ethernet address of the logical router  port  from
                     which  the  <b>n</b><b>e</b><b>x</b><b>t</b><b>h</b><b>o</b><b>p</b>  is  reachable  and  <u>P</u> is the logical
                     router port from which the <b>n</b><b>e</b><b>x</b><b>t</b><b>h</b><b>o</b><b>p</b> is reachable.

              ‚Ä¢      If a router policy has the option <b>p</b><b>k</b><b>t</b><b>_</b><b>m</b><b>a</b><b>r</b><b>k</b><b>=</b><u>m</u> set  and  if
                     the  action  is  <b>n</b><b>o</b><b>t</b>  drop, then the action also includes
                     <b>p</b><b>k</b><b>t</b><b>.</b><b>m</b><b>a</b><b>r</b><b>k</b> <b>=</b> <u>m</u> to mark the packet with the marker <u>m</u>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>6</u><u>:</u> <u>E</u><u>C</u><u>M</u><u>P</u> <u>h</u><u>a</u><u>n</u><u>d</u><u>l</u><u>i</u><u>n</u><u>g</u> <u>f</u><u>o</u><u>r</u> <u>r</u><u>o</u><u>u</u><u>t</u><u>e</u><u>r</u> <u>p</u><u>o</u><u>l</u><u>i</u><u>c</u><u>i</u><u>e</u><u>s</u>

       This table handles the ECMP for the  router  policies  configured  with
       multiple nexthops.

              ‚Ä¢      A priority-150 flow is added to advance the packet to the
                     next  stage  if the ECMP group id register <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> is
                     0.

              ‚Ä¢      For each ECMP reroute router policy  with  multiple  nex‚Äê
                     thops,  a  priority-100  flow is added for each nexthop <u>H</u>
                     with the match <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>0</b><b>.</b><b>.</b><b>1</b><b>5</b><b>]</b> <b>=</b><b>=</b> <u>G</u><u>I</u><u>D</u> &amp;&amp;&amp;&amp;  <b>r</b><b>e</b><b>g</b><b>8</b><b>[</b><b>1</b><b>6</b><b>.</b><b>.</b><b>3</b><b>1</b><b>]</b>  <b>=</b><b>=</b>  <u>M</u>
                     where  <u>G</u><u>I</u><u>D</u>  is  the  router  policy group id generated by
                     <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b> and <u>M</u> is the member id of the nexthop <u>H</u> gener‚Äê
                     ated by <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>. The following actions  are  added  to
                     the flow:

                     <b>[</b><b>x</b><b>x</b><b>]</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b> <u>H</u>;
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u>;
                     <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>P</u>
                     <b>"</b><b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b> <b>"</b>
                     <b>"</b><b>n</b><b>e</b><b>x</b><b>t</b><b>;</b><b>"</b>


                     where  <u>H</u>  is the <b>n</b><b>e</b><b>x</b><b>t</b><b>h</b><b>o</b><b>p</b>  defined in the router policy, <u>E</u>
                     is the ethernet address of the logical router  port  from
                     which  the  <b>n</b><b>e</b><b>x</b><b>t</b><b>h</b><b>o</b><b>p</b>  is  reachable  and  <u>P</u> is the logical
                     router port from which the <b>n</b><b>e</b><b>x</b><b>t</b><b>h</b><b>o</b><b>p</b> is reachable.

              ‚Ä¢      A priority-0 logical flow that matches  all  packets  not
                     already handled (match <b>1</b>) and drops them (action <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>).

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>7</u><u>:</u> <u>A</u><u>R</u><u>P</u><u>/</u><u>N</u><u>D</u> <u>R</u><u>e</u><u>s</u><u>o</u><u>l</u><u>u</u><u>t</u><u>i</u><u>o</u><u>n</u>

       Any  packet that reaches this table is an IP packet whose next-hop IPv4
       address is in <b>r</b><b>e</b><b>g</b><b>0</b> or IPv6 address is in <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b>.  (<b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b>  or  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>
       contains  the final destination.) This table resolves the IP address in
       <b>r</b><b>e</b><b>g</b><b>0</b> (or <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b>) into an output port in <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> and an Ethernet address
       in <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b>, using the following flows:

              ‚Ä¢      A priority-500 flow that  matches  IP  multicast  traffic
                     that  was  allowed in the routing pipeline. For this kind
                     of traffic the <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> was already set so the  flow  just
                     advances to the next table.

              ‚Ä¢      Priority-200  flows that match ECMP reply traffic for the
                     routes configured to use symmetric replies, with  actions
                     <b>p</b><b>u</b><b>s</b><b>h</b><b>(</b><b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b><b>)</b><b>;</b>    <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b>    <b>=</b>    <b>c</b><b>t</b><b>_</b><b>l</b><b>a</b><b>b</b><b>e</b><b>l</b><b>;</b>    <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b>    <b>=</b>
                     <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b><b>[</b><b>3</b><b>2</b><b>.</b><b>.</b><b>7</b><b>9</b><b>]</b><b>;</b> <b>p</b><b>o</b><b>p</b><b>(</b><b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>. <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>1</b> is  used  here
                     to  avoid masked access to ct_label, to make the flow HW-
                     offloading friendly.

              ‚Ä¢      Static MAC bindings. MAC bindings can be known statically
                     based on data in the <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b> database. For  router
                     ports  connected to logical switches, MAC bindings can be
                     known statically from the <b>a</b><b>d</b><b>d</b><b>r</b><b>e</b><b>s</b><b>s</b><b>e</b><b>s</b> column in  the  <b>L</b><b>o</b><b>g</b><b>i</b>‚Äê‚Äê
                     <b>c</b><b>a</b><b>l</b><b>_</b><b>S</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b>  table.  (Note: the flow is not installed
                     for IPs of logical switch ports of type <b>v</b><b>i</b><b>r</b><b>t</b><b>u</b><b>a</b><b>l</b>, and  dy‚Äê
                     namic  MAC binding is used for those IPs instead, so that
                     virtual parent failover does not depend on <b>o</b><b>v</b><b>n</b><b>-</b><b>n</b><b>o</b><b>r</b><b>t</b><b>h</b><b>d</b>, to
                     achieve better failover performance.)  For  router  ports
                     connected  to  other logical routers, MAC bindings can be
                     known statically from the <b>m</b><b>a</b><b>c</b> and <b>n</b><b>e</b><b>t</b><b>w</b><b>o</b><b>r</b><b>k</b><b>s</b> column in  the
                     <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>R</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b>  table.  (Note:  the  flow is NOT in‚Äê
                     stalled for the IP addresses that belong  to  a  neighbor
                     logical  router  port  if  the current router has the <b>o</b><b>p</b>‚Äê‚Äê
                     <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>d</b><b>y</b><b>n</b><b>a</b><b>m</b><b>i</b><b>c</b><b>_</b><b>n</b><b>e</b><b>i</b><b>g</b><b>h</b><b>_</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b><b>s</b> set to <b>t</b><b>r</b><b>u</b><b>e</b>)

                     For each IPv4 address <u>A</u> whose host is known to have  Eth‚Äê
                     ernet  address  <u>E</u>  on  router port <u>P</u>, a priority-100 flow
                     with match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b><b>=</b> <u>A</u> has actions <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b>
                     <b>=</b> <u>E</u><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     For each IPv6 address <u>A</u> whose host is known to have  Eth‚Äê
                     ernet  address  <u>E</u>  on  router port <u>P</u>, a priority-100 flow
                     with match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b><b>=</b> <u>P</u>  &amp;&amp;&amp;&amp;  <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b>  <b>=</b><b>=</b>  <u>A</u>  has  actions
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     For each logical router port with an IPv4 address <u>A</u> and a
                     mac  address of <u>E</u> that is reachable via a different logi‚Äê
                     cal router port <u>P</u>, a priority-100 flow with match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>
                     <b>=</b><b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b><b>=</b> <u>A</u> has actions <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     For each logical router port with an IPv6 address <u>A</u> and a
                     mac address of <u>E</u> that is reachable via a different  logi‚Äê
                     cal router port <u>P</u>, a priority-100 flow with match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>
                     <b>=</b><b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b><b>=</b> <u>A</u> has actions <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

              ‚Ä¢      Static  MAC  bindings  from NAT entries. MAC bindings can
                     also be known for the entries in  the  <b>N</b><b>A</b><b>T</b>  table.  Below
                     flows  are programmed for distributed logical routers i.e
                     with a distributed router port.

                     For each row in the <b>N</b><b>A</b><b>T</b> table with IPv4 address <u>A</u> in  the
                     <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b><b>_</b><b>i</b><b>p</b> column of <b>N</b><b>A</b><b>T</b> table, below two flows are pro‚Äê
                     grammed:

                     A  priority-100  flow with the match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>r</b><b>e</b><b>g</b><b>0</b>
                     <b>=</b><b>=</b> <u>A</u> has actions <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>, where <b>P</b> is the  dis‚Äê
                     tributed  logical  router port, <u>E</u> is the Ethernet address
                     if set in the <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b><b>n</b><b>a</b><b>l</b><b>_</b><b>m</b><b>a</b><b>c</b> column of  <b>N</b><b>A</b><b>T</b>  table  for  of
                     type <b>d</b><b>n</b><b>a</b><b>t</b><b>_</b><b>a</b><b>n</b><b>d</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b>, otherwise the Ethernet address of the
                     distributed  logical router port. Note that if the <b>e</b><b>x</b><b>t</b><b>e</b><b>r</b>‚Äê‚Äê
                     <b>n</b><b>a</b><b>l</b><b>_</b><b>i</b><b>p</b> is not within  a  subnet  on  the  owning  logical
                     router, then OVN will only create ARP resolution flows if
                     the  <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>a</b><b>d</b><b>d</b><b>_</b><b>r</b><b>o</b><b>u</b><b>t</b><b>e</b>  is set to <b>t</b><b>r</b><b>u</b><b>e</b>. Otherwise, no ARP
                     resolution flows will be added.

                     Corresponding to the above flow, a priority-150 flow with
                     the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>A</u> has
                     actions <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b> to exclude packets that have  gone  through
                     DNAT/unSNAT  stage but failed to convert the destination,
                     to avoid loop.

                     For IPv6 NAT entries, same flows are added, but using the
                     register <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> and field <b>i</b><b>p</b><b>6</b> for the match.

              ‚Ä¢      If the router datapath runs a port with <b>r</b><b>e</b><b>d</b><b>i</b><b>r</b><b>e</b><b>c</b><b>t</b><b>-</b><b>t</b><b>y</b><b>p</b><b>e</b> set
                     to <b>b</b><b>r</b><b>i</b><b>d</b><b>g</b><b>e</b><b>d</b>, for each distributed NAT rule with  IP  <u>A</u>  in
                     the  <b>l</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>i</b><b>p</b>  column  and  logical port <u>P</u> in the <b>l</b><b>o</b><b>g</b><b>i</b>‚Äê‚Äê
                     <b>c</b><b>a</b><b>l</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b> column of <b>N</b><b>A</b><b>T</b> table, a priority-90 flow with the
                     match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>Q</u> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b><b>=</b>  <u>A</u>  &amp;&amp;&amp;&amp;  <b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b>‚Äê‚Äê
                     <b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><u>P</u><b>)</b>,  where  <b>Q</b> is the distributed logical router port
                     and action <b>g</b><b>e</b><b>t</b><b>_</b><b>a</b><b>r</b><b>p</b><b>(</b><b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>r</b><b>e</b><b>g</b><b>0</b><b>)</b><b>;</b>  <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>  for  IPv4  and
                     <b>g</b><b>e</b><b>t</b><b>_</b><b>n</b><b>d</b><b>(</b><b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> for IPv6.

              ‚Ä¢      Traffic  with  IP  destination  an  address  owned by the
                     router  should  be  dropped.  Such  traffic  is  normally
                     dropped in ingress table <b>I</b><b>P</b> <b>I</b><b>n</b><b>p</b><b>u</b><b>t</b> except for IPs that are
                     also shared with SNAT rules. However, if there was no un‚Äê
                     SNAT  operation  that  happened  successfully  until this
                     point in the pipeline  and  the  destination  IP  of  the
                     packet  is  still  a  router owned IP, the packets can be
                     safely dropped.

                     A priority-2 logical  flow  with  match  <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b>  <b>{</b><b>.</b><b>.</b><b>}</b>
                     matches  on  traffic  destined  to  router owned IPv4 ad‚Äê
                     dresses which are also SNAT IPs.  This  flow  has  action
                     <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>.

                     A  priority-2  logical  flow  with  match  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>{</b><b>.</b><b>.</b><b>}</b>
                     matches on traffic destined  to  router  owned  IPv6  ad‚Äê
                     dresses  which  are  also  SNAT IPs. This flow has action
                     <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>.

                     A priority-0 logical that flow matches  all  packets  not
                     already handled (match <b>1</b>) and drops them (action <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>).

              ‚Ä¢      Dynamic MAC bindings. These flows resolve MAC-to-IP bind‚Äê
                     ings  that  have  become known dynamically through ARP or
                     neighbor discovery. (The ingress table <b>A</b><b>R</b><b>P</b>  <b>R</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b>  will
                     issue  an  ARP or neighbor solicitation request for cases
                     where the binding is not yet known.)

                     A priority-0 logical flow  with  match  <b>i</b><b>p</b><b>4</b>  has  actions
                     <b>g</b><b>e</b><b>t</b><b>_</b><b>a</b><b>r</b><b>p</b><b>(</b><b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>r</b><b>e</b><b>g</b><b>0</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     A  priority-0  logical  flow  with  match <b>i</b><b>p</b><b>6</b> has actions
                     <b>g</b><b>e</b><b>t</b><b>_</b><b>n</b><b>d</b><b>(</b><b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b><b>,</b> <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>)</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

              ‚Ä¢      For a distributed gateway LRP with <b>r</b><b>e</b><b>d</b><b>i</b><b>r</b><b>e</b><b>c</b><b>t</b><b>-</b><b>t</b><b>y</b><b>p</b><b>e</b>  set  to
                     <b>b</b><b>r</b><b>i</b><b>d</b><b>g</b><b>e</b><b>d</b>,   a  priority-50  flow  will  match  <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>  <b>=</b><b>=</b>
                     <b>"</b><b>R</b><b>O</b><b>U</b><b>T</b><b>E</b><b>R</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>"</b> <b>a</b><b>n</b><b>d</b> <b>!</b><b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b><b>d</b><b>e</b><b>n</b><b>t</b> <b>(</b><b>"</b><b>c</b><b>r</b><b>-</b><b>R</b><b>O</b><b>U</b><b>T</b><b>E</b><b>R</b><b>_</b><b>P</b><b>O</b><b>R</b><b>T</b><b>"</b><b>)</b>
                     has actions <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>, where <u>E</u> is  the  ethernet
                     address of the logical router port.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>8</u><u>:</u> <u>C</u><u>h</u><u>e</u><u>c</u><u>k</u> <u>p</u><u>a</u><u>c</u><u>k</u><u>e</u><u>t</u> <u>l</u><u>e</u><u>n</u><u>g</u><u>t</u><u>h</u>

       For  distributed  logical  routers or gateway routers with gateway port
       configured with <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b> to a valid integer value, this  ta‚Äê
       ble  adds  a priority-50 logical flow with the match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u><b>_</b><u>P</u><u>O</u><u>R</u><u>T</u>
       where <u>G</u><u>W</u><b>_</b><u>P</u><u>O</u><u>R</u><u>T</u> is  the  gateway  router  port  and  applies  the  action
       <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>p</b><b>k</b><b>t</b><b>_</b><b>l</b><b>a</b><b>r</b><b>g</b><b>e</b><b>r</b> and advances the packet to the next table.

       <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> <b>=</b> <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>p</b><b>k</b><b>t</b><b>_</b><b>l</b><b>a</b><b>r</b><b>g</b><b>e</b><b>r</b><b>(</b><u>L</u>); next;


       where <u>L</u> is the packet length to check for. If the packet is larger than
       <u>L</u>, it stores 1 in the register bit <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b>. The value of <u>L</u> is
       taken from <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b> column of <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>R</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b> row.

       If the port is also configured with <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b><b>_</b><b>b</b><b>y</b><b>p</b><b>a</b><b>s</b><b>s</b> then an‚Äê
       other  flow  is added, with priority-55, to bypass the <b>c</b><b>h</b><b>e</b><b>c</b><b>k</b><b>_</b><b>p</b><b>k</b><b>t</b><b>_</b><b>l</b><b>a</b><b>r</b><b>g</b><b>e</b><b>r</b>
       flow.

       This table adds one priority-0 fallback flow that matches  all  packets
       and advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>9</u><u>:</u> <u>H</u><u>a</u><u>n</u><u>d</u><u>l</u><u>e</u> <u>l</u><u>a</u><u>r</u><u>g</u><u>e</u><u>r</u> <u>p</u><u>a</u><u>c</u><u>k</u><u>e</u><u>t</u><u>s</u>

       For  distributed  logical  routers or gateway routers with gateway port
       configured with <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b> to a valid integer value, this  ta‚Äê
       ble  adds  the  following  priority-150  logical  flow for each logical
       router port with the match <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>L</u><u>R</u><u>P</u> &amp;&amp;&amp;&amp; <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u><b>_</b><u>P</u><u>O</u><u>R</u><u>T</u> &amp;&amp;&amp;&amp;  <b>R</b><b>E</b><b>G</b>‚Äê‚Äê
       <b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b>  &amp;&amp;&amp;&amp;  <b>!</b><b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b>,  where  <u>L</u><u>R</u><u>P</u> is the logical
       router port and <u>G</u><u>W</u><b>_</b><u>P</u><u>O</u><u>R</u><u>T</u> is the gateway port and applies  the  following
       action for ipv4 and ipv6 respectively:

       <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b> <b>{</b>
           <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>3</b><b>;</b> <b>/</b><b>*</b> <b>D</b><b>e</b><b>s</b><b>t</b><b>i</b><b>n</b><b>a</b><b>t</b><b>i</b><b>o</b><b>n</b> <b>U</b><b>n</b><b>r</b><b>e</b><b>a</b><b>c</b><b>h</b><b>a</b><b>b</b><b>l</b><b>e</b><b>.</b> <b>*</b><b>/</b>
           <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b> <b>4</b><b>;</b>  <b>/</b><b>*</b> <b>F</b><b>r</b><b>a</b><b>g</b> <b>N</b><b>e</b><b>e</b><b>d</b><b>e</b><b>d</b> <b>a</b><b>n</b><b>d</b> <b>D</b><b>F</b> <b>w</b><b>a</b><b>s</b> <b>S</b><b>e</b><b>t</b><b>.</b> <b>*</b><b>/</b>
           <b>i</b><b>c</b><b>m</b><b>p</b><b>4</b><b>.</b><b>f</b><b>r</b><b>a</b><b>g</b><b>_</b><b>m</b><b>t</b><b>u</b> <b>=</b> <u>M</u>;
           <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u>;
           <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
           <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>I</u>;
           <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>5</b><b>;</b>
           <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> <b>=</b> <b>1</b><b>;</b>
           <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> <b>=</b> <b>0</b><b>;</b>
           <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>i</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b> <b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>=</b><b>0</b><b>)</b><b>;</b>
       <b>}</b><b>;</b>
       <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b> <b>{</b>
           <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>t</b><b>y</b><b>p</b><b>e</b> <b>=</b> <b>2</b><b>;</b>
           <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>c</b><b>o</b><b>d</b><b>e</b> <b>=</b> <b>0</b><b>;</b>
           <b>i</b><b>c</b><b>m</b><b>p</b><b>6</b><b>.</b><b>f</b><b>r</b><b>a</b><b>g</b><b>_</b><b>m</b><b>t</b><b>u</b> <b>=</b> <u>M</u>;
           <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u>;
           <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>;</b>
           <b>i</b><b>p</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>I</u>;
           <b>i</b><b>p</b><b>.</b><b>t</b><b>t</b><b>l</b> <b>=</b> <b>2</b><b>5</b><b>5</b><b>;</b>
           <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> <b>=</b> <b>1</b><b>;</b>
           <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>P</b><b>K</b><b>T</b><b>_</b><b>L</b><b>A</b><b>R</b><b>G</b><b>E</b><b>R</b> <b>=</b> <b>0</b><b>;</b>
           <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>i</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b> <b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>=</b><b>0</b><b>)</b><b>;</b>
       <b>}</b><b>;</b>


              ‚Ä¢      Where  <u>M</u>  is the (fragment MTU - 58) whose value is taken
                     from <b>o</b><b>p</b><b>t</b><b>i</b><b>o</b><b>n</b><b>s</b><b>:</b><b>g</b><b>a</b><b>t</b><b>e</b><b>w</b><b>a</b><b>y</b><b>_</b><b>m</b><b>t</b><b>u</b>  column  of  <b>L</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>R</b><b>o</b><b>u</b><b>t</b><b>e</b><b>r</b><b>_</b><b>P</b><b>o</b><b>r</b><b>t</b>
                     row.

              ‚Ä¢      <u>E</u> is the Ethernet address of the logical router port.

              ‚Ä¢      <u>I</u> is the IPv4/IPv6 address of the logical router port.

       This  table  adds one priority-0 fallback flow that matches all packets
       and advances to the next table.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>0</u><u>:</u> <u>G</u><u>a</u><u>t</u><u>e</u><u>w</u><u>a</u><u>y</u> <u>R</u><u>e</u><u>d</u><u>i</u><u>r</u><u>e</u><u>c</u><u>t</u>

       For distributed logical routers where one or more of the logical router
       ports specifies a gateway chassis, this table redirects certain packets
       to the distributed gateway port instances  on  the  gateway  chassises.
       This table has the following flows:

              ‚Ä¢      For each NAT rule in the OVN Northbound database that can
                     be  handled in a distributed manner, a priority-100 logi‚Äê
                     cal flow with match <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>B</u>  &amp;&amp;&amp;&amp;  <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>  <b>=</b><b>=</b>  <u>G</u><u>W</u>  &amp;&amp;
                     is_chassis_resident(<u>P</u>), where <u>G</u><u>W</u> is the distributed gate‚Äê
                     way port specified in the NAT rule and <u>P</u> is the NAT logi‚Äê
                     cal port. IP traffic matching the above rule will be man‚Äê
                     aged  locally setting <b>r</b><b>e</b><b>g</b><b>1</b> to <u>C</u> and <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> to <u>D</u>, where <u>C</u>
                     is NAT external ip and <u>D</u> is NAT external mac.

              ‚Ä¢      For each <b>d</b><b>n</b><b>a</b><b>t</b><b>_</b><b>a</b><b>n</b><b>d</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> NAT rule with  <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b>  and
                     <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b>  configured,  a  priority-75 flow is pro‚Äê
                     grammed with match <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>B</u> and action <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b>  <u>C</u><u>R</u><b>;</b>
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>  where  <u>B</u> is the NAT rule external IP and <u>C</u><u>R</u> is the
                     <b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>r</b><b>e</b><b>d</b><b>i</b><b>r</b><b>e</b><b>c</b><b>t</b> port representing  the  instance  of  the
                     logical  router  distributed  gateway port on the gateway
                     chassis. Moreover a priority-70 flow is  programmed  with
                     same  match  and action <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>. For each <b>d</b><b>n</b><b>a</b><b>t</b><b>_</b><b>a</b><b>n</b><b>d</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b> NAT
                     rule with <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b> and <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b> configured,
                     a priority-75 flow is programmed with match <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b>  <u>B</u>
                     and  action  <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b> where <u>B</u> is the NAT rule external IP. A
                     similar flow is added for IPv6 traffic.

              ‚Ä¢      For each NAT rule in the OVN Northbound database that can
                     be handled in a distributed manner, a priority-80 logical
                     flow with drop action if the NAT logical port is  a  vir‚Äê
                     tual port not claimed by any chassis yet.

              ‚Ä¢      A  priority-50  logical flow with match <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u> has
                     actions <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <u>C</u><u>R</u><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>,  where  <u>G</u><u>W</u>  is  the  logical
                     router  distributed  gateway  port  and  <u>C</u><u>R</u>  is the <b>c</b><b>h</b><b>a</b><b>s</b>‚Äê‚Äê
                     <b>s</b><b>i</b><b>s</b><b>r</b><b>e</b><b>d</b><b>i</b><b>r</b><b>e</b><b>c</b><b>t</b> port representing the instance of the logical
                     router distributed gateway port on the gateway chassis.

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>I</u><u>n</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>1</u><u>:</u> <u>A</u><u>R</u><u>P</u> <u>R</u><u>e</u><u>q</u><u>u</u><u>e</u><u>s</u><u>t</u>

       In the common case where the Ethernet destination  has  been  resolved,
       this  table outputs the packet. Otherwise, it composes and sends an ARP
       or IPv6 Neighbor Solicitation request. It holds the following flows:

              ‚Ä¢      Unknown MAC address. A priority-100 flow for IPv4 packets
                     with match <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b> has the following
                     actions:

                     <b>a</b><b>r</b><b>p</b> <b>{</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <b>f</b><b>f</b><b>:</b><b>f</b><b>f</b><b>:</b><b>f</b><b>f</b><b>:</b><b>f</b><b>f</b><b>:</b><b>f</b><b>f</b><b>:</b><b>f</b><b>f</b><b>;</b>
                         <b>a</b><b>r</b><b>p</b><b>.</b><b>s</b><b>p</b><b>a</b> <b>=</b> <b>r</b><b>e</b><b>g</b><b>1</b><b>;</b>
                         <b>a</b><b>r</b><b>p</b><b>.</b><b>t</b><b>p</b><b>a</b> <b>=</b> <b>r</b><b>e</b><b>g</b><b>0</b><b>;</b>
                         <b>a</b><b>r</b><b>p</b><b>.</b><b>o</b><b>p</b> <b>=</b> <b>1</b><b>;</b>  <b>/</b><b>*</b> <b>A</b><b>R</b><b>P</b> <b>r</b><b>e</b><b>q</b><b>u</b><b>e</b><b>s</b><b>t</b><b>.</b> <b>*</b><b>/</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


                     Unknown MAC address. For each IPv6 static  route  associ‚Äê
                     ated  with  the  router  with the nexthop IP: <u>G</u>, a prior‚Äê
                     ity-200 flow for  IPv6  packets  with  match  <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>
                     <b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b>  &amp;&amp;&amp;&amp;  <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b><b>=</b> <u>G</u> with the following ac‚Äê
                     tions is added:

                     <b>n</b><b>d</b><b>_</b><b>n</b><b>s</b> <b>{</b>
                         <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>E</u>;
                         <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b> <u>I</u>
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b> <u>G</u>;
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


                     Where <u>E</u> is the multicast mac derived from the Gateway IP,
                     <u>I</u> is the solicited-node multicast  address  corresponding
                     to the target address <u>G</u>.

                     Unknown MAC address. A priority-100 flow for IPv6 packets
                     with match <b>e</b><b>t</b><b>h</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b><b>:</b><b>0</b><b>0</b> has the following
                     actions:

                     <b>n</b><b>d</b><b>_</b><b>n</b><b>s</b> <b>{</b>
                         <b>n</b><b>d</b><b>.</b><b>t</b><b>a</b><b>r</b><b>g</b><b>e</b><b>t</b> <b>=</b> <b>x</b><b>x</b><b>r</b><b>e</b><b>g</b><b>0</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>
                     <b>}</b><b>;</b>


                     (Ingress  table  <b>I</b><b>P</b>  <b>R</b><b>o</b><b>u</b><b>t</b><b>i</b><b>n</b><b>g</b> initialized <b>r</b><b>e</b><b>g</b><b>1</b> with the IP
                     address owned by <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> and <b>(</b><b>x</b><b>x</b><b>)</b><b>r</b><b>e</b><b>g</b><b>0</b> with  the  next-hop
                     IP address)

                     The  IP  packet  that triggers the ARP/IPv6 NS request is
                     dropped.

              ‚Ä¢      Known MAC address. A priority-0 flow with match <b>1</b> has ac‚Äê
                     tions <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>0</u><u>:</u> <u>C</u><u>h</u><u>e</u><u>c</u><u>k</u> <u>D</u><u>N</u><u>A</u><u>T</u> <u>l</u><u>o</u><u>c</u><u>a</u><u>l</u>

       This table checks if the packet  needs  to  be  DNATed  in  the  router
       ingress  table  <b>l</b><b>r</b><b>_</b><b>i</b><b>n</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b>  after  it  is SNATed and looped back to the
       ingress pipeline. This check is done only for routers  configured  with
       distributed  gateway  ports and NAT entries. This check is done so that
       SNAT and DNAT is done in different zones instead of a common zone.

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has  actions  <b>R</b><b>E</b><b>G</b>‚Äê‚Äê
                     <b>B</b><b>I</b><b>T</b><b>_</b><b>D</b><b>S</b><b>T</b><b>_</b><b>N</b><b>A</b><b>T</b><b>_</b><b>I</b><b>P</b><b>_</b><b>L</b><b>O</b><b>C</b><b>A</b><b>L</b> <b>=</b> <b>0</b><b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>:</u> <u>U</u><u>N</u><u>D</u><u>N</u><u>A</u><u>T</u>

       This  is  for  already  established connections‚Äô reverse traffic. i.e.,
       DNAT has already been done in ingress pipeline and now the  packet  has
       entered  the  egress  pipeline as part of a reply. This traffic is unD‚Äê
       NATed here.

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>:</u> <u>U</u><u>N</u><u>D</u><u>N</u><u>A</u><u>T</u> <u>o</u><u>n</u> <u>G</u><u>a</u><u>t</u><u>e</u><u>w</u><u>a</u><u>y</u> <u>R</u><u>o</u><u>u</u><u>t</u><u>e</u><u>r</u><u>s</u>

              ‚Ä¢      For IPv6 Neighbor Discovery or Router Solicitation/Adver‚Äê
                     tisement traffic, a priority-100 flow with action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

              ‚Ä¢      For all IP packets, a priority-50  flow  with  an  action
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b> <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>;</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>1</u><u>:</u> <u>U</u><u>N</u><u>D</u><u>N</u><u>A</u><u>T</u> <u>o</u><u>n</u> <u>D</u><u>i</u><u>s</u><u>t</u><u>r</u><u>i</u><u>b</u><u>u</u><u>t</u><u>e</u><u>d</u> <u>R</u><u>o</u><u>u</u><u>t</u><u>e</u><u>r</u><u>s</u>

              ‚Ä¢      For  all the configured load balancing rules for a router
                     with gateway port in  <b>O</b><b>V</b><b>N</b><b>_</b><b>N</b><b>o</b><b>r</b><b>t</b><b>h</b><b>b</b><b>o</b><b>u</b><b>n</b><b>d</b>  database  that  in‚Äê
                     cludes  an  IPv4  address <b>V</b><b>I</b><b>P</b>, for every backend IPv4 ad‚Äê
                     dress <u>B</u> defined for the <b>V</b><b>I</b><b>P</b> a priority-120 flow  is  pro‚Äê
                     grammed  on gateway chassis that matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b>
                     <u>B</u> &amp;&amp;&amp;&amp; <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u>, where <u>G</u><u>W</u> is the logical router  gate‚Äê
                     way port with an action <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>;</b>. If the backend IPv4 ad‚Äê
                     dress  <u>B</u> is also configured with L4 port <u>P</u><u>O</u><u>R</u><u>T</u> of protocol
                     <u>P</u>, then the match also  includes  <b>P</b><b>.</b><b>s</b><b>r</b><b>c</b>  ==  <u>P</u><u>O</u><u>R</u><u>T</u>.  These
                     flows are not added for load balancers with IPv6 <u>V</u><u>I</u><u>P</u><u>s</u>.

                     If  the  router is configured to force SNAT any load-bal‚Äê
                     anced  packets,  above  action  will   be   replaced   by
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b> <b>1</b><b>;</b> <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>;</b>.

              ‚Ä¢      For  each  configuration  in  the OVN Northbound database
                     that asks to change  the  destination  IP  address  of  a
                     packet  from an IP address of <u>A</u> to <u>B</u>, a priority-100 flow
                     matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>B</u> &amp;&amp;&amp;&amp; <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u>, where <u>G</u><u>W</u>  is
                     the logical router gateway port, with an action <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b><b>;</b>.
                     If  the  NAT rule is of type dnat_and_snat and has <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b>‚Äê‚Äê
                     <b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b> in the options, then the action would be <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

                     If the NAT rule cannot be handled in a  distributed  man‚Äê
                     ner,  then the priority-100 flow above is only programmed
                     on the gateway chassis with the action <b>c</b><b>t</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b>.

                     If the NAT rule can be handled in a  distributed  manner,
                     then  there  is an additional action <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u><u>A</u><b>;</b>, where
                     <u>E</u><u>A</u> is the ethernet address associated with the IP address
                     <u>A</u> in the NAT rule. This allows upstream MAC  learning  to
                     point to the correct chassis.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>2</u><u>:</u> <u>P</u><u>o</u><u>s</u><u>t</u> <u>U</u><u>N</u><u>D</u><u>N</u><u>A</u><u>T</u>

              ‚Ä¢      A  priority-50 logical flow is added that commits any un‚Äê
                     tracked flows from the previous table  <b>l</b><b>r</b><b>_</b><b>o</b><b>u</b><b>t</b><b>_</b><b>u</b><b>n</b><b>d</b><b>n</b><b>a</b><b>t</b>  for
                     Gateway  routers.  This flow matches on <b>c</b><b>t</b><b>.</b><b>n</b><b>e</b><b>w</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> with
                     action <b>c</b><b>t</b><b>_</b><b>c</b><b>o</b><b>m</b><b>m</b><b>i</b><b>t</b> <b>{</b> <b>}</b> <b>;</b> <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> .

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>3</u><u>:</u> <u>S</u><u>N</u><u>A</u><u>T</u>

       Packets that are configured to be SNATed get their  source  IP  address
       changed based on the configuration in the OVN Northbound database.

              ‚Ä¢      A  priority-120 flow to advance the IPv6 Neighbor solici‚Äê
                     tation packet to next table to skip  SNAT.  In  the  case
                     where  ovn-controller  injects an IPv6 Neighbor Solicita‚Äê
                     tion packet (for <b>n</b><b>d</b><b>_</b><b>n</b><b>s</b> action) we don‚Äôt want  the  packet
                     to go through conntrack.

       Egress Table 3: SNAT on Gateway Routers

              ‚Ä¢      If  the Gateway router in the OVN Northbound database has
                     been configured to force SNAT a  packet  (that  has  been
                     previously  DNATted)  to  <u>B</u>,  a priority-100 flow matches
                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>d</b><b>n</b><b>a</b><b>t</b> <b>=</b><b>=</b>  <b>1</b>  &amp;&amp;&amp;&amp;  <b>i</b><b>p</b>  with  an  action
                     <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>(</b><u>B</u><b>)</b><b>;</b>.

              ‚Ä¢      If  a  load balancer configured to skip snat has been ap‚Äê
                     plied to the Gateway router pipeline, a priority-120 flow
                     matches <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>s</b><b>k</b><b>i</b><b>p</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> with an  action
                     <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

              ‚Ä¢      If  the Gateway router in the OVN Northbound database has
                     been configured to force SNAT a  packet  (that  has  been
                     previously   load-balanced)  using  router  IP  (i.e  <b>o</b><b>p</b>‚Äê‚Äê
                     <b>t</b><b>i</b><b>o</b><b>n</b><b>s</b>:lb_force_snat_ip=router_ip), then for each  logical
                     router  port  <u>P</u>  attached to the Gateway router, a prior‚Äê
                     ity-110 flow matches <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>o</b><b>u</b><b>t</b>‚Äê‚Äê
                     <b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>P</u>
                      with an action <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>(</b><u>R</u><b>)</b><b>;</b> where <u>R</u> is the IP  configured
                     on  the  router  port.  If  <b>R</b> is an IPv4 address then the
                     match will also include <b>i</b><b>p</b><b>4</b> and if it is an IPv6 address,
                     then the match will also include <b>i</b><b>p</b><b>6</b>.

                     If the logical router port <u>P</u> is configured with  multiple
                     IPv4 and multiple IPv6 addresses, only the first IPv4 and
                     first IPv6 address is considered.

              ‚Ä¢      If  the Gateway router in the OVN Northbound database has
                     been configured to force SNAT a  packet  (that  has  been
                     previously  load-balanced)  to  <u>B</u>,  a  priority-100  flow
                     matches <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>f</b><b>o</b><b>r</b><b>c</b><b>e</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>_</b><b>f</b><b>o</b><b>r</b><b>_</b><b>l</b><b>b</b> <b>=</b><b>=</b> <b>1</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b> with an action
                     <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>(</b><u>B</u><b>)</b><b>;</b>.

              ‚Ä¢      For each configuration in the  OVN  Northbound  database,
                     that  asks  to  change  the source IP address of a packet
                     from an IP address of <u>A</u> or to change the  source  IP  ad‚Äê
                     dress  of a packet that belongs to network <u>A</u> to <u>B</u>, a flow
                     matches <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>A</u> &amp;&amp;&amp;&amp; <b>(</b><b>!</b><b>c</b><b>t</b><b>.</b><b>t</b><b>r</b><b>k</b> <b>|</b><b>|</b>  <b>!</b><b>c</b><b>t</b><b>.</b><b>r</b><b>p</b><b>l</b><b>)</b>  with
                     an action <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>(</b><u>B</u><b>)</b><b>;</b>. The priority of the flow is calcu‚Äê
                     lated  based on the mask of <u>A</u>, with matches having larger
                     masks getting higher priorities. If the NAT  rule  is  of
                     type dnat_and_snat and has <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b> in the options,
                     then the action would be <b>i</b><b>p</b><b>4</b><b>/</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>=</b> <b>(</b><u>B</u><b>)</b>.

              ‚Ä¢      If  the  NAT  rule  has  <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b> configured, then
                     there is an additional match <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>a</u><u>l</u><u>l</u><u>o</u><u>w</u><u>e</u><u>d</u><b>_</b><u>e</u><u>x</u><u>t</u><b>_</b><u>i</u><u>p</u><u>s</u> .
                     Similarly, for  IPV6,  match  would  be  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b>  <u>a</u><u>l</u><u>‚</u>Äê
                     <u>l</u><u>o</u><u>w</u><u>e</u><u>d</u><b>_</b><u>e</u><u>x</u><u>t</u><b>_</b><u>i</u><u>p</u><u>s</u>.

              ‚Ä¢      If  the  NAT rule has <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b> set, then there is
                     an additional flow configured at the priority + 1 of cor‚Äê
                     responding NAT rule. The flow matches if  destination  ip
                     is an <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b> and the action is <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> . This flow
                     is  used  to bypass the ct_snat action for a packet which
                     is destinted to <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b>.

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

       Egress Table 3: SNAT on Distributed Routers

              ‚Ä¢      For each configuration in the  OVN  Northbound  database,
                     that  asks  to  change  the source IP address of a packet
                     from an IP address of <u>A</u> or to change the  source  IP  ad‚Äê
                     dress  of  a  packet  that belongs to network <u>A</u> to <u>B</u>, two
                     flows are added. The priority <u>P</u> of these flows are calcu‚Äê
                     lated based on the mask of <u>A</u>, with matches having  larger
                     masks getting higher priorities.

                     If  the  NAT rule cannot be handled in a distributed man‚Äê
                     ner, then the below flows  are  only  programmed  on  the
                     gateway  chassis increasing flow priority by 128 in order
                     to be run first.

                     ‚Ä¢      The first flow is added with the calculated prior‚Äê
                            ity <u>P</u> and match <b>i</b><b>p</b> &amp;&amp;&amp;&amp; <b>i</b><b>p</b><b>4</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b><b>=</b> <u>A</u> &amp;&amp;&amp;&amp;  <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b>  <b>=</b><b>=</b>
                            <u>G</u><u>W</u>,  where  <u>G</u><u>W</u> is the logical router gateway port,
                            with an action <b>c</b><b>t</b><b>_</b><b>s</b><b>n</b><b>a</b><b>t</b><b>(</b><u>B</u><b>)</b><b>;</b> to SNATed in the common
                            zone. If the NAT rule is of type dnat_and_snat and
                            has <b>s</b><b>t</b><b>a</b><b>t</b><b>e</b><b>l</b><b>e</b><b>s</b><b>s</b><b>=</b><b>t</b><b>r</b><b>u</b><b>e</b> in the options, then the action
                            would be <b>i</b><b>p</b><b>4</b><b>/</b><b>6</b><b>.</b><b>s</b><b>r</b><b>c</b><b>=</b><b>(</b><u>B</u><b>)</b>.

                     If the NAT rule can be handled in a  distributed  manner,
                     then  there  is an additional action (for both the flows)
                     <b>e</b><b>t</b><b>h</b><b>.</b><b>s</b><b>r</b><b>c</b> <b>=</b> <u>E</u><u>A</u><b>;</b>, where <u>E</u><u>A</u> is the ethernet  address  associ‚Äê
                     ated  with  the IP address <u>A</u> in the NAT rule. This allows
                     upstream MAC learning to point to the correct chassis.

                     If the NAT  rule  has  <b>a</b><b>l</b><b>l</b><b>o</b><b>w</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b>  configured,  then
                     there is an additional match <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>a</u><u>l</u><u>l</u><u>o</u><u>w</u><u>e</u><u>d</u><b>_</b><u>e</u><u>x</u><u>t</u><b>_</b><u>i</u><u>p</u><u>s</u> .
                     Similarly,  for  IPV6,  match  would  be  <b>i</b><b>p</b><b>6</b><b>.</b><b>d</b><b>s</b><b>t</b>  <b>=</b><b>=</b> <u>a</u><u>l</u><u>‚</u>Äê
                     <u>l</u><u>o</u><u>w</u><u>e</u><u>d</u><b>_</b><u>e</u><u>x</u><u>t</u><b>_</b><u>i</u><u>p</u><u>s</u>.

                     If the NAT rule has <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b> set, then  there  is
                     an  additional  flow configured at the priority <u>P</u> <b>+</b> <b>2</b>  of
                     corresponding NAT rule. The flow matches  if  destination
                     ip  is  an <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b> and the action is <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b> . This
                     flow is used to bypass the  ct_snat  action  for  a  flow
                     which is destinted to <b>e</b><b>x</b><b>e</b><b>m</b><b>p</b><b>t</b><b>e</b><b>d</b><b>_</b><b>e</b><b>x</b><b>t</b><b>_</b><b>i</b><b>p</b><b>s</b>.

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>4</u><u>:</u> <u>P</u><u>o</u><u>s</u><u>t</u> <u>S</u><u>N</u><u>A</u><u>T</u>

       Packets reaching this table are processed according to the flows below:

              ‚Ä¢      A  priority-0  logical  flow that matches all packets not
                     already handled (match <b>1</b>) and action <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>5</u><u>:</u> <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>L</u><u>o</u><u>o</u><u>p</u><u>b</u><u>a</u><u>c</u><u>k</u>

       For distributed logical routers where one of the logical  router  ports
       specifies a gateway chassis.

       While  UNDNAT  and SNAT processing have already occurred by this point,
       this traffic needs to be forced through egress loopback  on  this  dis‚Äê
       tributed gateway port instance, in order for UNSNAT and DNAT processing
       to  be applied, and also for IP routing and ARP resolution after all of
       the NAT processing, so that the packet can be forwarded to the destina‚Äê
       tion.

       This table has the following flows:

              ‚Ä¢      For each NAT rule in the OVN  Northbound  database  on  a
                     distributed  router,  a  priority-100  logical  flow with
                     match <b>i</b><b>p</b><b>4</b><b>.</b><b>d</b><b>s</b><b>t</b> <b>=</b><b>=</b> <u>E</u> &amp;&amp;&amp;&amp; <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b><b>=</b> <u>G</u><u>W</u>  &amp;&amp;&amp;&amp;  <b>i</b><b>s</b><b>_</b><b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>_</b><b>r</b><b>e</b><b>s</b><b>i</b>‚Äê‚Äê
                     <b>d</b><b>e</b><b>n</b><b>t</b><b>(</b><u>P</u><b>)</b>,  where <u>E</u> is the external IP address specified in
                     the NAT rule, <u>G</u><u>W</u> is the distributed gateway  port  corre‚Äê
                     sponding  to  the  NAT  rule (specified or inferred). For
                     dnat_and_snat NAT rule, <u>P</u> is the logical  port  specified
                     in  the  NAT rule. If <b>l</b><b>o</b><b>g</b><b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>p</b><b>o</b><b>r</b><b>t</b> column of <b>N</b><b>A</b><b>T</b> table is
                     NOT set, then <u>P</u> is the <b>c</b><b>h</b><b>a</b><b>s</b><b>s</b><b>i</b><b>s</b><b>r</b><b>e</b><b>d</b><b>i</b><b>r</b><b>e</b><b>c</b><b>t</b> <b>p</b><b>o</b><b>r</b><b>t</b>  of  <u>G</u><u>W</u>  with
                     the following actions:

                     <b>c</b><b>l</b><b>o</b><b>n</b><b>e</b> <b>{</b>
                         <b>c</b><b>t</b><b>_</b><b>c</b><b>l</b><b>e</b><b>a</b><b>r</b><b>;</b>
                         <b>i</b><b>n</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b><b>;</b>
                         <b>o</b><b>u</b><b>t</b><b>p</b><b>o</b><b>r</b><b>t</b> <b>=</b> <b>"</b><b>"</b><b>;</b>
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b> <b>=</b> <b>0</b><b>;</b>
                         <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b> <b>=</b> <b>1</b><b>;</b>
                         <b>r</b><b>e</b><b>g</b><b>0</b> <b>=</b> <b>0</b><b>;</b>
                         <b>r</b><b>e</b><b>g</b><b>1</b> <b>=</b> <b>0</b><b>;</b>
                         <b>.</b><b>.</b><b>.</b>
                         <b>r</b><b>e</b><b>g</b><b>9</b> <b>=</b> <b>0</b><b>;</b>
                         <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> <b>=</b> <b>1</b><b>;</b>
                         <b>n</b><b>e</b><b>x</b><b>t</b><b>(</b><b>p</b><b>i</b><b>p</b><b>e</b><b>l</b><b>i</b><b>n</b><b>e</b><b>=</b><b>i</b><b>n</b><b>g</b><b>r</b><b>e</b><b>s</b><b>s</b><b>,</b> <b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>=</b><b>0</b><b>)</b><b>;</b>
                     <b>}</b><b>;</b>


                     <b>f</b><b>l</b><b>a</b><b>g</b><b>s</b><b>.</b><b>l</b><b>o</b><b>o</b><b>p</b><b>b</b><b>a</b><b>c</b><b>k</b>  is set since in_port is unchanged and the
                     packet may return back to that port after NAT processing.
                     <b>R</b><b>E</b><b>G</b><b>B</b><b>I</b><b>T</b><b>_</b><b>E</b><b>G</b><b>R</b><b>E</b><b>S</b><b>S</b><b>_</b><b>L</b><b>O</b><b>O</b><b>P</b><b>B</b><b>A</b><b>C</b><b>K</b> is set  to  indicate  that  egress
                     loopback has occurred, in order to skip the source IP ad‚Äê
                     dress check against the router address.

              ‚Ä¢      A priority-0 logical flow with match <b>1</b> has actions <b>n</b><b>e</b><b>x</b><b>t</b><b>;</b>.

     <u>E</u><u>g</u><u>r</u><u>e</u><u>s</u><u>s</u> <u>T</u><u>a</u><u>b</u><u>l</u><u>e</u> <u>6</u><u>:</u> <u>D</u><u>e</u><u>l</u><u>i</u><u>v</u><u>e</u><u>r</u><u>y</u>

       Packets that reach this table are ready for delivery. It contains:

              ‚Ä¢      Priority-110  logical flows that match IP multicast pack‚Äê
                     ets on each enabled logical router port  and  modify  the
                     Ethernet  source  address  of the packets to the Ethernet
                     address of the port and then execute action <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>.

              ‚Ä¢      Priority-100 logical flows that match packets on each en‚Äê
                     abled logical router port, with action <b>o</b><b>u</b><b>t</b><b>p</b><b>u</b><b>t</b><b>;</b>.

              ‚Ä¢      A priority-0 logical flow that matches  all  packets  not
                     already handled (match <b>1</b>) and drops them (action <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>).

<b>D</b><b>R</b><b>O</b><b>P</b> <b>S</b><b>A</b><b>M</b><b>P</b><b>L</b><b>I</b><b>N</b><b>G</b>
       As  described  in  the previous section, there are several places where
       ovn-northd might decided to drop a packet by explicitly creating a <b>L</b><b>o</b><b>g</b>‚Äê‚Äê
       <b>i</b><b>c</b><b>a</b><b>l</b><b>_</b><b>F</b><b>l</b><b>o</b><b>w</b> with the <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b> action.

       When debug drop-sampling has been cofigured in the OVN Northbound data‚Äê
       base, the ovn-northd will replace all the <b>d</b><b>r</b><b>o</b><b>p</b><b>;</b>  actions  with  a  <b>s</b><b>a</b><b>m</b>‚Äê‚Äê
       <b>p</b><b>l</b><b>e</b><b>(</b><b>p</b><b>r</b><b>i</b><b>o</b><b>r</b><b>i</b><b>t</b><b>y</b><b>=</b><b>6</b><b>5</b><b>5</b><b>3</b><b>5</b><b>,</b>         <b>c</b><b>o</b><b>l</b><b>l</b><b>e</b><b>c</b><b>t</b><b>o</b><b>r</b><b>_</b><b>s</b><b>e</b><b>t</b><b>=</b><u>i</u><u>d</u><b>,</b>        <b>o</b><b>b</b><b>s</b><b>_</b><b>d</b><b>o</b><b>m</b><b>a</b><b>i</b><b>n</b><b>=</b><u>o</u><u>b</u><u>s</u><b>_</b><u>i</u><u>d</u><b>,</b>
       <b>o</b><b>b</b><b>s</b><b>_</b><b>p</b><b>o</b><b>i</b><b>n</b><b>t</b><b>=</b><b>@</b><b>c</b><b>o</b><b>o</b><b>k</b><b>i</b><b>e</b><b>)</b> action, where:

              ‚Ä¢      <u>i</u><u>d</u> is the value the <b>d</b><b>e</b><b>b</b><b>u</b><b>g</b><b>_</b><b>d</b><b>r</b><b>o</b><b>p</b><b>_</b><b>c</b><b>o</b><b>l</b><b>l</b><b>e</b><b>c</b><b>t</b><b>o</b><b>r</b><b>_</b><b>s</b><b>e</b><b>t</b> option  con‚Äê
                     figured in the OVN Northbound.

              ‚Ä¢      <u>o</u><u>b</u><u>s</u><b>_</b><u>i</u><u>d</u>  has  it‚Äôs  8  most  significant bits equal to the
                     value of  the  <b>d</b><b>e</b><b>b</b><b>u</b><b>g</b><b>_</b><b>d</b><b>r</b><b>o</b><b>p</b><b>_</b><b>d</b><b>o</b><b>m</b><b>a</b><b>i</b><b>n</b><b>_</b><b>i</b><b>d</b>  option  in  the  OVN
                     Northbound  and  it‚Äôs  24 least significant bits equal to
                     the datapath‚Äôs tunnel key.

OVN 23.06.6                       ovn-northd                     <u>o</u><u>v</u><u>n</u><u>-</u><u>n</u><u>o</u><u>r</u><u>t</u><u>h</u><u>d</u>(8)
</pre></body></html>
